2024-03-10 11:23:14.732 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/instruct.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata]
2024-03-10 11:23:14.749 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤══════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                               │
╞════════════════════════╪══════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/instruct.yaml)] │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'instruct'                                                                           │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                            │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/instruct.jsonl'                         │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata/instruct.jsonl'             │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                    │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                    │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                               │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                             │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                      │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                      │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                   │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/autodl-tmp/dj_mixture_challenge/../cache/huggingface/datasets'                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                   │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                   │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'math_num_filter': {'image_key': 'images',                                         │
│                        │                       'max_len': 9223372036854775807,                                │
│                        │                       'min_len': 1,                                                  │
│                        │                       'text_key': 'text'}}]                                          │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                               │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata'                            │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240310112314'                                                                     │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                        │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                │
╘════════════════════════╧══════════════════════════════════════════════════════════════════════════════════════╛
2024-03-10 11:23:14.751 | INFO     | __main__:process_math:72 - =========Stage 2: process original data=========
2024-03-10 11:23:14.752 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2024-03-10 11:23:14.753 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2024-03-10 11:23:14.754 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2024-03-10 11:23:14.754 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2024-03-10 11:23:16.043 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-03-10 11:23:16.045 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 888970 sample(s) in the original dataset.
2024-03-10 11:23:16.239 | INFO     | data_juicer.format.formatter:unify_format:214 - 888970 samples left after filtering empty text.
2024-03-10 11:23:16.240 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 888970 from 888970
2024-03-10 11:23:16.264 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 888970 in final dataset
2024-03-10 11:23:16.266 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2024-03-10 11:23:16.267 | INFO     | data_juicer.core.executor:run:112 - Processing data...
2024-03-10 11:23:17.051 | INFO     | data_juicer.core.executor:run:188 - Op [math_num_filter] Done in 0.784(s). Left 3794 samples.
2024-03-10 11:23:17.052 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 0.785(s).
2024-03-10 11:23:17.052 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2024-03-10 11:23:17.053 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/4 [00:00<?, ?ba/s]Creating json from Arrow format:  75%|########################################################################################5                             | 3/4 [00:00<00:00, 28.38ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 4/4 [00:00<00:00, 22.88ba/s]
2024-03-10 11:23:17.350 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/4 [00:00<?, ?ba/s]Creating json from Arrow format:  25%|#############################5                                                                                        | 1/4 [00:00<00:00,  3.34ba/s]Creating json from Arrow format:  50%|###########################################################                                                           | 2/4 [00:00<00:00,  3.41ba/s]Creating json from Arrow format:  75%|########################################################################################5                             | 3/4 [00:00<00:00,  3.26ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 4/4 [00:01<00:00,  3.43ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 4/4 [00:01<00:00,  3.39ba/s]
2024-03-10 11:23:18.659 | INFO     | __main__:process_math:61 - =========Processing /root/autodl-tmp/dj_mixture_challenge/input/gpt4all.jsonl=========
2024-03-10 11:23:20.334 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/gpt4all.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata]
2024-03-10 11:23:20.345 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                              │
╞════════════════════════╪═════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/gpt4all.yaml)] │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'gpt4all'                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/gpt4all.jsonl'                         │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata/gpt4all.jsonl'             │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                   │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                   │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                     │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                     │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/autodl-tmp/dj_mixture_challenge/../cache/huggingface/datasets'               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'math_num_filter': {'image_key': 'images',                                        │
│                        │                       'max_len': 9223372036854775807,                               │
│                        │                       'min_len': 1,                                                 │
│                        │                       'text_key': 'text'}}]                                         │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata'                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240310112320'                                                                    │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                               │
╘════════════════════════╧═════════════════════════════════════════════════════════════════════════════════════╛
2024-03-10 11:23:20.347 | INFO     | __main__:process_math:72 - =========Stage 2: process original data=========
2024-03-10 11:23:20.348 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2024-03-10 11:23:20.348 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2024-03-10 11:23:20.349 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2024-03-10 11:23:20.350 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2024-03-10 11:23:21.470 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-03-10 11:23:21.477 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 806199 sample(s) in the original dataset.
2024-03-10 11:23:21.659 | INFO     | data_juicer.format.formatter:unify_format:214 - 806199 samples left after filtering empty text.
2024-03-10 11:23:21.661 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 806199 from 806199
2024-03-10 11:23:21.752 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 806199 in final dataset
2024-03-10 11:23:21.755 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2024-03-10 11:23:21.756 | INFO     | data_juicer.core.executor:run:112 - Processing data...
2024-03-10 11:23:23.271 | INFO     | data_juicer.core.executor:run:188 - Op [math_num_filter] Done in 1.515(s). Left 2339 samples.
2024-03-10 11:23:23.273 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 1.516(s).
2024-03-10 11:23:23.273 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2024-03-10 11:23:23.333 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/3 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 3/3 [00:00<00:00, 32.02ba/s]
2024-03-10 11:23:23.534 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/3 [00:00<?, ?ba/s]Creating json from Arrow format:  33%|#######################################3                                                                              | 1/3 [00:00<00:00,  4.79ba/s]Creating json from Arrow format:  67%|##############################################################################6                                       | 2/3 [00:00<00:00,  4.83ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 3/3 [00:00<00:00,  5.86ba/s]
2024-03-10 11:23:24.142 | INFO     | __main__:process_math:61 - =========Processing /root/autodl-tmp/dj_mixture_challenge/input/instruct.jsonl=========
2024-03-10 11:23:25.635 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/instruct.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata]
2024-03-10 11:23:25.644 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤══════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                               │
╞════════════════════════╪══════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/instruct.yaml)] │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'instruct'                                                                           │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                            │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/instruct.jsonl'                         │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata/instruct.jsonl'             │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                    │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                    │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                               │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                             │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                      │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                      │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                   │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/autodl-tmp/dj_mixture_challenge/../cache/huggingface/datasets'                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                 │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                   │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                   │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'math_num_filter': {'image_key': 'images',                                         │
│                        │                       'max_len': 9223372036854775807,                                │
│                        │                       'min_len': 1,                                                  │
│                        │                       'text_key': 'text'}}]                                          │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                               │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata'                            │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240310112325'                                                                     │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                        │
├────────────────────────┼──────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                │
╘════════════════════════╧══════════════════════════════════════════════════════════════════════════════════════╛
2024-03-10 11:23:25.647 | INFO     | __main__:process_math:72 - =========Stage 2: process original data=========
2024-03-10 11:23:25.647 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2024-03-10 11:23:25.648 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2024-03-10 11:23:25.649 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2024-03-10 11:23:25.649 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2024-03-10 11:23:36.843 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-03-10 11:23:36.846 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 888970 sample(s) in the original dataset.
2024-03-10 11:23:37.040 | INFO     | data_juicer.format.formatter:unify_format:214 - 888970 samples left after filtering empty text.
2024-03-10 11:23:37.041 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 888970 from 888970
2024-03-10 11:23:37.067 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 888970 in final dataset
2024-03-10 11:23:37.070 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2024-03-10 11:23:37.071 | INFO     | data_juicer.core.executor:run:112 - Processing data...
2024-03-10 11:23:37.860 | INFO     | data_juicer.core.executor:run:188 - Op [math_num_filter] Done in 0.789(s). Left 3794 samples.
2024-03-10 11:23:37.861 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 0.790(s).
2024-03-10 11:23:37.862 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2024-03-10 11:23:37.863 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/4 [00:00<?, ?ba/s]Creating json from Arrow format:  75%|########################################################################################5                             | 3/4 [00:00<00:00, 28.13ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 4/4 [00:00<00:00, 32.73ba/s]
2024-03-10 11:23:38.151 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/4 [00:00<?, ?ba/s]Creating json from Arrow format:  25%|#############################5                                                                                        | 1/4 [00:00<00:00,  3.46ba/s]Creating json from Arrow format:  50%|###########################################################                                                           | 2/4 [00:00<00:00,  3.43ba/s]Creating json from Arrow format:  75%|########################################################################################5                             | 3/4 [00:00<00:00,  3.41ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 4/4 [00:01<00:00,  3.89ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 4/4 [00:01<00:00,  3.70ba/s]
2024-03-10 11:23:39.343 | INFO     | __main__:process_math:61 - =========Processing /root/autodl-tmp/dj_mixture_challenge/input/gpt4all.jsonl=========
2024-03-10 11:23:40.873 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/gpt4all.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata]
2024-03-10 11:23:40.938 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                              │
╞════════════════════════╪═════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/root/autodl-tmp/dj_mixture_challenge/solution/math_configs/gpt4all.yaml)] │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'gpt4all'                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/gpt4all.jsonl'                         │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata/gpt4all.jsonl'             │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                   │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                   │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                     │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                     │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/autodl-tmp/dj_mixture_challenge/../cache/huggingface/datasets'               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'math_num_filter': {'image_key': 'images',                                        │
│                        │                       'max_len': 9223372036854775807,                               │
│                        │                       'min_len': 1,                                                 │
│                        │                       'text_key': 'text'}}]                                         │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/filtered_mathdata'                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240310112340'                                                                    │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                               │
╘════════════════════════╧═════════════════════════════════════════════════════════════════════════════════════╛
2024-03-10 11:23:40.940 | INFO     | __main__:process_math:72 - =========Stage 2: process original data=========
2024-03-10 11:23:40.941 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2024-03-10 11:23:40.941 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2024-03-10 11:23:40.943 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2024-03-10 11:23:40.944 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2024-03-10 11:23:42.157 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-03-10 11:23:42.159 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 806199 sample(s) in the original dataset.
2024-03-10 11:23:42.354 | INFO     | data_juicer.format.formatter:unify_format:214 - 806199 samples left after filtering empty text.
2024-03-10 11:23:42.355 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 806199 from 806199
2024-03-10 11:23:42.379 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 806199 in final dataset
2024-03-10 11:23:42.433 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2024-03-10 11:23:42.434 | INFO     | data_juicer.core.executor:run:112 - Processing data...
2024-03-10 11:23:43.134 | INFO     | data_juicer.core.executor:run:188 - Op [math_num_filter] Done in 0.699(s). Left 2339 samples.
2024-03-10 11:23:43.136 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 0.701(s).
2024-03-10 11:23:43.137 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2024-03-10 11:23:43.138 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/3 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 3/3 [00:00<00:00, 31.00ba/s]
2024-03-10 11:23:43.344 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/3 [00:00<?, ?ba/s]Creating json from Arrow format:  33%|#######################################3                                                                              | 1/3 [00:00<00:00,  4.48ba/s]Creating json from Arrow format:  67%|##############################################################################6                                       | 2/3 [00:00<00:00,  3.97ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 3/3 [00:00<00:00,  5.43ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 3/3 [00:00<00:00,  4.99ba/s]
2024-03-10 11:23:44.132 | WARNING  | __main__:process_math:81 - MATH: instruct.jsonl: 3794
2024-03-10 11:23:44.159 | WARNING  | __main__:process_math:81 - MATH: gpt4all.jsonl: 2339
2024-03-10 11:23:44.242 | WARNING  | __main__:process_math:81 - MATH: instruct.jsonl: 3794
2024-03-10 11:23:44.263 | WARNING  | __main__:process_math:81 - MATH: gpt4all.jsonl: 2339
2024-03-10 11:23:44.272 | INFO     | __main__:process:98 - =========Processing /root/autodl-tmp/dj_mixture_challenge/input/HC3_ChatGPT.jsonl=========
2024-03-10 11:23:45.846 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/solution/configs/HC3_ChatGPT.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/filtered_data]
2024-03-10 11:23:45.858 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                             │
╞════════════════════════╪════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/root/autodl-tmp/dj_mixture_challenge/solution/configs/HC3_ChatGPT.yaml)] │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'HC3_ChatGPT'                                                                      │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                          │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/HC3_ChatGPT.jsonl'                    │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/filtered_data/HC3_ChatGPT.jsonl'            │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                  │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                  │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                             │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                           │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                    │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                    │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/autodl-tmp/dj_mixture_challenge/../cache/huggingface/datasets'              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                               │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                 │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'language_id_score_filter': {'image_key': 'images',                              │
│                        │                                'lang': 'en',                                       │
│                        │                                'min_score': 0.9,                                   │
│                        │                                'text_key': 'text'}},                               │
│                        │  {'normal_filter': {'image_key': 'images', 'text_key': 'text'}},                   │
│                        │  {'perplexity_filter': {'image_key': 'images',                                     │
│                        │                         'lang': 'en',                                              │
│                        │                         'max_ppl': 279.1,                                          │
│                        │                         'min_ppl': 148.9,                                          │
│                        │                         'text_key': 'text'}},                                      │
│                        │  {'token_num_filter': {'hf_tokenizer': 'baichuan-inc/Baichuan2-7B-Base',           │
│                        │                        'image_key': 'images',                                      │
│                        │                        'max_num': 500,                                             │
│                        │                        'min_num': 10,                                              │
│                        │                        'text_key': 'text'}}]                                       │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                             │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/filtered_data'                              │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240310112345'                                                                   │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                      │
├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                              │
╘════════════════════════╧════════════════════════════════════════════════════════════════════════════════════╛
2024-03-10 11:23:45.862 | INFO     | __main__:process:109 - =========Stage 2: process original data=========
2024-03-10 11:23:45.863 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2024-03-10 11:23:45.863 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2024-03-10 11:23:45.864 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2024-03-10 11:23:45.865 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2024-03-10 11:23:47.039 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-03-10 11:23:47.044 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 26903 sample(s) in the original dataset.
2024-03-10 11:23:47.081 | INFO     | data_juicer.format.formatter:unify_format:214 - 26903 samples left after filtering empty text.
2024-03-10 11:23:47.083 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 26903 from 26903
2024-03-10 11:23:47.140 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 26903 in final dataset
2024-03-10 11:23:47.141 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2024-03-10 11:23:47.142 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-03-10 11:23:47.781 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-03-10 11:23:48.079 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-03-10 11:23:49.132 | INFO     | data_juicer.utils.model_utils:prepare_huggingface_tokenizer:167 - Loading tokenizer baichuan-inc/Baichuan2-7B-Base from HuggingFace...
2024-03-10 11:23:49.465 | INFO     | data_juicer.core.executor:run:112 - Processing data...
2024-03-10 11:23:49.759 | INFO     | data_juicer.core.executor:run:188 - Op [language_id_score_filter] Done in 0.293(s). Left 26615 samples.
2024-03-10 11:23:49.958 | INFO     | data_juicer.core.executor:run:188 - Op [normal_filter] Done in 0.199(s). Left 26615 samples.
2024-03-10 11:23:50.236 | INFO     | data_juicer.core.executor:run:188 - Op [perplexity_filter] Done in 0.278(s). Left 13420 samples.
2024-03-10 11:23:50.442 | INFO     | data_juicer.core.executor:run:188 - Op [token_num_filter] Done in 0.206(s). Left 13365 samples.
2024-03-10 11:23:50.443 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 0.977(s).
2024-03-10 11:23:50.444 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2024-03-10 11:23:50.445 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                                                                             | 0/14 [00:00<?, ?ba/s]Creating json from Arrow format:  14%|################7                                                                                                    | 2/14 [00:00<00:00, 16.70ba/s]Creating json from Arrow format:  29%|#################################4                                                                                   | 4/14 [00:00<00:00, 13.43ba/s]Creating json from Arrow format:  43%|##################################################1                                                                  | 6/14 [00:00<00:00, 14.71ba/s]Creating json from Arrow format:  57%|##################################################################8                                                  | 8/14 [00:00<00:00, 13.41ba/s]Creating json from Arrow format:  71%|##################################################################################8                                 | 10/14 [00:00<00:00, 14.50ba/s]Creating json from Arrow format:  86%|###################################################################################################4                | 12/14 [00:00<00:00, 15.27ba/s]Creating json from Arrow format: 100%|####################################################################################################################| 14/14 [00:00<00:00, 16.45ba/s]Creating json from Arrow format: 100%|####################################################################################################################| 14/14 [00:00<00:00, 15.25ba/s]
2024-03-10 11:23:51.444 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                             | 0/14 [00:00<?, ?ba/s]Creating json from Arrow format:   7%|########3                                                                                                            | 1/14 [00:00<00:03,  3.41ba/s]Creating json from Arrow format:  14%|################7                                                                                                    | 2/14 [00:00<00:03,  3.40ba/s]Creating json from Arrow format:  21%|#########################                                                                                            | 3/14 [00:00<00:03,  3.19ba/s]Creating json from Arrow format:  29%|#################################4                                                                                   | 4/14 [00:01<00:03,  3.29ba/s]Creating json from Arrow format:  36%|#########################################7                                                                           | 5/14 [00:01<00:02,  3.66ba/s]Creating json from Arrow format:  43%|##################################################1                                                                  | 6/14 [00:01<00:02,  3.68ba/s]Creating json from Arrow format:  50%|##########################################################5                                                          | 7/14 [00:01<00:01,  3.93ba/s]Creating json from Arrow format:  57%|##################################################################8                                                  | 8/14 [00:02<00:01,  3.88ba/s]Creating json from Arrow format:  64%|###########################################################################2                                         | 9/14 [00:02<00:01,  3.63ba/s]Creating json from Arrow format:  71%|##################################################################################8                                 | 10/14 [00:02<00:01,  3.91ba/s]Creating json from Arrow format:  79%|###########################################################################################1                        | 11/14 [00:03<00:00,  3.74ba/s]Creating json from Arrow format:  86%|###################################################################################################4                | 12/14 [00:03<00:00,  3.96ba/s]Creating json from Arrow format:  93%|###########################################################################################################7        | 13/14 [00:03<00:00,  3.87ba/s]Creating json from Arrow format: 100%|####################################################################################################################| 14/14 [00:03<00:00,  3.89ba/s]
2024-03-10 11:23:55.134 | INFO     | __main__:process:98 - =========Processing /root/autodl-tmp/dj_mixture_challenge/input/instruct.jsonl=========
2024-03-10 11:23:56.665 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/solution/configs/instruct.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/filtered_data]
2024-03-10 11:23:56.678 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                          │
╞════════════════════════╪═════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/root/autodl-tmp/dj_mixture_challenge/solution/configs/instruct.yaml)] │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'instruct'                                                                      │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/instruct.jsonl'                    │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/filtered_data/instruct.jsonl'            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                          │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                        │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                 │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                 │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/autodl-tmp/dj_mixture_challenge/../cache/huggingface/datasets'           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'language_id_score_filter': {'image_key': 'images',                           │
│                        │                                'lang': 'en',                                    │
│                        │                                'min_score': 0.7,                                │
│                        │                                'text_key': 'text'}},                            │
│                        │  {'normal_filter': {'image_key': 'images', 'text_key': 'text'}},                │
│                        │  {'perplexity_filter': {'image_key': 'images',                                  │
│                        │                         'lang': 'en',                                           │
│                        │                         'max_ppl': 1170.6,                                      │
│                        │                         'min_ppl': 0,                                           │
│                        │                         'text_key': 'text'}},                                   │
│                        │  {'token_num_filter': {'hf_tokenizer': 'baichuan-inc/Baichuan2-7B-Base',        │
│                        │                        'image_key': 'images',                                   │
│                        │                        'max_num': 4000,                                         │
│                        │                        'min_num': 1000,                                         │
│                        │                        'text_key': 'text'}}]                                    │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                          │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/filtered_data'                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240310112356'                                                                │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                   │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                           │
╘════════════════════════╧═════════════════════════════════════════════════════════════════════════════════╛
2024-03-10 11:23:56.733 | INFO     | __main__:process:109 - =========Stage 2: process original data=========
2024-03-10 11:23:56.734 | INFO     | data_juicer.core.executor:__init__:41 - Using cache compression method: [None]
2024-03-10 11:23:56.735 | INFO     | data_juicer.core.executor:__init__:46 - Setting up data formatter...
2024-03-10 11:23:56.736 | INFO     | data_juicer.core.executor:__init__:68 - Preparing exporter...
2024-03-10 11:23:56.736 | INFO     | data_juicer.core.executor:run:99 - Loading dataset from data formatter...
2024-03-10 11:23:58.437 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-03-10 11:23:58.439 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 888970 sample(s) in the original dataset.
2024-03-10 11:23:59.550 | INFO     | data_juicer.format.formatter:unify_format:214 - 888970 samples left after filtering empty text.
2024-03-10 11:23:59.552 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 888970 from 888970
2024-03-10 11:23:59.632 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 888970 in final dataset
2024-03-10 11:23:59.635 | INFO     | data_juicer.core.executor:run:105 - Preparing process operators...
2024-03-10 11:23:59.636 | INFO     | data_juicer.core.executor:run:112 - Processing data...
2024-03-10 11:24:00.457 | INFO     | data_juicer.core.executor:run:188 - Op [language_id_score_filter] Done in 0.820(s). Left 789557 samples.
2024-03-10 11:24:00.975 | INFO     | data_juicer.core.executor:run:188 - Op [normal_filter] Done in 0.518(s). Left 736672 samples.
2024-03-10 11:24:01.545 | INFO     | data_juicer.core.executor:run:188 - Op [perplexity_filter] Done in 0.570(s). Left 636461 samples.
2024-03-10 11:24:02.046 | INFO     | data_juicer.core.executor:run:188 - Op [token_num_filter] Done in 0.501(s). Left 1754 samples.
2024-03-10 11:24:02.048 | INFO     | data_juicer.core.executor:run:192 - All Ops are done in 2.412(s).
2024-03-10 11:24:02.049 | INFO     | data_juicer.core.executor:run:195 - Exporting dataset to disk...
2024-03-10 11:24:02.050 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/2 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 2/2 [00:00<00:00, 11.21ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 2/2 [00:00<00:00, 11.10ba/s]
2024-03-10 11:24:02.340 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                              | 0/2 [00:00<?, ?ba/s]Creating json from Arrow format:  50%|###########################################################                                                           | 1/2 [00:00<00:00,  1.13ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 2/2 [00:01<00:00,  1.38ba/s]Creating json from Arrow format: 100%|######################################################################################################################| 2/2 [00:01<00:00,  1.34ba/s]
2024-03-10 11:24:03.955 | WARNING  | __main__:process:118 - HC3_ChatGPT.jsonl: 13365
2024-03-10 11:24:03.972 | WARNING  | __main__:process:118 - instruct.jsonl: 1754
2024-03-10 11:24:04.036 | INFO     | __main__:sample:122 - =========sampling=========
2024-03-10 11:24:04.043 | WARNING  | __main__:sample:146 - HC3_ChatGPT.jsonl: 13365 ==> 13365
2024-03-10 11:24:04.054 | WARNING  | __main__:sample:146 - instruct.jsonl: 1754 ==> 1754
2024-03-10 11:24:04.055 | INFO     | __main__:mix:157 - =========mixing=========
2024-03-10 11:24:04.437 | INFO     | __main__:<module>:183 - =========exporting=========
2024-03-10 11:24:04.755 | INFO     | data_juicer.core.exporter:_export_impl:137 - Export dataset into a single file...
Creating json from Arrow format:   0%|                                                                                                                             | 0/28 [00:00<?, ?ba/s]Creating json from Arrow format:   4%|####1                                                                                                                | 1/28 [00:08<03:38,  8.10s/ba]Creating json from Arrow format:   7%|########3                                                                                                            | 2/28 [00:08<01:32,  3.57s/ba]Creating json from Arrow format:  11%|############5                                                                                                        | 3/28 [00:12<01:35,  3.81s/ba]Creating json from Arrow format:  14%|################7                                                                                                    | 4/28 [00:12<00:56,  2.35s/ba]Creating json from Arrow format:  21%|#########################                                                                                            | 6/28 [00:13<00:27,  1.24s/ba]Creating json from Arrow format:  25%|#############################2                                                                                       | 7/28 [00:13<00:19,  1.05ba/s]Creating json from Arrow format:  29%|#################################4                                                                                   | 8/28 [00:16<00:29,  1.47s/ba]Creating json from Arrow format:  32%|#####################################6                                                                               | 9/28 [00:16<00:22,  1.16s/ba]Creating json from Arrow format:  36%|#########################################4                                                                          | 10/28 [00:17<00:18,  1.00s/ba]Creating json from Arrow format:  43%|#################################################7                                                                  | 12/28 [00:19<00:18,  1.14s/ba]Creating json from Arrow format:  46%|#####################################################8                                                              | 13/28 [00:20<00:17,  1.15s/ba]Creating json from Arrow format:  50%|##########################################################                                                          | 14/28 [00:21<00:12,  1.10ba/s]Creating json from Arrow format:  57%|##################################################################2                                                 | 16/28 [00:22<00:10,  1.11ba/s]Creating json from Arrow format:  61%|######################################################################4                                             | 17/28 [00:24<00:11,  1.02s/ba]Creating json from Arrow format:  64%|##########################################################################5                                         | 18/28 [00:26<00:12,  1.29s/ba]Creating json from Arrow format:  71%|##################################################################################8                                 | 20/28 [00:26<00:06,  1.26ba/s]Creating json from Arrow format:  75%|#######################################################################################                             | 21/28 [00:28<00:07,  1.00s/ba]Creating json from Arrow format:  79%|###########################################################################################1                        | 22/28 [00:29<00:06,  1.02s/ba]Creating json from Arrow format:  82%|###############################################################################################2                    | 23/28 [00:30<00:05,  1.02s/ba]Creating json from Arrow format:  86%|###################################################################################################4                | 24/28 [00:31<00:03,  1.07ba/s]Creating json from Arrow format:  89%|#######################################################################################################5            | 25/28 [00:32<00:03,  1.01s/ba]Creating json from Arrow format:  93%|###########################################################################################################7        | 26/28 [00:33<00:01,  1.05ba/s]Creating json from Arrow format:  96%|###############################################################################################################8    | 27/28 [00:34<00:01,  1.02s/ba]Creating json from Arrow format: 100%|####################################################################################################################| 28/28 [00:34<00:00,  1.23s/ba]
