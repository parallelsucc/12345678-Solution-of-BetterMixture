2024-01-21 12:02:18.242 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/./config/alpaca_data.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/output/analysis/alpaca_data]
2024-01-21 12:02:18.258 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./config/alpaca_data.yaml, cwd=/root/autodl-tmp/dj_mixture_challenge)]       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'alpaca_data'                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/alpaca_data.jsonl'                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/alpaca_data/alpaca_data.jsonl' │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/.cache/huggingface/datasets'                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'text_length_filter': {'image_key': 'images',                                       │
│                        │                          'max_len': 4096,                                             │
│                        │                          'min_len': 1,                                                │
│                        │                          'text_key': 'text'}},                                        │
│                        │  {'language_id_score_filter': {'image_key': 'images',                                 │
│                        │                                'lang': 'en',                                          │
│                        │                                'min_score': 0.8,                                      │
│                        │                                'text_key': 'text'}},                                  │
│                        │  {'perplexity_filter': {'image_key': 'images',                                        │
│                        │                         'lang': 'en',                                                 │
│                        │                         'max_ppl': 1500,                                              │
│                        │                         'text_key': 'text'}},                                         │
│                        │  {'text_length_filter': {'image_key': 'images',                                       │
│                        │                          'max_len': 10000,                                            │
│                        │                          'min_len': 1.0,                                              │
│                        │                          'text_key': 'text'}},                                        │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                      │
│                        │                           'max_ratio': 1.0,                                           │
│                        │                           'min_ratio': 0.8,                                           │
│                        │                           'text_key': 'text',                                         │
│                        │                           'tokenization': False}},                                    │
│                        │  {'character_repetition_filter': {'image_key': 'images',                              │
│                        │                                   'max_ratio': 0.3,                                   │
│                        │                                   'min_ratio': 0.0,                                   │
│                        │                                   'rep_len': 10,                                      │
│                        │                                   'text_key': 'text'}},                               │
│                        │  {'word_repetition_filter': {'image_key': 'images',                                   │
│                        │                              'lang': 'en',                                            │
│                        │                              'max_ratio': 0.5,                                        │
│                        │                              'min_ratio': 0.0,                                        │
│                        │                              'rep_len': 10,                                           │
│                        │                              'text_key': 'text',                                      │
│                        │                              'tokenization': False}}]                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/alpaca_data'                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240121120218'                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                 │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════╛
2024-01-21 12:02:18.259 | INFO     | data_juicer.core.analyser:__init__:39 - Using cache compression method: [None]
2024-01-21 12:02:18.260 | INFO     | data_juicer.core.analyser:__init__:44 - Setting up data formatter...
2024-01-21 12:02:18.261 | INFO     | data_juicer.core.analyser:__init__:53 - Preparing exporter...
2024-01-21 12:02:18.261 | INFO     | data_juicer.core.analyser:run:75 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 32873 examples [00:00, 207408.80 examples/s]Generating jsonl split: 52002 examples [00:00, 220482.61 examples/s]
2024-01-21 12:02:19.647 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-01-21 12:02:19.648 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 52002 sample(s) in the original dataset.
Filter (num_proc=4):   0%|                                                                      | 0/52002 [00:00<?, ? examples/s]Filter (num_proc=4):   2%|#                                                        | 1000/52002 [00:00<00:06, 8449.12 examples/s]Filter (num_proc=4):  19%|##########5                                            | 10000/52002 [00:00<00:00, 45142.31 examples/s]Filter (num_proc=4):  35%|###################                                    | 18000/52002 [00:00<00:00, 56514.41 examples/s]Filter (num_proc=4):  52%|############################5                          | 27000/52002 [00:00<00:00, 68002.01 examples/s]Filter (num_proc=4):  69%|######################################                 | 36000/52002 [00:00<00:00, 70875.71 examples/s]Filter (num_proc=4):  87%|###############################################5       | 45001/52002 [00:00<00:00, 73352.07 examples/s]Filter (num_proc=4): 100%|#######################################################| 52002/52002 [00:00<00:00, 58504.86 examples/s]
2024-01-21 12:02:20.653 | INFO     | data_juicer.format.formatter:unify_format:214 - 52002 samples left after filtering empty text.
2024-01-21 12:02:20.655 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 52002 from 52002
2024-01-21 12:02:20.658 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 52002 in final dataset
2024-01-21 12:02:20.659 | INFO     | data_juicer.core.analyser:run:81 - Preparing process operators...
2024-01-21 12:02:20.659 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-01-21 12:02:20.870 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-01-21 12:02:20.950 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-01-21 12:02:21.251 | INFO     | data_juicer.core.analyser:run:86 - Computing the stats of dataset...
Adding new column for stats (num_proc=4):   0%|                                                 | 0/52002 [00:00<?, ? examples/s]Adding new column for stats (num_proc=4):   1%|2                                    | 287/52002 [00:00<00:20, 2583.72 examples/s]Adding new column for stats (num_proc=4):   6%|##1                                | 3192/52002 [00:00<00:03, 15917.97 examples/s]Adding new column for stats (num_proc=4):  14%|#####                              | 7451/52002 [00:00<00:01, 24968.58 examples/s]Adding new column for stats (num_proc=4):  19%|######6                           | 10102/52002 [00:00<00:01, 25517.03 examples/s]Adding new column for stats (num_proc=4):  25%|########5                         | 13047/52002 [00:00<00:01, 25800.30 examples/s]Adding new column for stats (num_proc=4):  31%|##########5                       | 16180/52002 [00:00<00:01, 26668.45 examples/s]Adding new column for stats (num_proc=4):  37%|############5                     | 19131/52002 [00:00<00:01, 25054.30 examples/s]Adding new column for stats (num_proc=4):  42%|##############3                   | 22000/52002 [00:01<00:01, 16839.40 examples/s]Adding new column for stats (num_proc=4):  49%|################6                 | 25474/52002 [00:01<00:01, 20136.28 examples/s]Adding new column for stats (num_proc=4):  56%|###################               | 29109/52002 [00:01<00:00, 22950.11 examples/s]Adding new column for stats (num_proc=4):  62%|####################9             | 32065/52002 [00:01<00:00, 23288.70 examples/s]Adding new column for stats (num_proc=4):  67%|######################6           | 34655/52002 [00:01<00:00, 23721.07 examples/s]Adding new column for stats (num_proc=4):  74%|#########################1        | 38530/52002 [00:01<00:00, 26812.05 examples/s]Adding new column for stats (num_proc=4):  81%|###########################4      | 42029/52002 [00:01<00:00, 28174.86 examples/s]Adding new column for stats (num_proc=4):  87%|#############################6    | 45419/52002 [00:01<00:00, 26191.35 examples/s]Adding new column for stats (num_proc=4):  93%|###############################5  | 48321/52002 [00:02<00:00, 23882.73 examples/s]Adding new column for stats (num_proc=4):  98%|#################################2| 50853/52002 [00:02<00:00, 22012.08 examples/s]Adding new column for stats (num_proc=4): 100%|##################################| 52002/52002 [00:02<00:00, 21744.70 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/52002 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|2                               | 445/52002 [00:00<00:12, 4010.70 examples/s]text_length_filter_compute_stats (num_proc=4):   7%|##1                           | 3701/52002 [00:00<00:02, 18951.20 examples/s]text_length_filter_compute_stats (num_proc=4):  13%|###9                          | 6899/52002 [00:00<00:01, 24171.95 examples/s]text_length_filter_compute_stats (num_proc=4):  18%|#####5                        | 9603/52002 [00:00<00:01, 24783.64 examples/s]text_length_filter_compute_stats (num_proc=4):  24%|######9                      | 12531/52002 [00:00<00:01, 24076.08 examples/s]text_length_filter_compute_stats (num_proc=4):  30%|########6                    | 15532/52002 [00:00<00:01, 25906.46 examples/s]text_length_filter_compute_stats (num_proc=4):  36%|##########3                  | 18586/52002 [00:00<00:01, 26340.53 examples/s]text_length_filter_compute_stats (num_proc=4):  43%|############5                | 22470/52002 [00:00<00:01, 27897.51 examples/s]text_length_filter_compute_stats (num_proc=4):  49%|##############2              | 25590/52002 [00:01<00:00, 27964.12 examples/s]text_length_filter_compute_stats (num_proc=4):  55%|###############8             | 28489/52002 [00:01<00:00, 25884.06 examples/s]text_length_filter_compute_stats (num_proc=4):  61%|#################8           | 31969/52002 [00:01<00:00, 27758.50 examples/s]text_length_filter_compute_stats (num_proc=4):  67%|###################5         | 35060/52002 [00:01<00:00, 26187.99 examples/s]text_length_filter_compute_stats (num_proc=4):  74%|#####################4       | 38458/52002 [00:01<00:00, 27266.53 examples/s]text_length_filter_compute_stats (num_proc=4):  79%|######################9      | 41239/52002 [00:01<00:00, 16749.84 examples/s]text_length_filter_compute_stats (num_proc=4):  85%|########################7    | 44322/52002 [00:01<00:00, 19407.49 examples/s]text_length_filter_compute_stats (num_proc=4):  91%|##########################2  | 47113/52002 [00:02<00:00, 21039.00 examples/s]text_length_filter_compute_stats (num_proc=4):  96%|###########################8 | 50007/52002 [00:02<00:00, 21300.36 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 52002/52002 [00:02<00:00, 22034.45 examples/s]
language_id_score_filter_compute_stats (num_proc=4):   0%|                                      | 0/52002 [00:00<?, ? examples/s]language_id_score_filter_compute_stats (num_proc=4):   0%|1                         | 208/52002 [00:00<00:26, 1918.82 examples/s]language_id_score_filter_compute_stats (num_proc=4):   4%|#                       | 2246/52002 [00:00<00:04, 12205.66 examples/s]language_id_score_filter_compute_stats (num_proc=4):   7%|#8                       | 3769/52002 [00:00<00:04, 9774.09 examples/s]language_id_score_filter_compute_stats (num_proc=4):  11%|##5                     | 5528/52002 [00:00<00:04, 11554.70 examples/s]language_id_score_filter_compute_stats (num_proc=4):  14%|###3                    | 7285/52002 [00:00<00:03, 11414.27 examples/s]language_id_score_filter_compute_stats (num_proc=4):  18%|####3                   | 9504/52002 [00:00<00:03, 13507.42 examples/s]language_id_score_filter_compute_stats (num_proc=4):  22%|####9                  | 11262/52002 [00:00<00:02, 14582.70 examples/s]language_id_score_filter_compute_stats (num_proc=4):  25%|#####7                 | 13008/52002 [00:01<00:02, 13956.11 examples/s]language_id_score_filter_compute_stats (num_proc=4):  29%|######6                | 14963/52002 [00:01<00:02, 15423.18 examples/s]language_id_score_filter_compute_stats (num_proc=4):  32%|#######4               | 16756/52002 [00:01<00:02, 13326.01 examples/s]language_id_score_filter_compute_stats (num_proc=4):  36%|########2              | 18758/52002 [00:01<00:02, 14948.59 examples/s]language_id_score_filter_compute_stats (num_proc=4):  39%|#########              | 20465/52002 [00:01<00:02, 12853.04 examples/s]language_id_score_filter_compute_stats (num_proc=4):  43%|#########9             | 22508/52002 [00:01<00:02, 14619.89 examples/s]language_id_score_filter_compute_stats (num_proc=4):  47%|##########7            | 24250/52002 [00:01<00:02, 13520.72 examples/s]language_id_score_filter_compute_stats (num_proc=4):  50%|###########5           | 26201/52002 [00:01<00:01, 14941.22 examples/s]language_id_score_filter_compute_stats (num_proc=4):  54%|############3          | 27926/52002 [00:02<00:01, 14069.89 examples/s]language_id_score_filter_compute_stats (num_proc=4):  57%|#############1         | 29641/52002 [00:02<00:01, 14797.54 examples/s]language_id_score_filter_compute_stats (num_proc=4):  60%|#############8         | 31308/52002 [00:02<00:01, 14533.49 examples/s]language_id_score_filter_compute_stats (num_proc=4):  64%|###############2        | 33114/52002 [00:02<00:01, 9510.20 examples/s]language_id_score_filter_compute_stats (num_proc=4):  68%|###############5       | 35180/52002 [00:02<00:01, 11443.42 examples/s]language_id_score_filter_compute_stats (num_proc=4):  71%|################2      | 36850/52002 [00:02<00:01, 11924.59 examples/s]language_id_score_filter_compute_stats (num_proc=4):  75%|#################2     | 39096/52002 [00:02<00:00, 14156.30 examples/s]language_id_score_filter_compute_stats (num_proc=4):  79%|##################     | 40913/52002 [00:03<00:00, 14334.32 examples/s]language_id_score_filter_compute_stats (num_proc=4):  82%|##################9    | 42777/52002 [00:03<00:00, 15147.16 examples/s]language_id_score_filter_compute_stats (num_proc=4):  86%|###################7   | 44649/52002 [00:03<00:00, 15219.09 examples/s]language_id_score_filter_compute_stats (num_proc=4):  89%|####################5  | 46445/52002 [00:03<00:00, 15917.08 examples/s]language_id_score_filter_compute_stats (num_proc=4):  93%|#####################2 | 48126/52002 [00:03<00:00, 15160.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):  97%|######################2| 50385/52002 [00:03<00:00, 17118.14 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|#######################| 52002/52002 [00:04<00:00, 12780.08 examples/s]
perplexity_filter_compute_stats (num_proc=4):   0%|                                             | 0/52002 [00:00<?, ? examples/s]perplexity_filter_compute_stats (num_proc=4):   0%|                                   | 52/52002 [00:00<01:52, 462.67 examples/s]perplexity_filter_compute_stats (num_proc=4):   1%|4                                | 779/52002 [00:00<00:12, 4233.49 examples/s]perplexity_filter_compute_stats (num_proc=4):   3%|9                               | 1605/52002 [00:00<00:08, 5988.79 examples/s]perplexity_filter_compute_stats (num_proc=4):   5%|#5                              | 2570/52002 [00:00<00:06, 7380.23 examples/s]perplexity_filter_compute_stats (num_proc=4):   7%|##1                             | 3429/52002 [00:00<00:06, 7791.26 examples/s]perplexity_filter_compute_stats (num_proc=4):   8%|##6                             | 4250/52002 [00:00<00:06, 7797.39 examples/s]perplexity_filter_compute_stats (num_proc=4):  11%|###3                            | 5524/52002 [00:00<00:04, 9302.13 examples/s]perplexity_filter_compute_stats (num_proc=4):  13%|####                            | 6524/52002 [00:00<00:04, 9517.80 examples/s]perplexity_filter_compute_stats (num_proc=4):  15%|####6                          | 7791/52002 [00:00<00:04, 10488.28 examples/s]perplexity_filter_compute_stats (num_proc=4):  17%|#####4                          | 8931/52002 [00:01<00:04, 9696.02 examples/s]perplexity_filter_compute_stats (num_proc=4):  19%|#####7                        | 10048/52002 [00:01<00:04, 10097.53 examples/s]perplexity_filter_compute_stats (num_proc=4):  22%|######5                       | 11278/52002 [00:01<00:03, 10721.88 examples/s]perplexity_filter_compute_stats (num_proc=4):  24%|#######3                      | 12661/52002 [00:01<00:03, 11481.12 examples/s]perplexity_filter_compute_stats (num_proc=4):  27%|########                      | 13874/52002 [00:01<00:03, 11498.20 examples/s]perplexity_filter_compute_stats (num_proc=4):  29%|########7                     | 15241/52002 [00:01<00:03, 12116.93 examples/s]perplexity_filter_compute_stats (num_proc=4):  32%|#########5                    | 16527/52002 [00:01<00:03, 11727.19 examples/s]perplexity_filter_compute_stats (num_proc=4):  34%|##########3                   | 17899/52002 [00:01<00:02, 11496.36 examples/s]perplexity_filter_compute_stats (num_proc=4):  37%|###########1                  | 19306/52002 [00:01<00:02, 12186.64 examples/s]perplexity_filter_compute_stats (num_proc=4):  40%|###########9                  | 20643/52002 [00:02<00:02, 12178.37 examples/s]perplexity_filter_compute_stats (num_proc=4):  42%|############6                 | 21920/52002 [00:02<00:02, 12325.17 examples/s]perplexity_filter_compute_stats (num_proc=4):  45%|#############4                | 23303/52002 [00:02<00:02, 12439.86 examples/s]perplexity_filter_compute_stats (num_proc=4):  48%|##############2               | 24753/52002 [00:02<00:02, 13013.66 examples/s]perplexity_filter_compute_stats (num_proc=4):  50%|###############               | 26067/52002 [00:02<00:02, 12751.03 examples/s]perplexity_filter_compute_stats (num_proc=4):  53%|################              | 27744/52002 [00:02<00:01, 13543.07 examples/s]perplexity_filter_compute_stats (num_proc=4):  56%|################8             | 29226/52002 [00:02<00:01, 13500.53 examples/s]perplexity_filter_compute_stats (num_proc=4):  59%|#################6            | 30625/52002 [00:02<00:01, 12238.98 examples/s]perplexity_filter_compute_stats (num_proc=4):  61%|##################4           | 31970/52002 [00:02<00:01, 12194.06 examples/s]perplexity_filter_compute_stats (num_proc=4):  64%|###################1          | 33250/52002 [00:03<00:01, 11920.81 examples/s]perplexity_filter_compute_stats (num_proc=4):  66%|###################8          | 34478/52002 [00:03<00:01, 11949.21 examples/s]perplexity_filter_compute_stats (num_proc=4):  69%|#####################3         | 35775/52002 [00:03<00:01, 9290.18 examples/s]perplexity_filter_compute_stats (num_proc=4):  72%|#####################4        | 37187/52002 [00:03<00:01, 10018.00 examples/s]perplexity_filter_compute_stats (num_proc=4):  74%|######################1       | 38437/52002 [00:03<00:01, 10601.59 examples/s]perplexity_filter_compute_stats (num_proc=4):  77%|######################9       | 39832/52002 [00:03<00:01, 11456.31 examples/s]perplexity_filter_compute_stats (num_proc=4):  79%|#######################6      | 41068/52002 [00:03<00:00, 11687.98 examples/s]perplexity_filter_compute_stats (num_proc=4):  82%|########################5     | 42590/52002 [00:03<00:00, 12241.36 examples/s]perplexity_filter_compute_stats (num_proc=4):  85%|#########################4    | 44103/52002 [00:03<00:00, 13033.48 examples/s]perplexity_filter_compute_stats (num_proc=4):  87%|##########################2   | 45436/52002 [00:04<00:00, 13099.79 examples/s]perplexity_filter_compute_stats (num_proc=4):  90%|###########################   | 46941/52002 [00:04<00:00, 13224.07 examples/s]perplexity_filter_compute_stats (num_proc=4):  93%|###########################8  | 48317/52002 [00:04<00:00, 13371.72 examples/s]perplexity_filter_compute_stats (num_proc=4):  96%|############################6 | 49697/52002 [00:04<00:00, 11783.41 examples/s]perplexity_filter_compute_stats (num_proc=4):  98%|#############################4| 51116/52002 [00:04<00:00, 11359.34 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|##############################| 52002/52002 [00:04<00:00, 10862.60 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/52002 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|3                               | 573/52002 [00:00<00:09, 5252.48 examples/s]text_length_filter_compute_stats (num_proc=4):   8%|##3                           | 4000/52002 [00:00<00:02, 19391.51 examples/s]text_length_filter_compute_stats (num_proc=4):  17%|####9                         | 8581/52002 [00:00<00:01, 27292.80 examples/s]text_length_filter_compute_stats (num_proc=4):  23%|######6                      | 11945/52002 [00:00<00:01, 27935.25 examples/s]text_length_filter_compute_stats (num_proc=4):  30%|########6                    | 15450/52002 [00:00<00:01, 29320.46 examples/s]text_length_filter_compute_stats (num_proc=4):  37%|##########5                  | 19000/52002 [00:00<00:01, 30599.52 examples/s]text_length_filter_compute_stats (num_proc=4):  45%|#############1               | 23618/52002 [00:00<00:00, 31325.93 examples/s]text_length_filter_compute_stats (num_proc=4):  52%|###############              | 26969/52002 [00:00<00:00, 31302.39 examples/s]text_length_filter_compute_stats (num_proc=4):  58%|################9            | 30395/52002 [00:01<00:00, 22357.54 examples/s]text_length_filter_compute_stats (num_proc=4):  66%|###################1         | 34254/52002 [00:01<00:00, 23697.83 examples/s]text_length_filter_compute_stats (num_proc=4):  72%|####################7        | 37256/52002 [00:01<00:00, 24257.80 examples/s]text_length_filter_compute_stats (num_proc=4):  78%|######################4      | 40327/52002 [00:01<00:00, 24699.31 examples/s]text_length_filter_compute_stats (num_proc=4):  84%|########################4    | 43909/52002 [00:01<00:00, 27194.37 examples/s]text_length_filter_compute_stats (num_proc=4):  93%|##########################9  | 48271/52002 [00:01<00:00, 29454.33 examples/s]text_length_filter_compute_stats (num_proc=4):  99%|############################7| 51506/52002 [00:02<00:00, 17949.73 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 52002/52002 [00:02<00:00, 22058.29 examples/s]
alphanumeric_filter_compute_stats (num_proc=4):   0%|                                           | 0/52002 [00:00<?, ? examples/s]alphanumeric_filter_compute_stats (num_proc=4):   0%|1                              | 169/52002 [00:00<00:34, 1520.24 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   5%|#3                           | 2440/52002 [00:00<00:03, 13351.17 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   8%|##1                          | 3936/52002 [00:00<00:03, 13819.93 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  12%|###5                         | 6328/52002 [00:00<00:02, 17001.96 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  16%|####5                        | 8161/52002 [00:00<00:02, 16455.69 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  20%|#####6                      | 10585/52002 [00:00<00:02, 18607.17 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  24%|######7                     | 12512/52002 [00:00<00:02, 17300.87 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  28%|#######8                    | 14614/52002 [00:00<00:02, 18253.10 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  32%|########8                   | 16467/52002 [00:01<00:02, 17281.80 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  36%|##########1                 | 18903/52002 [00:01<00:01, 18473.76 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  40%|###########1                | 20789/52002 [00:01<00:01, 17732.00 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  45%|############5               | 23325/52002 [00:01<00:01, 19068.59 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  49%|#############6              | 25318/52002 [00:01<00:01, 17978.36 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  52%|##############6             | 27252/52002 [00:01<00:01, 18330.90 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  56%|###############6            | 29117/52002 [00:01<00:01, 18363.85 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  60%|################7           | 31067/52002 [00:01<00:01, 18181.35 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  64%|#################9          | 33313/52002 [00:01<00:01, 17675.74 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  68%|##################9         | 35262/52002 [00:02<00:00, 17420.05 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  72%|####################1       | 37352/52002 [00:02<00:00, 15703.73 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  76%|#####################4      | 39749/52002 [00:02<00:00, 17637.96 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  80%|######################4     | 41653/52002 [00:02<00:00, 12843.47 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  84%|#######################5    | 43657/52002 [00:02<00:00, 14048.06 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  88%|########################6   | 45705/52002 [00:02<00:00, 14655.11 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  92%|#########################8  | 48033/52002 [00:02<00:00, 16404.32 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  96%|##########################9 | 50064/52002 [00:03<00:00, 16102.98 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|###########################9| 52001/52002 [00:03<00:00, 15729.65 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|############################| 52002/52002 [00:03<00:00, 16007.39 examples/s]
character_repetition_filter_compute_stats (num_proc=4):   0%|                                   | 0/52002 [00:00<?, ? examples/s]character_repetition_filter_compute_stats (num_proc=4):   0%|                         | 86/52002 [00:00<01:04, 804.88 examples/s]character_repetition_filter_compute_stats (num_proc=4):   2%|4                     | 1162/52002 [00:00<00:08, 6153.28 examples/s]character_repetition_filter_compute_stats (num_proc=4):   4%|9                     | 2204/52002 [00:00<00:06, 7996.75 examples/s]character_repetition_filter_compute_stats (num_proc=4):   6%|#3                    | 3229/52002 [00:00<00:05, 8849.68 examples/s]character_repetition_filter_compute_stats (num_proc=4):   8%|#7                    | 4238/52002 [00:00<00:05, 8340.09 examples/s]character_repetition_filter_compute_stats (num_proc=4):  10%|##2                   | 5246/52002 [00:00<00:05, 8866.88 examples/s]character_repetition_filter_compute_stats (num_proc=4):  12%|##6                   | 6355/52002 [00:00<00:04, 9527.73 examples/s]character_repetition_filter_compute_stats (num_proc=4):  14%|###1                  | 7384/52002 [00:00<00:04, 9060.39 examples/s]character_repetition_filter_compute_stats (num_proc=4):  16%|###5                  | 8342/52002 [00:00<00:04, 9120.14 examples/s]character_repetition_filter_compute_stats (num_proc=4):  18%|###9                  | 9297/52002 [00:01<00:04, 8675.40 examples/s]character_repetition_filter_compute_stats (num_proc=4):  20%|####1                | 10321/52002 [00:01<00:04, 9085.47 examples/s]character_repetition_filter_compute_stats (num_proc=4):  22%|####5                | 11362/52002 [00:01<00:04, 9346.94 examples/s]character_repetition_filter_compute_stats (num_proc=4):  24%|####9                | 12305/52002 [00:01<00:04, 8743.45 examples/s]character_repetition_filter_compute_stats (num_proc=4):  25%|#####3               | 13246/52002 [00:01<00:04, 8861.09 examples/s]character_repetition_filter_compute_stats (num_proc=4):  27%|#####7               | 14289/52002 [00:01<00:04, 9287.89 examples/s]character_repetition_filter_compute_stats (num_proc=4):  30%|######1              | 15345/52002 [00:01<00:03, 9554.80 examples/s]character_repetition_filter_compute_stats (num_proc=4):  31%|######5              | 16332/52002 [00:01<00:03, 9078.33 examples/s]character_repetition_filter_compute_stats (num_proc=4):  33%|#######              | 17379/52002 [00:01<00:03, 9456.64 examples/s]character_repetition_filter_compute_stats (num_proc=4):  35%|#######4             | 18360/52002 [00:02<00:03, 9020.51 examples/s]character_repetition_filter_compute_stats (num_proc=4):  37%|#######7             | 19311/52002 [00:02<00:03, 9141.79 examples/s]character_repetition_filter_compute_stats (num_proc=4):  39%|########2            | 20368/52002 [00:02<00:03, 9401.04 examples/s]character_repetition_filter_compute_stats (num_proc=4):  41%|########6            | 21463/52002 [00:02<00:03, 9835.91 examples/s]character_repetition_filter_compute_stats (num_proc=4):  43%|#########1           | 22606/52002 [00:02<00:03, 9361.15 examples/s]character_repetition_filter_compute_stats (num_proc=4):  46%|#########5           | 23673/52002 [00:02<00:03, 9389.29 examples/s]character_repetition_filter_compute_stats (num_proc=4):  47%|#########9           | 24672/52002 [00:02<00:02, 9536.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  50%|##########4          | 25791/52002 [00:02<00:02, 9982.13 examples/s]character_repetition_filter_compute_stats (num_proc=4):  52%|##########8          | 26879/52002 [00:02<00:02, 9859.41 examples/s]character_repetition_filter_compute_stats (num_proc=4):  54%|###########2         | 27971/52002 [00:03<00:02, 9321.81 examples/s]character_repetition_filter_compute_stats (num_proc=4):  56%|###########6         | 28948/52002 [00:03<00:02, 9420.21 examples/s]character_repetition_filter_compute_stats (num_proc=4):  58%|############         | 29942/52002 [00:03<00:02, 9554.31 examples/s]character_repetition_filter_compute_stats (num_proc=4):  60%|############5        | 30977/52002 [00:03<00:02, 8949.34 examples/s]character_repetition_filter_compute_stats (num_proc=4):  61%|############9        | 31954/52002 [00:03<00:02, 9167.05 examples/s]character_repetition_filter_compute_stats (num_proc=4):  63%|#############3       | 32936/52002 [00:03<00:02, 8978.79 examples/s]character_repetition_filter_compute_stats (num_proc=4):  65%|#############6       | 33881/52002 [00:03<00:02, 8762.77 examples/s]character_repetition_filter_compute_stats (num_proc=4):  67%|##############       | 34861/52002 [00:03<00:01, 9042.58 examples/s]character_repetition_filter_compute_stats (num_proc=4):  69%|##############4      | 35850/52002 [00:03<00:01, 9273.15 examples/s]character_repetition_filter_compute_stats (num_proc=4):  71%|##############9      | 36912/52002 [00:04<00:01, 8389.27 examples/s]character_repetition_filter_compute_stats (num_proc=4):  73%|###############2     | 37865/52002 [00:04<00:02, 6868.04 examples/s]character_repetition_filter_compute_stats (num_proc=4):  75%|###############7     | 38910/52002 [00:04<00:01, 7669.03 examples/s]character_repetition_filter_compute_stats (num_proc=4):  77%|################1    | 39978/52002 [00:04<00:01, 8398.78 examples/s]character_repetition_filter_compute_stats (num_proc=4):  79%|################5    | 41076/52002 [00:04<00:01, 8619.92 examples/s]character_repetition_filter_compute_stats (num_proc=4):  81%|################9    | 42031/52002 [00:04<00:01, 8284.79 examples/s]character_repetition_filter_compute_stats (num_proc=4):  83%|#################3   | 42944/52002 [00:04<00:01, 7685.99 examples/s]character_repetition_filter_compute_stats (num_proc=4):  84%|#################6   | 43823/52002 [00:05<00:01, 7766.31 examples/s]character_repetition_filter_compute_stats (num_proc=4):  86%|##################   | 44680/52002 [00:05<00:00, 7954.07 examples/s]character_repetition_filter_compute_stats (num_proc=4):  88%|##################4  | 45657/52002 [00:05<00:00, 8439.14 examples/s]character_repetition_filter_compute_stats (num_proc=4):  90%|##################8  | 46745/52002 [00:05<00:00, 9113.81 examples/s]character_repetition_filter_compute_stats (num_proc=4):  92%|###################2 | 47686/52002 [00:05<00:00, 9191.63 examples/s]character_repetition_filter_compute_stats (num_proc=4):  94%|###################6 | 48772/52002 [00:05<00:00, 7695.01 examples/s]character_repetition_filter_compute_stats (num_proc=4):  95%|#################### | 49615/52002 [00:05<00:00, 6961.51 examples/s]character_repetition_filter_compute_stats (num_proc=4):  97%|####################3| 50427/52002 [00:05<00:00, 5801.05 examples/s]character_repetition_filter_compute_stats (num_proc=4):  98%|####################6| 51077/52002 [00:06<00:00, 5427.13 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|####################8| 51752/52002 [00:06<00:00, 5094.70 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|#####################| 52002/52002 [00:06<00:00, 8023.78 examples/s]
word_repetition_filter_compute_stats (num_proc=4):   0%|                                        | 0/52002 [00:00<?, ? examples/s]word_repetition_filter_compute_stats (num_proc=4):   0%|                            | 184/52002 [00:00<00:31, 1660.39 examples/s]word_repetition_filter_compute_stats (num_proc=4):   4%|9                         | 1923/52002 [00:00<00:04, 10145.81 examples/s]word_repetition_filter_compute_stats (num_proc=4):   7%|#6                        | 3395/52002 [00:00<00:04, 12131.09 examples/s]word_repetition_filter_compute_stats (num_proc=4):   9%|##3                       | 4782/52002 [00:00<00:03, 11899.59 examples/s]word_repetition_filter_compute_stats (num_proc=4):  13%|###2                      | 6571/52002 [00:00<00:03, 12840.86 examples/s]word_repetition_filter_compute_stats (num_proc=4):  15%|####                      | 8008/52002 [00:00<00:03, 12651.91 examples/s]word_repetition_filter_compute_stats (num_proc=4):  18%|####6                     | 9275/52002 [00:00<00:03, 12646.17 examples/s]word_repetition_filter_compute_stats (num_proc=4):  21%|#####1                   | 10795/52002 [00:00<00:03, 13395.05 examples/s]word_repetition_filter_compute_stats (num_proc=4):  23%|#####8                   | 12180/52002 [00:00<00:03, 13186.32 examples/s]word_repetition_filter_compute_stats (num_proc=4):  26%|######5                  | 13680/52002 [00:01<00:02, 12808.63 examples/s]word_repetition_filter_compute_stats (num_proc=4):  29%|#######3                 | 15190/52002 [00:01<00:02, 13439.23 examples/s]word_repetition_filter_compute_stats (num_proc=4):  32%|########                 | 16733/52002 [00:01<00:02, 12995.08 examples/s]word_repetition_filter_compute_stats (num_proc=4):  35%|########7                | 18106/52002 [00:01<00:02, 13181.08 examples/s]word_repetition_filter_compute_stats (num_proc=4):  37%|#########3               | 19445/52002 [00:01<00:02, 13239.40 examples/s]word_repetition_filter_compute_stats (num_proc=4):  40%|##########               | 20953/52002 [00:01<00:02, 13429.36 examples/s]word_repetition_filter_compute_stats (num_proc=4):  43%|##########7              | 22375/52002 [00:01<00:02, 12671.76 examples/s]word_repetition_filter_compute_stats (num_proc=4):  46%|###########4             | 23803/52002 [00:01<00:02, 12848.07 examples/s]word_repetition_filter_compute_stats (num_proc=4):  49%|############1            | 25323/52002 [00:01<00:01, 13485.28 examples/s]word_repetition_filter_compute_stats (num_proc=4):  51%|############8            | 26758/52002 [00:02<00:01, 13598.26 examples/s]word_repetition_filter_compute_stats (num_proc=4):  54%|#############5           | 28286/52002 [00:02<00:01, 12871.64 examples/s]word_repetition_filter_compute_stats (num_proc=4):  57%|##############2          | 29669/52002 [00:02<00:01, 12723.65 examples/s]word_repetition_filter_compute_stats (num_proc=4):  60%|##############8          | 30989/52002 [00:02<00:01, 11822.74 examples/s]word_repetition_filter_compute_stats (num_proc=4):  62%|###############5         | 32412/52002 [00:02<00:01, 12457.59 examples/s]word_repetition_filter_compute_stats (num_proc=4):  65%|################2        | 33750/52002 [00:02<00:01, 12442.69 examples/s]word_repetition_filter_compute_stats (num_proc=4):  67%|################8        | 35064/52002 [00:02<00:01, 12134.85 examples/s]word_repetition_filter_compute_stats (num_proc=4):  70%|##################1       | 36381/52002 [00:03<00:02, 7418.85 examples/s]word_repetition_filter_compute_stats (num_proc=4):  72%|##################7       | 37451/52002 [00:03<00:01, 8042.37 examples/s]word_repetition_filter_compute_stats (num_proc=4):  75%|###################3      | 38770/52002 [00:03<00:01, 9139.35 examples/s]word_repetition_filter_compute_stats (num_proc=4):  77%|####################      | 40013/52002 [00:03<00:01, 9239.67 examples/s]word_repetition_filter_compute_stats (num_proc=4):  80%|###################9     | 41429/52002 [00:03<00:01, 10396.62 examples/s]word_repetition_filter_compute_stats (num_proc=4):  82%|####################5    | 42763/52002 [00:03<00:00, 10824.25 examples/s]word_repetition_filter_compute_stats (num_proc=4):  85%|#####################2   | 44099/52002 [00:03<00:00, 11468.46 examples/s]word_repetition_filter_compute_stats (num_proc=4):  88%|#####################8   | 45519/52002 [00:03<00:00, 12201.97 examples/s]word_repetition_filter_compute_stats (num_proc=4):  90%|######################5  | 46802/52002 [00:03<00:00, 12010.92 examples/s]word_repetition_filter_compute_stats (num_proc=4):  93%|#######################2 | 48285/52002 [00:04<00:00, 12794.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  96%|#######################9 | 49745/52002 [00:04<00:00, 12553.43 examples/s]word_repetition_filter_compute_stats (num_proc=4):  98%|########################5| 51039/52002 [00:04<00:00, 10866.62 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|#########################| 52002/52002 [00:04<00:00, 11288.57 examples/s]
2024-01-21 12:02:52.962 | INFO     | data_juicer.core.analyser:run:110 - Exporting dataset to disk...
2024-01-21 12:02:52.964 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                    | 0/53 [00:00<?, ?ba/s]Creating json from Arrow format:  26%|###############3                                          | 14/53 [00:00<00:00, 139.82ba/s]Creating json from Arrow format:  55%|###############################7                          | 29/53 [00:00<00:00, 145.53ba/s]Creating json from Arrow format:  87%|##################################################3       | 46/53 [00:00<00:00, 152.63ba/s]Creating json from Arrow format: 100%|##########################################################| 53/53 [00:00<00:00, 153.85ba/s]
2024-01-21 12:02:53.316 | INFO     | data_juicer.core.analyser:run:122 - Applying overall analysis on stats...
  0%|                                                                                                      | 0/7 [00:00<?, ?it/s]100%|###########################################################################################| 7/7 [00:00<00:00, 24365.25it/s]
2024-01-21 12:02:54.582 | INFO     | data_juicer.core.analyser:run:127 - The overall analysis results are:        alnum_ratio char_rep_ratio     lang lang_score   perplexity    text_len word_rep_ratio
count      52002.0        52002.0  52002.0    52002.0      52002.0     52002.0        52002.0
mean      0.796559       0.075511      NaN   0.896964    697.53827  355.005904       0.006082
std       0.045666        0.05601      NaN   0.119198  1882.061579   278.43287       0.042553
min       0.186667            0.0      NaN    0.03427          7.6        16.0            0.0
25%       0.785714       0.020085      NaN     0.8825        186.9       141.0            0.0
50%       0.806076       0.081937      NaN   0.936875        317.7       276.0            0.0
75%       0.821918       0.114286      NaN   0.964116      648.275       504.0            0.0
max       0.935252        0.75827      NaN   0.999853     227322.5      4293.0       0.923077
unique         NaN            NaN     19.0        NaN          NaN         NaN            NaN
top            NaN            NaN       en        NaN          NaN         NaN            NaN
freq           NaN            NaN  51895.0        NaN          NaN         NaN            NaN
2024-01-21 12:02:54.583 | INFO     | data_juicer.core.analyser:run:129 - Applying column-wise analysis on stats...
Column:   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Column:  14%|############2                                                                         | 1/7 [00:00<00:04,  1.23it/s]Column:  29%|########################5                                                             | 2/7 [00:01<00:03,  1.31it/s]Column:  43%|####################################8                                                 | 3/7 [00:02<00:02,  1.50it/s]Column:  57%|#################################################1                                    | 4/7 [00:02<00:02,  1.43it/s]Column:  71%|#############################################################4                        | 5/7 [00:03<00:01,  1.28it/s]Column:  86%|#########################################################################7            | 6/7 [00:04<00:00,  1.31it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.33it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.34it/s]
