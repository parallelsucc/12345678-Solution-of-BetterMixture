2024-01-21 12:01:26.639 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/./config/Vicuna.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/output/analysis/Vicuna]
2024-01-21 12:01:26.652 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                      │
╞════════════════════════╪═════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./config/Vicuna.yaml, cwd=/root/autodl-tmp/dj_mixture_challenge)]  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                        │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                        │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'Vicuna'                                                                    │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                   │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/Vicuna.jsonl'                  │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/Vicuna/Vicuna.jsonl' │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                           │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                      │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                    │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                             │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                             │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                          │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                        │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/.cache/huggingface/datasets'                                         │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                        │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                        │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                          │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                          │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'text_length_filter': {'image_key': 'images',                             │
│                        │                          'max_len': 4096,                                   │
│                        │                          'min_len': 1,                                      │
│                        │                          'text_key': 'text'}},                              │
│                        │  {'language_id_score_filter': {'image_key': 'images',                       │
│                        │                                'lang': 'en',                                │
│                        │                                'min_score': 0.8,                            │
│                        │                                'text_key': 'text'}},                        │
│                        │  {'perplexity_filter': {'image_key': 'images',                              │
│                        │                         'lang': 'en',                                       │
│                        │                         'max_ppl': 1500,                                    │
│                        │                         'text_key': 'text'}},                               │
│                        │  {'text_length_filter': {'image_key': 'images',                             │
│                        │                          'max_len': 10000,                                  │
│                        │                          'min_len': 1.0,                                    │
│                        │                          'text_key': 'text'}},                              │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                            │
│                        │                           'max_ratio': 1.0,                                 │
│                        │                           'min_ratio': 0.8,                                 │
│                        │                           'text_key': 'text',                               │
│                        │                           'tokenization': False}},                          │
│                        │  {'character_repetition_filter': {'image_key': 'images',                    │
│                        │                                   'max_ratio': 0.3,                         │
│                        │                                   'min_ratio': 0.0,                         │
│                        │                                   'rep_len': 10,                            │
│                        │                                   'text_key': 'text'}},                     │
│                        │  {'word_repetition_filter': {'image_key': 'images',                         │
│                        │                              'lang': 'en',                                  │
│                        │                              'max_ratio': 0.5,                              │
│                        │                              'min_ratio': 0.0,                              │
│                        │                              'rep_len': 10,                                 │
│                        │                              'text_key': 'text',                            │
│                        │                              'tokenization': False}}]                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                       │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                      │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/Vicuna'              │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240121120126'                                                            │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                               │
├────────────────────────┼─────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                       │
╘════════════════════════╧═════════════════════════════════════════════════════════════════════════════╛
2024-01-21 12:01:26.653 | INFO     | data_juicer.core.analyser:__init__:39 - Using cache compression method: [None]
2024-01-21 12:01:26.653 | INFO     | data_juicer.core.analyser:__init__:44 - Setting up data formatter...
2024-01-21 12:01:26.654 | INFO     | data_juicer.core.analyser:__init__:53 - Preparing exporter...
2024-01-21 12:01:26.654 | INFO     | data_juicer.core.analyser:run:75 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 32896 examples [00:00, 238130.77 examples/s]Generating jsonl split: 51974 examples [00:00, 256367.90 examples/s]
2024-01-21 12:01:28.255 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-01-21 12:01:28.256 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 51974 sample(s) in the original dataset.
Filter (num_proc=4):   0%|                                                                      | 0/51974 [00:00<?, ? examples/s]Filter (num_proc=4):   2%|#                                                        | 1000/51974 [00:00<00:06, 7882.13 examples/s]Filter (num_proc=4):  19%|##########5                                            | 10000/51974 [00:00<00:00, 48879.05 examples/s]Filter (num_proc=4):  35%|###################                                    | 18000/51974 [00:00<00:00, 59433.32 examples/s]Filter (num_proc=4):  52%|############################5                          | 27000/51974 [00:00<00:00, 68218.79 examples/s]Filter (num_proc=4):  67%|#####################################                  | 35000/51974 [00:00<00:00, 69818.39 examples/s]Filter (num_proc=4):  83%|#############################################5         | 43000/51974 [00:00<00:00, 71002.65 examples/s]Filter (num_proc=4):  98%|#####################################################9 | 50980/51974 [00:00<00:00, 71661.45 examples/s]Filter (num_proc=4): 100%|#######################################################| 51974/51974 [00:00<00:00, 59114.11 examples/s]
2024-01-21 12:01:29.257 | INFO     | data_juicer.format.formatter:unify_format:214 - 51974 samples left after filtering empty text.
2024-01-21 12:01:29.259 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 51974 from 51974
2024-01-21 12:01:29.262 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 51974 in final dataset
2024-01-21 12:01:29.263 | INFO     | data_juicer.core.analyser:run:81 - Preparing process operators...
2024-01-21 12:01:29.263 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-01-21 12:01:29.474 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-01-21 12:01:29.552 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-01-21 12:01:29.853 | INFO     | data_juicer.core.analyser:run:86 - Computing the stats of dataset...
Adding new column for stats (num_proc=4):   0%|                                                 | 0/51974 [00:00<?, ? examples/s]Adding new column for stats (num_proc=4):   1%|2                                    | 420/51974 [00:00<00:13, 3821.39 examples/s]Adding new column for stats (num_proc=4):   8%|##6                                | 3906/51974 [00:00<00:02, 19158.71 examples/s]Adding new column for stats (num_proc=4):  15%|#####3                             | 7971/51974 [00:00<00:01, 27881.84 examples/s]Adding new column for stats (num_proc=4):  21%|#######1                          | 10998/51974 [00:00<00:01, 28179.11 examples/s]Adding new column for stats (num_proc=4):  27%|#########1                        | 14062/51974 [00:00<00:01, 25248.31 examples/s]Adding new column for stats (num_proc=4):  33%|###########2                      | 17184/51974 [00:00<00:01, 26859.49 examples/s]Adding new column for stats (num_proc=4):  38%|#############                     | 19994/51974 [00:00<00:01, 18406.64 examples/s]Adding new column for stats (num_proc=4):  43%|##############5                   | 22255/51974 [00:01<00:01, 18739.49 examples/s]Adding new column for stats (num_proc=4):  48%|################3                 | 24999/51974 [00:01<00:01, 19856.11 examples/s]Adding new column for stats (num_proc=4):  54%|##################2               | 27882/51974 [00:01<00:01, 21283.38 examples/s]Adding new column for stats (num_proc=4):  60%|####################4             | 31250/51974 [00:01<00:00, 24194.55 examples/s]Adding new column for stats (num_proc=4):  67%|######################6           | 34630/51974 [00:01<00:00, 25925.34 examples/s]Adding new column for stats (num_proc=4):  74%|#########################         | 38263/51974 [00:01<00:00, 27897.81 examples/s]Adding new column for stats (num_proc=4):  82%|###########################8      | 42601/51974 [00:01<00:00, 29458.50 examples/s]Adding new column for stats (num_proc=4):  89%|##############################2   | 46229/51974 [00:01<00:00, 29915.30 examples/s]Adding new column for stats (num_proc=4):  95%|################################4 | 49572/51974 [00:02<00:00, 26259.92 examples/s]Adding new column for stats (num_proc=4): 100%|##################################| 51974/51974 [00:02<00:00, 21065.15 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/51974 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|1                               | 273/51974 [00:00<00:21, 2416.57 examples/s]text_length_filter_compute_stats (num_proc=4):   6%|#8                            | 3155/51974 [00:00<00:03, 15734.23 examples/s]text_length_filter_compute_stats (num_proc=4):  14%|####2                         | 7372/51974 [00:00<00:01, 24158.97 examples/s]text_length_filter_compute_stats (num_proc=4):  19%|#####7                        | 9989/51974 [00:00<00:01, 24855.78 examples/s]text_length_filter_compute_stats (num_proc=4):  25%|#######2                     | 13026/51974 [00:00<00:01, 26652.84 examples/s]text_length_filter_compute_stats (num_proc=4):  31%|########9                    | 15986/51974 [00:00<00:01, 26324.22 examples/s]text_length_filter_compute_stats (num_proc=4):  37%|##########6                  | 19079/51974 [00:00<00:01, 27601.04 examples/s]text_length_filter_compute_stats (num_proc=4):  43%|############3                | 22196/51974 [00:00<00:01, 28204.61 examples/s]text_length_filter_compute_stats (num_proc=4):  48%|##############               | 25188/51974 [00:00<00:00, 27863.56 examples/s]text_length_filter_compute_stats (num_proc=4):  56%|################1            | 29017/51974 [00:01<00:00, 30861.63 examples/s]text_length_filter_compute_stats (num_proc=4):  63%|##################1          | 32548/51974 [00:01<00:00, 25968.86 examples/s]text_length_filter_compute_stats (num_proc=4):  69%|###################8         | 35618/51974 [00:01<00:00, 23067.37 examples/s]text_length_filter_compute_stats (num_proc=4):  74%|#####################4       | 38446/51974 [00:01<00:00, 18532.25 examples/s]text_length_filter_compute_stats (num_proc=4):  80%|#######################      | 41332/51974 [00:01<00:00, 20423.00 examples/s]text_length_filter_compute_stats (num_proc=4):  84%|########################4    | 43732/51974 [00:01<00:00, 21219.18 examples/s]text_length_filter_compute_stats (num_proc=4):  89%|#########################9   | 46488/51974 [00:02<00:00, 20748.31 examples/s]text_length_filter_compute_stats (num_proc=4):  94%|###########################2 | 48880/51974 [00:02<00:00, 21401.36 examples/s]text_length_filter_compute_stats (num_proc=4):  99%|############################6| 51345/51974 [00:02<00:00, 20653.49 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 51974/51974 [00:02<00:00, 21743.07 examples/s]
language_id_score_filter_compute_stats (num_proc=4):   0%|                                      | 0/51974 [00:00<?, ? examples/s]language_id_score_filter_compute_stats (num_proc=4):   0%|                          | 195/51974 [00:00<00:29, 1761.09 examples/s]language_id_score_filter_compute_stats (num_proc=4):   5%|#1                      | 2429/51974 [00:00<00:03, 12892.51 examples/s]language_id_score_filter_compute_stats (num_proc=4):   7%|#7                      | 3782/51974 [00:00<00:04, 10795.85 examples/s]language_id_score_filter_compute_stats (num_proc=4):  10%|##3                     | 5079/51974 [00:00<00:04, 11120.05 examples/s]language_id_score_filter_compute_stats (num_proc=4):  13%|###2                    | 6946/51974 [00:00<00:03, 13514.02 examples/s]language_id_score_filter_compute_stats (num_proc=4):  16%|###9                    | 8545/51974 [00:00<00:03, 12210.51 examples/s]language_id_score_filter_compute_stats (num_proc=4):  21%|####8                  | 10851/51974 [00:00<00:02, 14774.95 examples/s]language_id_score_filter_compute_stats (num_proc=4):  24%|#####5                 | 12533/51974 [00:00<00:02, 13766.83 examples/s]language_id_score_filter_compute_stats (num_proc=4):  28%|######5                | 14750/51974 [00:01<00:02, 15167.90 examples/s]language_id_score_filter_compute_stats (num_proc=4):  32%|#######3               | 16534/51974 [00:01<00:02, 14405.17 examples/s]language_id_score_filter_compute_stats (num_proc=4):  35%|########1              | 18311/51974 [00:01<00:02, 15153.78 examples/s]language_id_score_filter_compute_stats (num_proc=4):  38%|########8              | 19947/51974 [00:01<00:02, 14883.05 examples/s]language_id_score_filter_compute_stats (num_proc=4):  42%|#########5             | 21652/51974 [00:01<00:01, 15204.13 examples/s]language_id_score_filter_compute_stats (num_proc=4):  45%|##########3            | 23395/51974 [00:01<00:01, 14956.19 examples/s]language_id_score_filter_compute_stats (num_proc=4):  49%|###########1           | 25242/51974 [00:01<00:01, 14958.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):  53%|############1          | 27448/51974 [00:01<00:01, 15893.72 examples/s]language_id_score_filter_compute_stats (num_proc=4):  56%|############8          | 29126/51974 [00:02<00:01, 16059.05 examples/s]language_id_score_filter_compute_stats (num_proc=4):  60%|#############7         | 31110/51974 [00:02<00:01, 15684.70 examples/s]language_id_score_filter_compute_stats (num_proc=4):  63%|##############4        | 32709/51974 [00:02<00:01, 15735.07 examples/s]language_id_score_filter_compute_stats (num_proc=4):  66%|###############2       | 34373/51974 [00:02<00:01, 14305.89 examples/s]language_id_score_filter_compute_stats (num_proc=4):  69%|###############8       | 35916/51974 [00:02<00:01, 13130.35 examples/s]language_id_score_filter_compute_stats (num_proc=4):  72%|################5      | 37486/51974 [00:02<00:01, 10380.33 examples/s]language_id_score_filter_compute_stats (num_proc=4):  75%|#################2     | 38950/51974 [00:02<00:01, 11282.41 examples/s]language_id_score_filter_compute_stats (num_proc=4):  77%|#################8     | 40265/51974 [00:03<00:01, 10972.28 examples/s]language_id_score_filter_compute_stats (num_proc=4):  81%|##################6    | 42080/51974 [00:03<00:00, 12665.63 examples/s]language_id_score_filter_compute_stats (num_proc=4):  84%|###################3   | 43742/51974 [00:03<00:00, 12721.71 examples/s]language_id_score_filter_compute_stats (num_proc=4):  88%|####################1  | 45573/51974 [00:03<00:00, 14123.59 examples/s]language_id_score_filter_compute_stats (num_proc=4):  91%|####################9  | 47359/51974 [00:03<00:00, 13653.24 examples/s]language_id_score_filter_compute_stats (num_proc=4):  94%|#####################6 | 48924/51974 [00:03<00:00, 12261.67 examples/s]language_id_score_filter_compute_stats (num_proc=4):  97%|######################3| 50417/51974 [00:03<00:00, 11536.66 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|#######################9| 51873/51974 [00:04<00:00, 9010.25 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|#######################| 51974/51974 [00:04<00:00, 12293.39 examples/s]
perplexity_filter_compute_stats (num_proc=4):   0%|                                             | 0/51974 [00:00<?, ? examples/s]perplexity_filter_compute_stats (num_proc=4):   0%|                                   | 49/51974 [00:00<01:56, 445.99 examples/s]perplexity_filter_compute_stats (num_proc=4):   2%|5                                | 837/51974 [00:00<00:11, 4375.03 examples/s]perplexity_filter_compute_stats (num_proc=4):   3%|#                               | 1757/51974 [00:00<00:07, 6452.30 examples/s]perplexity_filter_compute_stats (num_proc=4):   5%|#7                              | 2785/51974 [00:00<00:06, 7909.49 examples/s]perplexity_filter_compute_stats (num_proc=4):   7%|##2                             | 3707/51974 [00:00<00:05, 8198.50 examples/s]perplexity_filter_compute_stats (num_proc=4):   9%|##8                             | 4707/51974 [00:00<00:05, 8487.05 examples/s]perplexity_filter_compute_stats (num_proc=4):  11%|###6                            | 5889/51974 [00:00<00:04, 9519.98 examples/s]perplexity_filter_compute_stats (num_proc=4):  14%|####2                          | 7106/51974 [00:00<00:04, 10326.10 examples/s]perplexity_filter_compute_stats (num_proc=4):  16%|#####                          | 8393/51974 [00:00<00:04, 10231.25 examples/s]perplexity_filter_compute_stats (num_proc=4):  19%|#####7                         | 9671/51974 [00:01<00:03, 10962.45 examples/s]perplexity_filter_compute_stats (num_proc=4):  21%|######2                       | 10846/51974 [00:01<00:03, 11180.21 examples/s]perplexity_filter_compute_stats (num_proc=4):  23%|#######                       | 12168/51974 [00:01<00:03, 11774.20 examples/s]perplexity_filter_compute_stats (num_proc=4):  26%|#######7                      | 13443/51974 [00:01<00:03, 11590.10 examples/s]perplexity_filter_compute_stats (num_proc=4):  28%|########5                     | 14783/51974 [00:01<00:03, 12048.71 examples/s]perplexity_filter_compute_stats (num_proc=4):  31%|#########3                    | 16172/51974 [00:01<00:02, 12354.95 examples/s]perplexity_filter_compute_stats (num_proc=4):  34%|##########                    | 17422/51974 [00:01<00:03, 11086.75 examples/s]perplexity_filter_compute_stats (num_proc=4):  36%|##########8                   | 18750/51974 [00:01<00:02, 11676.12 examples/s]perplexity_filter_compute_stats (num_proc=4):  39%|###########5                  | 20084/51974 [00:01<00:02, 11554.67 examples/s]perplexity_filter_compute_stats (num_proc=4):  41%|############3                 | 21403/51974 [00:02<00:02, 11226.96 examples/s]perplexity_filter_compute_stats (num_proc=4):  44%|#############1                | 22868/51974 [00:02<00:02, 12142.75 examples/s]perplexity_filter_compute_stats (num_proc=4):  47%|#############9                | 24193/51974 [00:02<00:02, 12432.44 examples/s]perplexity_filter_compute_stats (num_proc=4):  49%|##############7               | 25593/51974 [00:02<00:02, 12868.65 examples/s]perplexity_filter_compute_stats (num_proc=4):  52%|###############6              | 27188/51974 [00:02<00:01, 13742.48 examples/s]perplexity_filter_compute_stats (num_proc=4):  55%|################5             | 28749/51974 [00:02<00:01, 12724.96 examples/s]perplexity_filter_compute_stats (num_proc=4):  58%|#################5            | 30366/51974 [00:02<00:01, 13650.55 examples/s]perplexity_filter_compute_stats (num_proc=4):  61%|##################3           | 31802/51974 [00:02<00:01, 13567.20 examples/s]perplexity_filter_compute_stats (num_proc=4):  64%|###################1          | 33199/51974 [00:02<00:01, 13580.05 examples/s]perplexity_filter_compute_stats (num_proc=4):  67%|####################          | 34818/51974 [00:03<00:01, 14317.63 examples/s]perplexity_filter_compute_stats (num_proc=4):  70%|####################9         | 36285/51974 [00:03<00:01, 13151.84 examples/s]perplexity_filter_compute_stats (num_proc=4):  73%|#####################8        | 37813/51974 [00:03<00:01, 13228.06 examples/s]perplexity_filter_compute_stats (num_proc=4):  76%|######################7       | 39339/51974 [00:03<00:00, 13737.02 examples/s]perplexity_filter_compute_stats (num_proc=4):  78%|########################3      | 40765/51974 [00:03<00:01, 8351.87 examples/s]perplexity_filter_compute_stats (num_proc=4):  81%|#########################      | 42043/51974 [00:03<00:01, 9196.69 examples/s]perplexity_filter_compute_stats (num_proc=4):  84%|#########################1    | 43491/51974 [00:03<00:00, 10143.88 examples/s]perplexity_filter_compute_stats (num_proc=4):  86%|#########################9    | 44881/51974 [00:04<00:00, 11017.48 examples/s]perplexity_filter_compute_stats (num_proc=4):  89%|##########################7   | 46299/51974 [00:04<00:00, 11551.40 examples/s]perplexity_filter_compute_stats (num_proc=4):  92%|###########################5  | 47717/51974 [00:04<00:00, 12172.33 examples/s]perplexity_filter_compute_stats (num_proc=4):  95%|############################3 | 49150/51974 [00:04<00:00, 12739.13 examples/s]perplexity_filter_compute_stats (num_proc=4):  97%|#############################1| 50537/51974 [00:04<00:00, 13018.84 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|###############################| 51974/51974 [00:04<00:00, 9191.14 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|##############################| 51974/51974 [00:04<00:00, 10863.49 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/51974 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|2                               | 458/51974 [00:00<00:11, 4299.61 examples/s]text_length_filter_compute_stats (num_proc=4):   8%|##2                           | 3913/51974 [00:00<00:02, 19935.01 examples/s]text_length_filter_compute_stats (num_proc=4):  15%|####5                         | 7892/51974 [00:00<00:01, 26172.42 examples/s]text_length_filter_compute_stats (num_proc=4):  21%|######1                      | 10975/51974 [00:00<00:01, 27708.36 examples/s]text_length_filter_compute_stats (num_proc=4):  27%|#######8                     | 14008/51974 [00:00<00:01, 27618.48 examples/s]text_length_filter_compute_stats (num_proc=4):  34%|#########8                   | 17617/51974 [00:00<00:01, 29058.93 examples/s]text_length_filter_compute_stats (num_proc=4):  40%|###########5                 | 20753/51974 [00:00<00:01, 28875.28 examples/s]text_length_filter_compute_stats (num_proc=4):  46%|#############2               | 23776/51974 [00:00<00:00, 29268.88 examples/s]text_length_filter_compute_stats (num_proc=4):  52%|###############2             | 27273/51974 [00:00<00:00, 29438.18 examples/s]text_length_filter_compute_stats (num_proc=4):  58%|################9            | 30346/51974 [00:01<00:00, 22975.99 examples/s]text_length_filter_compute_stats (num_proc=4):  64%|##################5          | 33181/51974 [00:01<00:00, 20391.65 examples/s]text_length_filter_compute_stats (num_proc=4):  68%|###################8         | 35572/51974 [00:01<00:00, 20046.79 examples/s]text_length_filter_compute_stats (num_proc=4):  75%|#####################7       | 39041/51974 [00:01<00:00, 22514.69 examples/s]text_length_filter_compute_stats (num_proc=4):  82%|#######################7     | 42631/51974 [00:01<00:00, 24699.42 examples/s]text_length_filter_compute_stats (num_proc=4):  90%|##########################   | 46605/51974 [00:01<00:00, 27258.63 examples/s]text_length_filter_compute_stats (num_proc=4):  95%|###########################6 | 49620/51974 [00:01<00:00, 26104.37 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 51974/51974 [00:02<00:00, 21935.80 examples/s]
alphanumeric_filter_compute_stats (num_proc=4):   0%|                                           | 0/51974 [00:00<?, ? examples/s]alphanumeric_filter_compute_stats (num_proc=4):   0%|1                              | 255/51974 [00:00<00:23, 2174.01 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   5%|#5                           | 2698/51974 [00:00<00:03, 14036.86 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   8%|##3                          | 4224/51974 [00:00<00:03, 13882.59 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  13%|###6                         | 6511/51974 [00:00<00:02, 16820.85 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  16%|####6                        | 8295/51974 [00:00<00:02, 17168.03 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  20%|#####6                      | 10439/51974 [00:00<00:02, 18556.10 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  24%|######7                     | 12453/51974 [00:00<00:02, 18870.64 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  28%|#######8                    | 14659/51974 [00:00<00:01, 19854.78 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  33%|#########1                  | 16969/51974 [00:00<00:01, 20837.52 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  37%|##########3                 | 19284/51974 [00:01<00:01, 19983.32 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  42%|###########6                | 21595/51974 [00:01<00:01, 20382.55 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  46%|############7               | 23674/51974 [00:01<00:01, 19552.06 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  50%|##############              | 26038/51974 [00:01<00:01, 20683.31 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  54%|###############2            | 28263/51974 [00:01<00:01, 19774.94 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  59%|################3           | 30440/51974 [00:01<00:01, 19266.30 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  63%|#################5          | 32653/51974 [00:01<00:00, 19433.94 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  67%|##################7         | 34734/51974 [00:01<00:00, 19804.65 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  71%|###################8        | 36925/51974 [00:02<00:00, 16277.51 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  75%|####################9       | 38852/51974 [00:02<00:00, 15072.45 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  78%|#####################9      | 40751/51974 [00:02<00:00, 15276.67 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  82%|######################8     | 42425/51974 [00:02<00:00, 14554.81 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  85%|#######################7    | 44012/51974 [00:02<00:00, 13147.12 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  89%|########################8   | 46180/51974 [00:02<00:00, 15132.78 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  92%|#########################8  | 48044/51974 [00:02<00:00, 15967.15 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  96%|##########################8 | 49874/51974 [00:03<00:00, 12937.12 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  99%|###########################7| 51419/51974 [00:03<00:00, 11571.36 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|############################| 51974/51974 [00:03<00:00, 15494.51 examples/s]
character_repetition_filter_compute_stats (num_proc=4):   0%|                                   | 0/51974 [00:00<?, ? examples/s]character_repetition_filter_compute_stats (num_proc=4):   0%|                         | 91/51974 [00:00<01:09, 748.77 examples/s]character_repetition_filter_compute_stats (num_proc=4):   2%|4                     | 1091/51974 [00:00<00:09, 5636.69 examples/s]character_repetition_filter_compute_stats (num_proc=4):   4%|8                     | 2019/51974 [00:00<00:06, 7180.12 examples/s]character_repetition_filter_compute_stats (num_proc=4):   6%|#2                    | 2895/51974 [00:00<00:06, 7771.73 examples/s]character_repetition_filter_compute_stats (num_proc=4):   7%|#5                    | 3730/51974 [00:00<00:06, 7956.19 examples/s]character_repetition_filter_compute_stats (num_proc=4):   9%|#9                    | 4627/51974 [00:00<00:06, 7173.77 examples/s]character_repetition_filter_compute_stats (num_proc=4):  11%|##3                   | 5594/51974 [00:00<00:05, 7890.27 examples/s]character_repetition_filter_compute_stats (num_proc=4):  13%|##7                   | 6574/51974 [00:00<00:05, 8451.49 examples/s]character_repetition_filter_compute_stats (num_proc=4):  14%|###1                  | 7465/51974 [00:00<00:05, 8213.54 examples/s]character_repetition_filter_compute_stats (num_proc=4):  16%|###5                  | 8313/51974 [00:01<00:05, 8283.73 examples/s]character_repetition_filter_compute_stats (num_proc=4):  18%|###8                  | 9206/51974 [00:01<00:05, 7663.69 examples/s]character_repetition_filter_compute_stats (num_proc=4):  19%|####                 | 10044/51974 [00:01<00:05, 7855.20 examples/s]character_repetition_filter_compute_stats (num_proc=4):  21%|####4                | 10928/51974 [00:01<00:05, 8090.00 examples/s]character_repetition_filter_compute_stats (num_proc=4):  23%|####7                | 11763/51974 [00:01<00:05, 7535.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  24%|#####                | 12565/51974 [00:01<00:05, 7572.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  26%|#####4               | 13408/51974 [00:01<00:04, 7805.76 examples/s]character_repetition_filter_compute_stats (num_proc=4):  27%|#####7               | 14282/51974 [00:01<00:04, 8060.13 examples/s]character_repetition_filter_compute_stats (num_proc=4):  29%|######1              | 15120/51974 [00:01<00:04, 8131.24 examples/s]character_repetition_filter_compute_stats (num_proc=4):  31%|######4              | 15959/51974 [00:02<00:04, 7863.53 examples/s]character_repetition_filter_compute_stats (num_proc=4):  32%|######8              | 16837/51974 [00:02<00:04, 8033.71 examples/s]character_repetition_filter_compute_stats (num_proc=4):  34%|#######2             | 17863/51974 [00:02<00:03, 8664.93 examples/s]character_repetition_filter_compute_stats (num_proc=4):  36%|#######6             | 18915/51974 [00:02<00:03, 9195.28 examples/s]character_repetition_filter_compute_stats (num_proc=4):  38%|########             | 19854/51974 [00:02<00:03, 8859.24 examples/s]character_repetition_filter_compute_stats (num_proc=4):  40%|########3            | 20762/51974 [00:02<00:03, 8847.35 examples/s]character_repetition_filter_compute_stats (num_proc=4):  42%|########8            | 21797/51974 [00:02<00:03, 9268.01 examples/s]character_repetition_filter_compute_stats (num_proc=4):  44%|#########2           | 22863/51974 [00:02<00:03, 9651.21 examples/s]character_repetition_filter_compute_stats (num_proc=4):  46%|#########6           | 23860/51974 [00:02<00:02, 9730.60 examples/s]character_repetition_filter_compute_stats (num_proc=4):  48%|##########           | 24870/51974 [00:03<00:02, 9494.69 examples/s]character_repetition_filter_compute_stats (num_proc=4):  50%|##########4          | 25919/51974 [00:03<00:02, 9658.46 examples/s]character_repetition_filter_compute_stats (num_proc=4):  52%|##########8          | 26951/51974 [00:03<00:02, 9244.70 examples/s]character_repetition_filter_compute_stats (num_proc=4):  54%|###########2         | 27937/51974 [00:03<00:02, 9396.48 examples/s]character_repetition_filter_compute_stats (num_proc=4):  56%|###########7         | 28965/51974 [00:03<00:02, 9381.66 examples/s]character_repetition_filter_compute_stats (num_proc=4):  58%|############1        | 29958/51974 [00:03<00:02, 9432.59 examples/s]character_repetition_filter_compute_stats (num_proc=4):  60%|############5        | 30959/51974 [00:03<00:02, 9462.00 examples/s]character_repetition_filter_compute_stats (num_proc=4):  61%|############9        | 31940/51974 [00:03<00:02, 9319.93 examples/s]character_repetition_filter_compute_stats (num_proc=4):  63%|#############3       | 32945/51974 [00:03<00:01, 9527.45 examples/s]character_repetition_filter_compute_stats (num_proc=4):  65%|#############7       | 33962/51974 [00:03<00:01, 9699.13 examples/s]character_repetition_filter_compute_stats (num_proc=4):  67%|##############1      | 34955/51974 [00:04<00:01, 9089.57 examples/s]character_repetition_filter_compute_stats (num_proc=4):  69%|##############5      | 35990/51974 [00:04<00:02, 6242.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  71%|##############9      | 36889/51974 [00:04<00:02, 6815.15 examples/s]character_repetition_filter_compute_stats (num_proc=4):  73%|###############2     | 37740/51974 [00:04<00:02, 7115.48 examples/s]character_repetition_filter_compute_stats (num_proc=4):  74%|###############5     | 38562/51974 [00:04<00:02, 6626.44 examples/s]character_repetition_filter_compute_stats (num_proc=4):  76%|###############8     | 39314/51974 [00:04<00:01, 6820.83 examples/s]character_repetition_filter_compute_stats (num_proc=4):  77%|################2    | 40206/51974 [00:04<00:01, 7351.14 examples/s]character_repetition_filter_compute_stats (num_proc=4):  79%|################6    | 41218/51974 [00:05<00:01, 8077.66 examples/s]character_repetition_filter_compute_stats (num_proc=4):  81%|#################    | 42088/51974 [00:05<00:01, 8246.02 examples/s]character_repetition_filter_compute_stats (num_proc=4):  83%|#################3   | 42944/51974 [00:05<00:01, 8324.26 examples/s]character_repetition_filter_compute_stats (num_proc=4):  84%|#################7   | 43838/51974 [00:05<00:00, 8487.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  86%|##################   | 44733/51974 [00:05<00:00, 8587.71 examples/s]character_repetition_filter_compute_stats (num_proc=4):  88%|##################4  | 45700/51974 [00:05<00:00, 8358.67 examples/s]character_repetition_filter_compute_stats (num_proc=4):  90%|##################8  | 46589/51974 [00:05<00:00, 8144.28 examples/s]character_repetition_filter_compute_stats (num_proc=4):  91%|###################1 | 47496/51974 [00:05<00:00, 8397.37 examples/s]character_repetition_filter_compute_stats (num_proc=4):  93%|###################5 | 48360/51974 [00:05<00:00, 8354.15 examples/s]character_repetition_filter_compute_stats (num_proc=4):  95%|###################8 | 49237/51974 [00:06<00:00, 7382.50 examples/s]character_repetition_filter_compute_stats (num_proc=4):  96%|####################2| 50066/51974 [00:06<00:00, 6935.85 examples/s]character_repetition_filter_compute_stats (num_proc=4):  98%|####################5| 50894/51974 [00:06<00:00, 5783.43 examples/s]character_repetition_filter_compute_stats (num_proc=4):  99%|####################8| 51535/51974 [00:06<00:00, 4363.33 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|#####################| 51974/51974 [00:06<00:00, 7466.37 examples/s]
word_repetition_filter_compute_stats (num_proc=4):   0%|                                        | 0/51974 [00:00<?, ? examples/s]word_repetition_filter_compute_stats (num_proc=4):   0%|                            | 185/51974 [00:00<00:31, 1666.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):   3%|8                          | 1607/51974 [00:00<00:05, 8475.02 examples/s]word_repetition_filter_compute_stats (num_proc=4):   6%|#4                        | 2889/51974 [00:00<00:04, 10364.35 examples/s]word_repetition_filter_compute_stats (num_proc=4):   8%|##1                        | 4065/51974 [00:00<00:05, 9237.29 examples/s]word_repetition_filter_compute_stats (num_proc=4):  10%|##6                       | 5309/51974 [00:00<00:04, 10099.15 examples/s]word_repetition_filter_compute_stats (num_proc=4):  12%|###1                      | 6362/51974 [00:00<00:04, 10064.01 examples/s]word_repetition_filter_compute_stats (num_proc=4):  15%|###9                      | 7909/51974 [00:00<00:03, 11131.06 examples/s]word_repetition_filter_compute_stats (num_proc=4):  18%|####5                     | 9120/51974 [00:00<00:03, 10928.05 examples/s]word_repetition_filter_compute_stats (num_proc=4):  20%|####9                    | 10365/51974 [00:01<00:03, 11138.79 examples/s]word_repetition_filter_compute_stats (num_proc=4):  22%|#####6                   | 11671/51974 [00:01<00:03, 11663.05 examples/s]word_repetition_filter_compute_stats (num_proc=4):  25%|######2                  | 12977/51974 [00:01<00:03, 11150.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  27%|######7                  | 14118/51974 [00:01<00:03, 11109.52 examples/s]word_repetition_filter_compute_stats (num_proc=4):  30%|#######3                 | 15368/51974 [00:01<00:03, 11271.52 examples/s]word_repetition_filter_compute_stats (num_proc=4):  32%|########                 | 16678/51974 [00:01<00:02, 11777.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  35%|########6                | 18025/51974 [00:01<00:02, 11473.03 examples/s]word_repetition_filter_compute_stats (num_proc=4):  37%|#########2               | 19235/51974 [00:01<00:02, 11410.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  40%|#########9               | 20740/51974 [00:01<00:02, 11715.13 examples/s]word_repetition_filter_compute_stats (num_proc=4):  42%|##########5              | 21973/51974 [00:02<00:02, 11870.85 examples/s]word_repetition_filter_compute_stats (num_proc=4):  45%|###########2             | 23356/51974 [00:02<00:02, 11702.51 examples/s]word_repetition_filter_compute_stats (num_proc=4):  47%|###########8             | 24571/51974 [00:02<00:02, 11821.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  50%|############3            | 25775/51974 [00:02<00:02, 11856.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  52%|############9            | 26982/51974 [00:02<00:02, 11898.45 examples/s]word_repetition_filter_compute_stats (num_proc=4):  54%|#############5           | 28271/51974 [00:02<00:01, 12169.45 examples/s]word_repetition_filter_compute_stats (num_proc=4):  57%|##############1          | 29512/51974 [00:02<00:02, 10883.23 examples/s]word_repetition_filter_compute_stats (num_proc=4):  59%|###############3          | 30656/51974 [00:02<00:02, 9599.33 examples/s]word_repetition_filter_compute_stats (num_proc=4):  61%|###############8          | 31723/51974 [00:02<00:02, 9442.96 examples/s]word_repetition_filter_compute_stats (num_proc=4):  63%|################3         | 32712/51974 [00:03<00:02, 8073.02 examples/s]word_repetition_filter_compute_stats (num_proc=4):  65%|################8         | 33639/51974 [00:03<00:02, 7563.11 examples/s]word_repetition_filter_compute_stats (num_proc=4):  67%|#################4        | 34783/51974 [00:03<00:02, 8467.73 examples/s]word_repetition_filter_compute_stats (num_proc=4):  69%|##################        | 36021/51974 [00:03<00:01, 9428.58 examples/s]word_repetition_filter_compute_stats (num_proc=4):  72%|##################6       | 37230/51974 [00:03<00:01, 9774.83 examples/s]word_repetition_filter_compute_stats (num_proc=4):  74%|##################4      | 38453/51974 [00:03<00:01, 10412.48 examples/s]word_repetition_filter_compute_stats (num_proc=4):  76%|###################      | 39604/51974 [00:03<00:01, 10704.33 examples/s]word_repetition_filter_compute_stats (num_proc=4):  78%|###################5     | 40744/51974 [00:03<00:01, 10891.73 examples/s]word_repetition_filter_compute_stats (num_proc=4):  81%|####################1    | 41932/51974 [00:03<00:00, 10706.93 examples/s]word_repetition_filter_compute_stats (num_proc=4):  83%|####################7    | 43175/51974 [00:04<00:00, 11179.19 examples/s]word_repetition_filter_compute_stats (num_proc=4):  85%|#####################3   | 44314/51974 [00:04<00:00, 11028.99 examples/s]word_repetition_filter_compute_stats (num_proc=4):  88%|#####################9   | 45568/51974 [00:04<00:00, 11278.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  91%|######################6  | 47102/51974 [00:04<00:00, 12187.22 examples/s]word_repetition_filter_compute_stats (num_proc=4):  93%|#######################2 | 48339/51974 [00:04<00:00, 12231.08 examples/s]word_repetition_filter_compute_stats (num_proc=4):  96%|#######################8 | 49682/51974 [00:04<00:00, 11280.96 examples/s]word_repetition_filter_compute_stats (num_proc=4):  98%|########################5| 51038/51974 [00:04<00:00, 11816.16 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|#########################| 51974/51974 [00:05<00:00, 10356.05 examples/s]
2024-01-21 12:02:02.892 | INFO     | data_juicer.core.analyser:run:110 - Exporting dataset to disk...
2024-01-21 12:02:02.894 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                    | 0/52 [00:00<?, ?ba/s]Creating json from Arrow format:  31%|#################8                                        | 16/52 [00:00<00:00, 150.73ba/s]Creating json from Arrow format:  62%|###################################6                      | 32/52 [00:00<00:00, 151.56ba/s]Creating json from Arrow format:  94%|######################################################6   | 49/52 [00:00<00:00, 156.47ba/s]Creating json from Arrow format: 100%|##########################################################| 52/52 [00:00<00:00, 154.31ba/s]
2024-01-21 12:02:03.239 | INFO     | data_juicer.core.analyser:run:122 - Applying overall analysis on stats...
  0%|                                                                                                      | 0/7 [00:00<?, ?it/s]100%|###########################################################################################| 7/7 [00:00<00:00, 37211.82it/s]
2024-01-21 12:02:04.501 | INFO     | data_juicer.core.analyser:run:127 - The overall analysis results are:        alnum_ratio char_rep_ratio     lang lang_score   perplexity    text_len word_rep_ratio
count      51974.0        51974.0  51974.0    51974.0      51974.0     51974.0        51974.0
mean      0.796571       0.075551      NaN   0.897036   696.281352  355.148228       0.006085
std       0.045661       0.055998      NaN   0.119119  1877.181631  278.440388       0.042564
min       0.186667            0.0      NaN    0.03427          7.6        16.0            0.0
25%       0.785714       0.020202      NaN   0.882566        186.9       141.0            0.0
50%       0.806084       0.081967      NaN   0.936896        317.7       277.0            0.0
75%       0.821918       0.114286      NaN   0.964118      647.475       504.0            0.0
max       0.935252        0.75827      NaN   0.999853     227322.5      4293.0       0.923077
unique         NaN            NaN     19.0        NaN          NaN         NaN            NaN
top            NaN            NaN       en        NaN          NaN         NaN            NaN
freq           NaN            NaN  51867.0        NaN          NaN         NaN            NaN
2024-01-21 12:02:04.501 | INFO     | data_juicer.core.analyser:run:129 - Applying column-wise analysis on stats...
Column:   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Column:  14%|############2                                                                         | 1/7 [00:00<00:04,  1.24it/s]Column:  29%|########################5                                                             | 2/7 [00:01<00:03,  1.30it/s]Column:  43%|####################################8                                                 | 3/7 [00:02<00:02,  1.50it/s]Column:  57%|#################################################1                                    | 4/7 [00:02<00:02,  1.43it/s]Column:  71%|#############################################################4                        | 5/7 [00:03<00:01,  1.42it/s]Column:  86%|#########################################################################7            | 6/7 [00:04<00:00,  1.26it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.30it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.33it/s]
