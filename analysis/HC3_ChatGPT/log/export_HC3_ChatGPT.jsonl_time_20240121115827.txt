2024-01-21 11:58:27.336 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/./config/HC3_ChatGPT.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/output/analysis/HC3_ChatGPT]
2024-01-21 11:58:27.348 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./config/HC3_ChatGPT.yaml, cwd=/root/autodl-tmp/dj_mixture_challenge)]       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'HC3_ChatGPT'                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/HC3_ChatGPT.jsonl'                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/HC3_ChatGPT/HC3_ChatGPT.jsonl' │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/.cache/huggingface/datasets'                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'text_length_filter': {'image_key': 'images',                                       │
│                        │                          'max_len': 4096,                                             │
│                        │                          'min_len': 1,                                                │
│                        │                          'text_key': 'text'}},                                        │
│                        │  {'language_id_score_filter': {'image_key': 'images',                                 │
│                        │                                'lang': 'en',                                          │
│                        │                                'min_score': 0.8,                                      │
│                        │                                'text_key': 'text'}},                                  │
│                        │  {'perplexity_filter': {'image_key': 'images',                                        │
│                        │                         'lang': 'en',                                                 │
│                        │                         'max_ppl': 1500,                                              │
│                        │                         'text_key': 'text'}},                                         │
│                        │  {'text_length_filter': {'image_key': 'images',                                       │
│                        │                          'max_len': 10000,                                            │
│                        │                          'min_len': 1.0,                                              │
│                        │                          'text_key': 'text'}},                                        │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                      │
│                        │                           'max_ratio': 1.0,                                           │
│                        │                           'min_ratio': 0.8,                                           │
│                        │                           'text_key': 'text',                                         │
│                        │                           'tokenization': False}},                                    │
│                        │  {'character_repetition_filter': {'image_key': 'images',                              │
│                        │                                   'max_ratio': 0.3,                                   │
│                        │                                   'min_ratio': 0.0,                                   │
│                        │                                   'rep_len': 10,                                      │
│                        │                                   'text_key': 'text'}},                               │
│                        │  {'word_repetition_filter': {'image_key': 'images',                                   │
│                        │                              'lang': 'en',                                            │
│                        │                              'max_ratio': 0.5,                                        │
│                        │                              'min_ratio': 0.0,                                        │
│                        │                              'rep_len': 10,                                           │
│                        │                              'text_key': 'text',                                      │
│                        │                              'tokenization': False}}]                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/HC3_ChatGPT'                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240121115827'                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                 │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════╛
2024-01-21 11:58:27.350 | INFO     | data_juicer.core.analyser:__init__:39 - Using cache compression method: [None]
2024-01-21 11:58:27.350 | INFO     | data_juicer.core.analyser:__init__:44 - Setting up data formatter...
2024-01-21 11:58:27.351 | INFO     | data_juicer.core.analyser:__init__:53 - Preparing exporter...
2024-01-21 11:58:27.351 | INFO     | data_juicer.core.analyser:run:75 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 11942 examples [00:00, 91894.66 examples/s]Generating jsonl split: 26903 examples [00:00, 98102.63 examples/s]Generating jsonl split: 26903 examples [00:00, 96159.45 examples/s]
2024-01-21 11:58:28.617 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-01-21 11:58:28.618 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 26903 sample(s) in the original dataset.
Filter (num_proc=4):   0%|                                                                      | 0/26903 [00:00<?, ? examples/s]Filter (num_proc=4):   4%|##1                                                      | 1000/26903 [00:00<00:02, 8900.70 examples/s]Filter (num_proc=4):  41%|######################4                                | 11000/26903 [00:00<00:00, 48143.88 examples/s]Filter (num_proc=4):  74%|########################################8              | 20000/26903 [00:00<00:00, 61772.93 examples/s]Filter (num_proc=4): 100%|#######################################################| 26903/26903 [00:00<00:00, 63418.36 examples/s]Filter (num_proc=4): 100%|#######################################################| 26903/26903 [00:00<00:00, 49049.99 examples/s]
2024-01-21 11:58:29.292 | INFO     | data_juicer.format.formatter:unify_format:214 - 26903 samples left after filtering empty text.
2024-01-21 11:58:29.293 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 26903 from 26903
2024-01-21 11:58:29.297 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 26903 in final dataset
2024-01-21 11:58:29.297 | INFO     | data_juicer.core.analyser:run:81 - Preparing process operators...
2024-01-21 11:58:29.298 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-01-21 11:58:29.470 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-01-21 11:58:29.554 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-01-21 11:58:29.855 | INFO     | data_juicer.core.analyser:run:86 - Computing the stats of dataset...
Adding new column for stats (num_proc=4):   0%|                                                 | 0/26903 [00:00<?, ? examples/s]Adding new column for stats (num_proc=4):   2%|7                                    | 577/26903 [00:00<00:04, 5270.76 examples/s]Adding new column for stats (num_proc=4):  13%|####5                              | 3473/26903 [00:00<00:01, 16590.90 examples/s]Adding new column for stats (num_proc=4):  28%|#########6                         | 7427/26903 [00:00<00:00, 25055.44 examples/s]Adding new column for stats (num_proc=4):  37%|############9                      | 9968/26903 [00:00<00:00, 25180.89 examples/s]Adding new column for stats (num_proc=4):  48%|################3                 | 12970/26903 [00:00<00:00, 26759.65 examples/s]Adding new column for stats (num_proc=4):  61%|####################8             | 16487/26903 [00:00<00:00, 27004.57 examples/s]Adding new column for stats (num_proc=4):  72%|########################4         | 19341/26903 [00:00<00:00, 23641.88 examples/s]Adding new column for stats (num_proc=4):  83%|############################      | 22220/26903 [00:01<00:00, 16288.32 examples/s]Adding new column for stats (num_proc=4):  91%|###############################   | 24591/26903 [00:01<00:00, 16614.51 examples/s]Adding new column for stats (num_proc=4):  99%|#################################5| 26582/26903 [00:01<00:00, 16855.92 examples/s]Adding new column for stats (num_proc=4): 100%|##################################| 26903/26903 [00:01<00:00, 17519.35 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/26903 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   2%|5                               | 439/26903 [00:00<00:07, 3773.57 examples/s]text_length_filter_compute_stats (num_proc=4):  13%|###8                          | 3451/26903 [00:00<00:01, 16858.66 examples/s]text_length_filter_compute_stats (num_proc=4):  25%|#######6                      | 6824/26903 [00:00<00:00, 22660.71 examples/s]text_length_filter_compute_stats (num_proc=4):  35%|##########4                   | 9366/26903 [00:00<00:00, 22871.27 examples/s]text_length_filter_compute_stats (num_proc=4):  44%|############8                | 11932/26903 [00:00<00:00, 23623.77 examples/s]text_length_filter_compute_stats (num_proc=4):  59%|################9            | 15762/26903 [00:00<00:00, 28269.99 examples/s]text_length_filter_compute_stats (num_proc=4):  69%|####################1        | 18694/26903 [00:00<00:00, 25027.38 examples/s]text_length_filter_compute_stats (num_proc=4):  80%|#######################      | 21425/26903 [00:00<00:00, 24746.04 examples/s]text_length_filter_compute_stats (num_proc=4):  89%|#########################8   | 24012/26903 [00:01<00:00, 24451.51 examples/s]text_length_filter_compute_stats (num_proc=4):  99%|############################7| 26643/26903 [00:01<00:00, 24350.26 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 26903/26903 [00:01<00:00, 21983.06 examples/s]
language_id_score_filter_compute_stats (num_proc=4):   0%|                                      | 0/26903 [00:00<?, ? examples/s]language_id_score_filter_compute_stats (num_proc=4):   0%|1                         | 133/26903 [00:00<00:21, 1226.12 examples/s]language_id_score_filter_compute_stats (num_proc=4):   5%|#3                       | 1466/26903 [00:00<00:03, 7668.78 examples/s]language_id_score_filter_compute_stats (num_proc=4):  10%|##5                      | 2719/26903 [00:00<00:02, 9758.06 examples/s]language_id_score_filter_compute_stats (num_proc=4):  14%|###4                     | 3739/26903 [00:00<00:03, 7313.08 examples/s]language_id_score_filter_compute_stats (num_proc=4):  19%|####6                    | 4987/26903 [00:00<00:02, 8777.17 examples/s]language_id_score_filter_compute_stats (num_proc=4):  24%|#####6                  | 6329/26903 [00:00<00:02, 10119.49 examples/s]language_id_score_filter_compute_stats (num_proc=4):  28%|######8                 | 7635/26903 [00:00<00:01, 10213.51 examples/s]language_id_score_filter_compute_stats (num_proc=4):  33%|########1                | 8803/26903 [00:00<00:01, 9147.34 examples/s]language_id_score_filter_compute_stats (num_proc=4):  38%|########6              | 10096/26903 [00:01<00:01, 10105.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):  42%|#########7             | 11429/26903 [00:01<00:01, 10967.65 examples/s]language_id_score_filter_compute_stats (num_proc=4):  47%|###########3            | 12668/26903 [00:01<00:01, 9140.51 examples/s]language_id_score_filter_compute_stats (num_proc=4):  52%|###########9           | 13954/26903 [00:01<00:01, 10036.80 examples/s]language_id_score_filter_compute_stats (num_proc=4):  56%|############9          | 15171/26903 [00:01<00:01, 10330.39 examples/s]language_id_score_filter_compute_stats (num_proc=4):  61%|##############5         | 16311/26903 [00:01<00:01, 9887.16 examples/s]language_id_score_filter_compute_stats (num_proc=4):  65%|###############        | 17583/26903 [00:01<00:00, 10606.24 examples/s]language_id_score_filter_compute_stats (num_proc=4):  71%|################2      | 18975/26903 [00:01<00:00, 11488.85 examples/s]language_id_score_filter_compute_stats (num_proc=4):  75%|##################      | 20274/26903 [00:02<00:00, 9681.75 examples/s]language_id_score_filter_compute_stats (num_proc=4):  80%|##################3    | 21503/26903 [00:02<00:00, 10305.36 examples/s]language_id_score_filter_compute_stats (num_proc=4):  85%|###################5   | 22894/26903 [00:02<00:00, 11227.67 examples/s]language_id_score_filter_compute_stats (num_proc=4):  90%|####################6  | 24188/26903 [00:02<00:00, 10023.74 examples/s]language_id_score_filter_compute_stats (num_proc=4):  94%|#####################6 | 25354/26903 [00:02<00:00, 10424.44 examples/s]language_id_score_filter_compute_stats (num_proc=4):  99%|#######################7| 26580/26903 [00:02<00:00, 9159.18 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|########################| 26903/26903 [00:03<00:00, 8919.67 examples/s]
perplexity_filter_compute_stats (num_proc=4):   0%|                                             | 0/26903 [00:00<?, ? examples/s]perplexity_filter_compute_stats (num_proc=4):   0%|                                   | 13/26903 [00:00<03:46, 118.48 examples/s]perplexity_filter_compute_stats (num_proc=4):   1%|2                                | 209/26903 [00:00<00:23, 1158.13 examples/s]perplexity_filter_compute_stats (num_proc=4):   2%|5                                | 480/26903 [00:00<00:14, 1837.61 examples/s]perplexity_filter_compute_stats (num_proc=4):   3%|#                                | 848/26903 [00:00<00:10, 2544.64 examples/s]perplexity_filter_compute_stats (num_proc=4):   5%|#5                              | 1293/26903 [00:00<00:07, 3218.76 examples/s]perplexity_filter_compute_stats (num_proc=4):   7%|##1                             | 1777/26903 [00:00<00:06, 3754.11 examples/s]perplexity_filter_compute_stats (num_proc=4):   8%|##6                             | 2244/26903 [00:00<00:06, 4046.50 examples/s]perplexity_filter_compute_stats (num_proc=4):  10%|###2                            | 2749/26903 [00:00<00:05, 4348.23 examples/s]perplexity_filter_compute_stats (num_proc=4):  12%|###9                            | 3285/26903 [00:00<00:05, 4648.63 examples/s]perplexity_filter_compute_stats (num_proc=4):  14%|####5                           | 3850/26903 [00:01<00:04, 4645.49 examples/s]perplexity_filter_compute_stats (num_proc=4):  16%|#####2                          | 4381/26903 [00:01<00:04, 4608.91 examples/s]perplexity_filter_compute_stats (num_proc=4):  19%|#####9                          | 4978/26903 [00:01<00:04, 4992.88 examples/s]perplexity_filter_compute_stats (num_proc=4):  21%|######6                         | 5569/26903 [00:01<00:04, 5252.83 examples/s]perplexity_filter_compute_stats (num_proc=4):  23%|#######3                        | 6146/26903 [00:01<00:03, 5383.72 examples/s]perplexity_filter_compute_stats (num_proc=4):  25%|#######9                        | 6696/26903 [00:01<00:03, 5413.03 examples/s]perplexity_filter_compute_stats (num_proc=4):  27%|########6                       | 7250/26903 [00:01<00:03, 5311.89 examples/s]perplexity_filter_compute_stats (num_proc=4):  29%|#########2                      | 7800/26903 [00:01<00:03, 5250.40 examples/s]perplexity_filter_compute_stats (num_proc=4):  31%|#########9                      | 8387/26903 [00:01<00:03, 5343.99 examples/s]perplexity_filter_compute_stats (num_proc=4):  33%|##########6                     | 8962/26903 [00:01<00:03, 5448.03 examples/s]perplexity_filter_compute_stats (num_proc=4):  36%|###########3                    | 9564/26903 [00:02<00:03, 5598.31 examples/s]perplexity_filter_compute_stats (num_proc=4):  38%|###########7                   | 10176/26903 [00:02<00:02, 5743.06 examples/s]perplexity_filter_compute_stats (num_proc=4):  40%|############4                  | 10799/26903 [00:02<00:02, 5406.93 examples/s]perplexity_filter_compute_stats (num_proc=4):  42%|#############1                 | 11373/26903 [00:02<00:02, 5483.19 examples/s]perplexity_filter_compute_stats (num_proc=4):  44%|#############7                 | 11934/26903 [00:02<00:02, 5256.33 examples/s]perplexity_filter_compute_stats (num_proc=4):  46%|##############3                | 12478/26903 [00:02<00:02, 5238.72 examples/s]perplexity_filter_compute_stats (num_proc=4):  48%|##############9                | 13014/26903 [00:02<00:02, 5261.58 examples/s]perplexity_filter_compute_stats (num_proc=4):  51%|###############6               | 13619/26903 [00:02<00:02, 5476.01 examples/s]perplexity_filter_compute_stats (num_proc=4):  53%|################3              | 14179/26903 [00:02<00:02, 5511.18 examples/s]perplexity_filter_compute_stats (num_proc=4):  55%|#################              | 14806/26903 [00:03<00:02, 5728.08 examples/s]perplexity_filter_compute_stats (num_proc=4):  58%|#################8             | 15501/26903 [00:03<00:01, 6075.39 examples/s]perplexity_filter_compute_stats (num_proc=4):  60%|##################5            | 16123/26903 [00:03<00:01, 5671.99 examples/s]perplexity_filter_compute_stats (num_proc=4):  62%|###################3           | 16812/26903 [00:03<00:01, 6007.40 examples/s]perplexity_filter_compute_stats (num_proc=4):  65%|####################2          | 17552/26903 [00:03<00:01, 5974.16 examples/s]perplexity_filter_compute_stats (num_proc=4):  68%|#####################          | 18235/26903 [00:03<00:01, 6207.51 examples/s]perplexity_filter_compute_stats (num_proc=4):  70%|#####################7         | 18918/26903 [00:03<00:01, 6365.94 examples/s]perplexity_filter_compute_stats (num_proc=4):  73%|######################5        | 19606/26903 [00:03<00:01, 6496.07 examples/s]perplexity_filter_compute_stats (num_proc=4):  76%|#######################4       | 20324/26903 [00:03<00:01, 6323.35 examples/s]perplexity_filter_compute_stats (num_proc=4):  78%|########################2      | 21072/26903 [00:04<00:00, 6630.62 examples/s]perplexity_filter_compute_stats (num_proc=4):  81%|#########################      | 21773/26903 [00:04<00:00, 6547.00 examples/s]perplexity_filter_compute_stats (num_proc=4):  84%|#########################9     | 22529/26903 [00:04<00:00, 6823.64 examples/s]perplexity_filter_compute_stats (num_proc=4):  87%|##########################8    | 23325/26903 [00:04<00:00, 7139.39 examples/s]perplexity_filter_compute_stats (num_proc=4):  90%|###########################7   | 24103/26903 [00:04<00:00, 7130.71 examples/s]perplexity_filter_compute_stats (num_proc=4):  93%|############################7  | 24921/26903 [00:04<00:00, 6039.26 examples/s]perplexity_filter_compute_stats (num_proc=4):  95%|#############################5 | 25627/26903 [00:04<00:00, 5967.85 examples/s]perplexity_filter_compute_stats (num_proc=4):  98%|##############################2| 26278/26903 [00:04<00:00, 5389.21 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|###############################| 26903/26903 [00:05<00:00, 3115.56 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|###############################| 26903/26903 [00:05<00:00, 4976.98 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/26903 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   2%|5                               | 427/26903 [00:00<00:06, 4266.29 examples/s]text_length_filter_compute_stats (num_proc=4):  14%|####1                         | 3697/26903 [00:00<00:01, 20969.16 examples/s]text_length_filter_compute_stats (num_proc=4):  24%|#######1                      | 6402/26903 [00:00<00:00, 21961.62 examples/s]text_length_filter_compute_stats (num_proc=4):  34%|##########2                   | 9175/26903 [00:00<00:00, 23595.29 examples/s]text_length_filter_compute_stats (num_proc=4):  47%|#############4               | 12520/26903 [00:00<00:00, 25807.89 examples/s]text_length_filter_compute_stats (num_proc=4):  62%|#################8           | 16563/26903 [00:00<00:00, 28102.68 examples/s]text_length_filter_compute_stats (num_proc=4):  73%|#####################1       | 19625/26903 [00:00<00:00, 28848.75 examples/s]text_length_filter_compute_stats (num_proc=4):  84%|########################4    | 22648/26903 [00:00<00:00, 28803.52 examples/s]text_length_filter_compute_stats (num_proc=4):  96%|###########################9 | 25944/26903 [00:01<00:00, 25101.93 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 26903/26903 [00:01<00:00, 22190.50 examples/s]
alphanumeric_filter_compute_stats (num_proc=4):   0%|                                           | 0/26903 [00:00<?, ? examples/s]alphanumeric_filter_compute_stats (num_proc=4):   0%|1                              | 130/26903 [00:00<00:22, 1199.36 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   6%|#7                            | 1580/26903 [00:00<00:02, 8667.89 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  11%|###                          | 2853/26903 [00:00<00:02, 10460.83 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  15%|####4                         | 3979/26903 [00:00<00:02, 9896.45 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  20%|#####7                       | 5288/26903 [00:00<00:01, 10970.12 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  25%|#######2                     | 6714/26903 [00:00<00:01, 12032.91 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  30%|########6                    | 7985/26903 [00:00<00:01, 12054.33 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  35%|##########1                  | 9374/26903 [00:00<00:01, 11291.56 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  40%|###########1                | 10715/26903 [00:00<00:01, 11884.38 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  45%|############5               | 12081/26903 [00:01<00:01, 11688.02 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  51%|##############2             | 13655/26903 [00:01<00:01, 12815.54 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  56%|###############6            | 15046/26903 [00:01<00:00, 12662.76 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  61%|#################1          | 16509/26903 [00:01<00:00, 13200.53 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  67%|##################6         | 17912/26903 [00:01<00:00, 13432.88 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  72%|####################2       | 19440/26903 [00:01<00:00, 13963.71 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  78%|#####################9      | 21044/26903 [00:01<00:00, 13391.85 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  84%|#######################6    | 22687/26903 [00:01<00:00, 13677.17 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  90%|#########################   | 24081/26903 [00:02<00:00, 12003.54 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  95%|##########################4 | 25446/26903 [00:02<00:00, 10459.95 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  99%|############################7| 26635/26903 [00:02<00:00, 7260.59 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|#############################| 26903/26903 [00:02<00:00, 9959.00 examples/s]
character_repetition_filter_compute_stats (num_proc=4):   0%|                                   | 0/26903 [00:00<?, ? examples/s]character_repetition_filter_compute_stats (num_proc=4):   0%|                         | 44/26903 [00:00<01:07, 398.66 examples/s]character_repetition_filter_compute_stats (num_proc=4):   2%|3                      | 459/26903 [00:00<00:10, 2473.39 examples/s]character_repetition_filter_compute_stats (num_proc=4):   3%|7                      | 838/26903 [00:00<00:08, 3037.25 examples/s]character_repetition_filter_compute_stats (num_proc=4):   5%|#                     | 1238/26903 [00:00<00:07, 3401.74 examples/s]character_repetition_filter_compute_stats (num_proc=4):   6%|#3                    | 1641/26903 [00:00<00:07, 3599.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):   8%|#6                    | 2028/26903 [00:00<00:06, 3670.41 examples/s]character_repetition_filter_compute_stats (num_proc=4):   9%|#9                    | 2442/26903 [00:00<00:06, 3804.57 examples/s]character_repetition_filter_compute_stats (num_proc=4):  11%|##3                   | 2831/26903 [00:00<00:06, 3723.11 examples/s]character_repetition_filter_compute_stats (num_proc=4):  12%|##6                   | 3233/26903 [00:00<00:06, 3416.20 examples/s]character_repetition_filter_compute_stats (num_proc=4):  13%|##9                   | 3594/26903 [00:01<00:06, 3453.16 examples/s]character_repetition_filter_compute_stats (num_proc=4):  15%|###2                  | 3987/26903 [00:01<00:06, 3325.73 examples/s]character_repetition_filter_compute_stats (num_proc=4):  16%|###5                  | 4371/26903 [00:01<00:06, 3444.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  18%|###8                  | 4726/26903 [00:01<00:06, 3228.35 examples/s]character_repetition_filter_compute_stats (num_proc=4):  19%|####1                 | 5080/26903 [00:01<00:06, 3307.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  20%|####4                 | 5450/26903 [00:01<00:06, 3410.68 examples/s]character_repetition_filter_compute_stats (num_proc=4):  22%|####7                 | 5810/26903 [00:01<00:06, 3443.88 examples/s]character_repetition_filter_compute_stats (num_proc=4):  23%|#####                 | 6214/26903 [00:01<00:05, 3510.19 examples/s]character_repetition_filter_compute_stats (num_proc=4):  24%|#####3                | 6583/26903 [00:01<00:05, 3550.58 examples/s]character_repetition_filter_compute_stats (num_proc=4):  26%|#####6                | 6951/26903 [00:02<00:05, 3584.61 examples/s]character_repetition_filter_compute_stats (num_proc=4):  27%|#####9                | 7336/26903 [00:02<00:05, 3463.54 examples/s]character_repetition_filter_compute_stats (num_proc=4):  29%|######3               | 7712/26903 [00:02<00:05, 3520.15 examples/s]character_repetition_filter_compute_stats (num_proc=4):  30%|######6               | 8075/26903 [00:02<00:05, 3545.17 examples/s]character_repetition_filter_compute_stats (num_proc=4):  31%|######8               | 8432/26903 [00:02<00:05, 3546.19 examples/s]character_repetition_filter_compute_stats (num_proc=4):  33%|#######1              | 8798/26903 [00:02<00:05, 3571.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  34%|#######4              | 9159/26903 [00:02<00:05, 3312.96 examples/s]character_repetition_filter_compute_stats (num_proc=4):  35%|#######7              | 9528/26903 [00:02<00:05, 3400.66 examples/s]character_repetition_filter_compute_stats (num_proc=4):  37%|########              | 9891/26903 [00:02<00:04, 3448.50 examples/s]character_repetition_filter_compute_stats (num_proc=4):  38%|#######9             | 10246/26903 [00:02<00:04, 3458.31 examples/s]character_repetition_filter_compute_stats (num_proc=4):  40%|########3            | 10648/26903 [00:03<00:04, 3382.86 examples/s]character_repetition_filter_compute_stats (num_proc=4):  41%|########6            | 11036/26903 [00:03<00:04, 3464.77 examples/s]character_repetition_filter_compute_stats (num_proc=4):  42%|########9            | 11405/26903 [00:03<00:04, 3520.87 examples/s]character_repetition_filter_compute_stats (num_proc=4):  44%|#########1           | 11774/26903 [00:03<00:04, 3560.70 examples/s]character_repetition_filter_compute_stats (num_proc=4):  45%|#########4           | 12140/26903 [00:03<00:04, 3576.36 examples/s]character_repetition_filter_compute_stats (num_proc=4):  46%|#########7           | 12502/26903 [00:03<00:04, 3577.39 examples/s]character_repetition_filter_compute_stats (num_proc=4):  48%|##########           | 12870/26903 [00:03<00:03, 3589.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  49%|##########3          | 13254/26903 [00:03<00:03, 3650.27 examples/s]character_repetition_filter_compute_stats (num_proc=4):  51%|##########6          | 13637/26903 [00:03<00:03, 3689.63 examples/s]character_repetition_filter_compute_stats (num_proc=4):  52%|##########9          | 14039/26903 [00:04<00:03, 3335.99 examples/s]character_repetition_filter_compute_stats (num_proc=4):  54%|###########2         | 14436/26903 [00:04<00:03, 3443.85 examples/s]character_repetition_filter_compute_stats (num_proc=4):  55%|###########5         | 14854/26903 [00:04<00:03, 3634.70 examples/s]character_repetition_filter_compute_stats (num_proc=4):  57%|###########9         | 15251/26903 [00:04<00:03, 3727.12 examples/s]character_repetition_filter_compute_stats (num_proc=4):  58%|############2        | 15678/26903 [00:04<00:02, 3870.35 examples/s]character_repetition_filter_compute_stats (num_proc=4):  60%|############5        | 16111/26903 [00:04<00:02, 3995.42 examples/s]character_repetition_filter_compute_stats (num_proc=4):  62%|############9        | 16548/26903 [00:04<00:02, 4084.90 examples/s]character_repetition_filter_compute_stats (num_proc=4):  63%|#############2       | 16977/26903 [00:04<00:02, 4133.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  65%|#############6       | 17441/26903 [00:04<00:02, 4125.46 examples/s]character_repetition_filter_compute_stats (num_proc=4):  66%|#############9       | 17887/26903 [00:05<00:02, 4201.12 examples/s]character_repetition_filter_compute_stats (num_proc=4):  68%|##############2      | 18310/26903 [00:05<00:02, 3969.47 examples/s]character_repetition_filter_compute_stats (num_proc=4):  70%|##############6      | 18744/26903 [00:05<00:02, 4065.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  71%|##############9      | 19195/26903 [00:05<00:01, 4168.36 examples/s]character_repetition_filter_compute_stats (num_proc=4):  73%|###############3     | 19630/26903 [00:05<00:01, 4209.35 examples/s]character_repetition_filter_compute_stats (num_proc=4):  75%|###############6     | 20062/26903 [00:05<00:01, 4229.49 examples/s]character_repetition_filter_compute_stats (num_proc=4):  76%|###############9     | 20495/26903 [00:05<00:01, 4239.55 examples/s]character_repetition_filter_compute_stats (num_proc=4):  78%|################3    | 20941/26903 [00:05<00:01, 4292.13 examples/s]character_repetition_filter_compute_stats (num_proc=4):  80%|################7    | 21406/26903 [00:05<00:01, 4249.97 examples/s]character_repetition_filter_compute_stats (num_proc=4):  81%|#################    | 21845/26903 [00:05<00:01, 4276.16 examples/s]character_repetition_filter_compute_stats (num_proc=4):  83%|#################3   | 22281/26903 [00:06<00:01, 4286.37 examples/s]character_repetition_filter_compute_stats (num_proc=4):  84%|#################7   | 22724/26903 [00:06<00:00, 4319.82 examples/s]character_repetition_filter_compute_stats (num_proc=4):  86%|##################   | 23178/26903 [00:06<00:00, 4368.78 examples/s]character_repetition_filter_compute_stats (num_proc=4):  88%|##################4  | 23666/26903 [00:06<00:00, 4510.14 examples/s]character_repetition_filter_compute_stats (num_proc=4):  90%|##################8  | 24120/26903 [00:06<00:00, 4512.71 examples/s]character_repetition_filter_compute_stats (num_proc=4):  91%|###################1 | 24580/26903 [00:06<00:00, 4028.57 examples/s]character_repetition_filter_compute_stats (num_proc=4):  93%|###################5 | 25071/26903 [00:06<00:00, 3970.22 examples/s]character_repetition_filter_compute_stats (num_proc=4):  95%|###################8 | 25479/26903 [00:06<00:00, 3751.06 examples/s]character_repetition_filter_compute_stats (num_proc=4):  96%|####################2| 25895/26903 [00:07<00:00, 3055.69 examples/s]character_repetition_filter_compute_stats (num_proc=4):  98%|####################4| 26242/26903 [00:07<00:00, 1591.90 examples/s]character_repetition_filter_compute_stats (num_proc=4):  99%|####################6| 26511/26903 [00:07<00:00, 1216.22 examples/s]character_repetition_filter_compute_stats (num_proc=4):  99%|####################8| 26715/26903 [00:08<00:00, 1051.53 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|#####################9| 26887/26903 [00:08<00:00, 950.06 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|#####################| 26903/26903 [00:08<00:00, 3094.78 examples/s]
word_repetition_filter_compute_stats (num_proc=4):   0%|                                        | 0/26903 [00:00<?, ? examples/s]word_repetition_filter_compute_stats (num_proc=4):   0%|                              | 57/26903 [00:00<00:52, 515.49 examples/s]word_repetition_filter_compute_stats (num_proc=4):   3%|7                           | 720/26903 [00:00<00:06, 3868.44 examples/s]word_repetition_filter_compute_stats (num_proc=4):   5%|#3                         | 1344/26903 [00:00<00:05, 4902.93 examples/s]word_repetition_filter_compute_stats (num_proc=4):   7%|#9                         | 1904/26903 [00:00<00:04, 5160.97 examples/s]word_repetition_filter_compute_stats (num_proc=4):   9%|##4                        | 2458/26903 [00:00<00:04, 5277.52 examples/s]word_repetition_filter_compute_stats (num_proc=4):  11%|###                        | 3020/26903 [00:00<00:04, 5373.63 examples/s]word_repetition_filter_compute_stats (num_proc=4):  13%|###5                       | 3574/26903 [00:00<00:04, 5224.93 examples/s]word_repetition_filter_compute_stats (num_proc=4):  15%|####1                      | 4131/26903 [00:00<00:04, 5133.57 examples/s]word_repetition_filter_compute_stats (num_proc=4):  18%|####7                      | 4712/26903 [00:00<00:04, 4964.04 examples/s]word_repetition_filter_compute_stats (num_proc=4):  20%|#####2                     | 5259/26903 [00:01<00:04, 5087.50 examples/s]word_repetition_filter_compute_stats (num_proc=4):  22%|#####8                     | 5825/26903 [00:01<00:04, 5245.27 examples/s]word_repetition_filter_compute_stats (num_proc=4):  24%|######4                    | 6413/26903 [00:01<00:03, 5411.53 examples/s]word_repetition_filter_compute_stats (num_proc=4):  26%|######9                    | 6972/26903 [00:01<00:03, 5403.17 examples/s]word_repetition_filter_compute_stats (num_proc=4):  28%|#######5                   | 7525/26903 [00:01<00:03, 5431.08 examples/s]word_repetition_filter_compute_stats (num_proc=4):  30%|########1                  | 8101/26903 [00:01<00:03, 5516.60 examples/s]word_repetition_filter_compute_stats (num_proc=4):  32%|########7                  | 8670/26903 [00:01<00:03, 5002.09 examples/s]word_repetition_filter_compute_stats (num_proc=4):  34%|#########2                 | 9200/26903 [00:01<00:03, 5072.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  36%|#########7                 | 9751/26903 [00:01<00:03, 5180.96 examples/s]word_repetition_filter_compute_stats (num_proc=4):  38%|#########9                | 10327/26903 [00:02<00:03, 5142.06 examples/s]word_repetition_filter_compute_stats (num_proc=4):  40%|##########4               | 10858/26903 [00:02<00:03, 5185.46 examples/s]word_repetition_filter_compute_stats (num_proc=4):  42%|###########               | 11427/26903 [00:02<00:02, 5320.72 examples/s]word_repetition_filter_compute_stats (num_proc=4):  45%|###########6              | 12012/26903 [00:02<00:02, 5455.82 examples/s]word_repetition_filter_compute_stats (num_proc=4):  47%|############1             | 12611/26903 [00:02<00:02, 5598.46 examples/s]word_repetition_filter_compute_stats (num_proc=4):  49%|############7             | 13220/26903 [00:02<00:02, 4857.34 examples/s]word_repetition_filter_compute_stats (num_proc=4):  51%|#############3            | 13797/26903 [00:02<00:02, 5086.30 examples/s]word_repetition_filter_compute_stats (num_proc=4):  54%|#############9            | 14450/26903 [00:02<00:02, 5469.46 examples/s]word_repetition_filter_compute_stats (num_proc=4):  56%|##############5           | 15096/26903 [00:02<00:02, 5739.04 examples/s]word_repetition_filter_compute_stats (num_proc=4):  59%|###############2          | 15775/26903 [00:02<00:01, 6035.21 examples/s]word_repetition_filter_compute_stats (num_proc=4):  61%|###############8          | 16433/26903 [00:03<00:01, 6173.32 examples/s]word_repetition_filter_compute_stats (num_proc=4):  64%|################5         | 17116/26903 [00:03<00:01, 6345.04 examples/s]word_repetition_filter_compute_stats (num_proc=4):  66%|#################1        | 17773/26903 [00:03<00:01, 6097.05 examples/s]word_repetition_filter_compute_stats (num_proc=4):  68%|#################7        | 18400/26903 [00:03<00:01, 6124.48 examples/s]word_repetition_filter_compute_stats (num_proc=4):  71%|##################4       | 19098/26903 [00:03<00:01, 6365.56 examples/s]word_repetition_filter_compute_stats (num_proc=4):  74%|###################1      | 19780/26903 [00:03<00:01, 6481.84 examples/s]word_repetition_filter_compute_stats (num_proc=4):  76%|###################7      | 20461/26903 [00:03<00:00, 6564.84 examples/s]word_repetition_filter_compute_stats (num_proc=4):  79%|####################4     | 21123/26903 [00:03<00:00, 6566.13 examples/s]word_repetition_filter_compute_stats (num_proc=4):  81%|#####################     | 21795/26903 [00:03<00:00, 5998.94 examples/s]word_repetition_filter_compute_stats (num_proc=4):  84%|#####################8    | 22608/26903 [00:04<00:00, 6316.09 examples/s]word_repetition_filter_compute_stats (num_proc=4):  87%|######################5   | 23324/26903 [00:04<00:00, 6063.47 examples/s]word_repetition_filter_compute_stats (num_proc=4):  89%|#######################1  | 23969/26903 [00:04<00:00, 5419.59 examples/s]word_repetition_filter_compute_stats (num_proc=4):  91%|#######################7  | 24574/26903 [00:04<00:00, 4960.57 examples/s]word_repetition_filter_compute_stats (num_proc=4):  93%|########################3 | 25147/26903 [00:04<00:00, 4118.69 examples/s]word_repetition_filter_compute_stats (num_proc=4):  95%|########################7 | 25652/26903 [00:04<00:00, 3889.39 examples/s]word_repetition_filter_compute_stats (num_proc=4):  97%|#########################2| 26137/26903 [00:05<00:00, 3660.36 examples/s]word_repetition_filter_compute_stats (num_proc=4):  99%|#########################6| 26558/26903 [00:05<00:00, 3406.17 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|##########################| 26903/26903 [00:05<00:00, 4910.88 examples/s]
2024-01-21 11:59:00.429 | INFO     | data_juicer.core.analyser:run:110 - Exporting dataset to disk...
2024-01-21 11:59:00.430 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                    | 0/27 [00:00<?, ?ba/s]Creating json from Arrow format:  59%|##################################3                       | 16/27 [00:00<00:00, 151.24ba/s]Creating json from Arrow format: 100%|##########################################################| 27/27 [00:00<00:00, 155.18ba/s]
2024-01-21 11:59:00.612 | INFO     | data_juicer.core.analyser:run:122 - Applying overall analysis on stats...
  0%|                                                                                                      | 0/7 [00:00<?, ?it/s]100%|###########################################################################################| 7/7 [00:00<00:00, 12865.96it/s]
2024-01-21 11:59:01.603 | INFO     | data_juicer.core.analyser:run:127 - The overall analysis results are:        alnum_ratio char_rep_ratio     lang lang_score  perplexity     text_len word_rep_ratio
count      26903.0        26903.0  26903.0    26903.0     26903.0      26903.0        26903.0
mean      0.799615       0.084553      NaN   0.965357  252.820864  1164.803591       0.006269
std       0.015599         0.0245      NaN   0.019992  593.901231   388.625644       0.027618
min       0.642708            0.0      NaN   0.327386        16.0         23.0            0.0
25%       0.789919       0.070911      NaN   0.957093       148.9        912.0            0.0
50%        0.80046       0.083481      NaN   0.968622       204.5       1176.0            0.0
75%       0.810235       0.098013      NaN   0.977843       279.1       1412.0            0.0
max       0.905618       0.359684      NaN   0.999245     71197.6       3735.0       0.822222
unique         NaN            NaN      3.0        NaN         NaN          NaN            NaN
top            NaN            NaN       en        NaN         NaN          NaN            NaN
freq           NaN            NaN  26901.0        NaN         NaN          NaN            NaN
2024-01-21 11:59:01.603 | INFO     | data_juicer.core.analyser:run:129 - Applying column-wise analysis on stats...
Column:   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Column:  14%|############2                                                                         | 1/7 [00:00<00:05,  1.09it/s]Column:  29%|########################5                                                             | 2/7 [00:01<00:04,  1.19it/s]Column:  43%|####################################8                                                 | 3/7 [00:02<00:02,  1.54it/s]Column:  57%|#################################################1                                    | 4/7 [00:02<00:02,  1.50it/s]Column:  71%|#############################################################4                        | 5/7 [00:03<00:01,  1.34it/s]Column:  86%|#########################################################################7            | 6/7 [00:04<00:00,  1.37it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.41it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.38it/s]
