2024-01-21 12:04:10.814 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/./config/alpaca_gpt4_data_zh.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/output/analysis/alpaca_gpt4_data_zh]
2024-01-21 12:04:10.827 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./config/alpaca_gpt4_data_zh.yaml, cwd=/root/autodl-tmp/dj_mixture_challenge)]               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'alpaca_gpt4_data_zh'                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/alpaca_gpt4_data_zh.jsonl'                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/alpaca_gpt4_data_zh/alpaca_gpt4_data_zh.jsonl' │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/.cache/huggingface/datasets'                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'text_length_filter': {'image_key': 'images',                                                       │
│                        │                          'max_len': 4096,                                                             │
│                        │                          'min_len': 1,                                                                │
│                        │                          'text_key': 'text'}},                                                        │
│                        │  {'language_id_score_filter': {'image_key': 'images',                                                 │
│                        │                                'lang': 'zh',                                                          │
│                        │                                'min_score': 0.8,                                                      │
│                        │                                'text_key': 'text'}},                                                  │
│                        │  {'perplexity_filter': {'image_key': 'images',                                                        │
│                        │                         'lang': 'zh',                                                                 │
│                        │                         'max_ppl': 1500,                                                              │
│                        │                         'text_key': 'text'}},                                                         │
│                        │  {'text_length_filter': {'image_key': 'images',                                                       │
│                        │                          'max_len': 10000,                                                            │
│                        │                          'min_len': 1.0,                                                              │
│                        │                          'text_key': 'text'}},                                                        │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                                      │
│                        │                           'max_ratio': 1.0,                                                           │
│                        │                           'min_ratio': 0.8,                                                           │
│                        │                           'text_key': 'text',                                                         │
│                        │                           'tokenization': False}},                                                    │
│                        │  {'character_repetition_filter': {'image_key': 'images',                                              │
│                        │                                   'max_ratio': 0.3,                                                   │
│                        │                                   'min_ratio': 0.0,                                                   │
│                        │                                   'rep_len': 10,                                                      │
│                        │                                   'text_key': 'text'}},                                               │
│                        │  {'word_repetition_filter': {'image_key': 'images',                                                   │
│                        │                              'lang': 'zh',                                                            │
│                        │                              'max_ratio': 0.5,                                                        │
│                        │                              'min_ratio': 0.0,                                                        │
│                        │                              'rep_len': 10,                                                           │
│                        │                              'text_key': 'text',                                                      │
│                        │                              'tokenization': False}}]                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/alpaca_gpt4_data_zh'                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240121120410'                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                 │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════╛
2024-01-21 12:04:10.828 | INFO     | data_juicer.core.analyser:__init__:39 - Using cache compression method: [None]
2024-01-21 12:04:10.828 | INFO     | data_juicer.core.analyser:__init__:44 - Setting up data formatter...
2024-01-21 12:04:10.829 | INFO     | data_juicer.core.analyser:__init__:53 - Preparing exporter...
2024-01-21 12:04:10.829 | INFO     | data_juicer.core.analyser:run:75 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 13574 examples [00:00, 123627.34 examples/s]Generating jsonl split: 40018 examples [00:00, 149669.71 examples/s]Generating jsonl split: 48818 examples [00:00, 147355.39 examples/s]
2024-01-21 12:04:12.279 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-01-21 12:04:12.280 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 48818 sample(s) in the original dataset.
Filter (num_proc=4):   0%|                                                                      | 0/48818 [00:00<?, ? examples/s]Filter (num_proc=4):   2%|#1                                                       | 1000/48818 [00:00<00:06, 7110.88 examples/s]Filter (num_proc=4):  18%|##########3                                             | 9000/48818 [00:00<00:00, 39907.70 examples/s]Filter (num_proc=4):  35%|###################1                                   | 17000/48818 [00:00<00:00, 54416.82 examples/s]Filter (num_proc=4):  55%|##############################4                        | 27000/48818 [00:00<00:00, 70146.22 examples/s]Filter (num_proc=4):  74%|########################################5              | 36000/48818 [00:00<00:00, 68085.42 examples/s]Filter (num_proc=4):  93%|###################################################1   | 45408/48818 [00:00<00:00, 72085.38 examples/s]Filter (num_proc=4): 100%|#######################################################| 48818/48818 [00:00<00:00, 55487.17 examples/s]
2024-01-21 12:04:13.279 | INFO     | data_juicer.format.formatter:unify_format:214 - 48818 samples left after filtering empty text.
2024-01-21 12:04:13.280 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 48818 from 48818
2024-01-21 12:04:13.285 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 48818 in final dataset
2024-01-21 12:04:13.286 | INFO     | data_juicer.core.analyser:run:81 - Preparing process operators...
2024-01-21 12:04:13.287 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-01-21 12:04:13.502 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-01-21 12:04:13.591 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-01-21 12:04:13.808 | INFO     | data_juicer.core.analyser:run:86 - Computing the stats of dataset...
Adding new column for stats (num_proc=4):   0%|                                                 | 0/48818 [00:00<?, ? examples/s]Adding new column for stats (num_proc=4):   1%|4                                    | 577/48818 [00:00<00:09, 5143.80 examples/s]Adding new column for stats (num_proc=4):   7%|##4                                | 3457/48818 [00:00<00:02, 16469.78 examples/s]Adding new column for stats (num_proc=4):  15%|#####3                             | 7518/48818 [00:00<00:01, 26426.68 examples/s]Adding new column for stats (num_proc=4):  22%|#######3                          | 10569/48818 [00:00<00:01, 27841.30 examples/s]Adding new column for stats (num_proc=4):  28%|#########4                        | 13628/48818 [00:00<00:01, 28624.99 examples/s]Adding new column for stats (num_proc=4):  35%|###########9                      | 17189/48818 [00:00<00:01, 29442.63 examples/s]Adding new column for stats (num_proc=4):  42%|##############2                   | 20407/48818 [00:00<00:01, 17267.93 examples/s]Adding new column for stats (num_proc=4):  48%|################4                 | 23667/48818 [00:01<00:01, 20349.33 examples/s]Adding new column for stats (num_proc=4):  54%|##################5               | 26565/48818 [00:01<00:01, 21842.04 examples/s]Adding new column for stats (num_proc=4):  62%|####################9             | 30078/48818 [00:01<00:00, 23958.92 examples/s]Adding new column for stats (num_proc=4):  69%|#######################4          | 33651/48818 [00:01<00:00, 26657.02 examples/s]Adding new column for stats (num_proc=4):  75%|#########################5        | 36699/48818 [00:01<00:00, 27003.35 examples/s]Adding new column for stats (num_proc=4):  84%|############################6     | 41119/48818 [00:01<00:00, 29379.89 examples/s]Adding new column for stats (num_proc=4):  91%|##############################8   | 44294/48818 [00:01<00:00, 28632.10 examples/s]Adding new column for stats (num_proc=4):  97%|################################# | 47506/48818 [00:01<00:00, 25550.96 examples/s]Adding new column for stats (num_proc=4): 100%|##################################| 48818/48818 [00:02<00:00, 21512.01 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/48818 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|3                               | 517/48818 [00:00<00:09, 4910.33 examples/s]text_length_filter_compute_stats (num_proc=4):   7%|##                            | 3346/48818 [00:00<00:02, 15589.73 examples/s]text_length_filter_compute_stats (num_proc=4):  15%|####5                         | 7432/48818 [00:00<00:01, 24084.82 examples/s]text_length_filter_compute_stats (num_proc=4):  20%|######1                       | 9939/48818 [00:00<00:01, 24350.99 examples/s]text_length_filter_compute_stats (num_proc=4):  27%|#######7                     | 13002/48818 [00:00<00:01, 26434.73 examples/s]text_length_filter_compute_stats (num_proc=4):  35%|##########                   | 16858/48818 [00:00<00:01, 30345.76 examples/s]text_length_filter_compute_stats (num_proc=4):  42%|############                 | 20310/48818 [00:00<00:00, 28647.16 examples/s]text_length_filter_compute_stats (num_proc=4):  48%|#############9               | 23455/48818 [00:00<00:00, 28088.29 examples/s]text_length_filter_compute_stats (num_proc=4):  54%|###############7             | 26526/48818 [00:01<00:00, 26318.68 examples/s]text_length_filter_compute_stats (num_proc=4):  61%|#################7           | 29964/48818 [00:01<00:00, 27999.85 examples/s]text_length_filter_compute_stats (num_proc=4):  68%|###################5         | 32989/48818 [00:01<00:00, 27826.39 examples/s]text_length_filter_compute_stats (num_proc=4):  73%|#####################3       | 35868/48818 [00:01<00:00, 20030.32 examples/s]text_length_filter_compute_stats (num_proc=4):  79%|######################8      | 38400/48818 [00:01<00:00, 18647.31 examples/s]text_length_filter_compute_stats (num_proc=4):  84%|########################2    | 40879/48818 [00:01<00:00, 19238.67 examples/s]text_length_filter_compute_stats (num_proc=4):  89%|#########################8   | 43482/48818 [00:01<00:00, 20766.28 examples/s]text_length_filter_compute_stats (num_proc=4):  94%|###########################3 | 46101/48818 [00:01<00:00, 22094.14 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|############################8| 48623/48818 [00:02<00:00, 18417.58 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 48818/48818 [00:02<00:00, 21546.58 examples/s]
language_id_score_filter_compute_stats (num_proc=4):   0%|                                      | 0/48818 [00:00<?, ? examples/s]language_id_score_filter_compute_stats (num_proc=4):   0%|                          | 139/48818 [00:00<00:37, 1306.58 examples/s]language_id_score_filter_compute_stats (num_proc=4):   3%|8                        | 1670/48818 [00:00<00:05, 8959.66 examples/s]language_id_score_filter_compute_stats (num_proc=4):   6%|#5                      | 3106/48818 [00:00<00:04, 11064.29 examples/s]language_id_score_filter_compute_stats (num_proc=4):   9%|##1                      | 4215/48818 [00:00<00:05, 8390.75 examples/s]language_id_score_filter_compute_stats (num_proc=4):  12%|##8                     | 5797/48818 [00:00<00:04, 10277.02 examples/s]language_id_score_filter_compute_stats (num_proc=4):  15%|###5                    | 7150/48818 [00:00<00:03, 11193.13 examples/s]language_id_score_filter_compute_stats (num_proc=4):  17%|####1                   | 8377/48818 [00:00<00:03, 10397.60 examples/s]language_id_score_filter_compute_stats (num_proc=4):  20%|####7                   | 9667/48818 [00:00<00:03, 10979.46 examples/s]language_id_score_filter_compute_stats (num_proc=4):  23%|#####1                 | 11034/48818 [00:01<00:03, 11724.41 examples/s]language_id_score_filter_compute_stats (num_proc=4):  26%|#####9                 | 12569/48818 [00:01<00:03, 11775.56 examples/s]language_id_score_filter_compute_stats (num_proc=4):  28%|######5                | 13906/48818 [00:01<00:03, 11028.66 examples/s]language_id_score_filter_compute_stats (num_proc=4):  32%|#######2               | 15476/48818 [00:01<00:02, 12242.83 examples/s]language_id_score_filter_compute_stats (num_proc=4):  35%|#######9               | 16858/48818 [00:01<00:02, 11187.40 examples/s]language_id_score_filter_compute_stats (num_proc=4):  38%|########7              | 18477/48818 [00:01<00:02, 12401.04 examples/s]language_id_score_filter_compute_stats (num_proc=4):  41%|#########4             | 20041/48818 [00:01<00:02, 12540.81 examples/s]language_id_score_filter_compute_stats (num_proc=4):  44%|##########             | 21407/48818 [00:01<00:02, 12407.99 examples/s]language_id_score_filter_compute_stats (num_proc=4):  47%|##########7            | 22766/48818 [00:02<00:02, 12218.44 examples/s]language_id_score_filter_compute_stats (num_proc=4):  49%|###########3           | 24009/48818 [00:02<00:02, 12267.17 examples/s]language_id_score_filter_compute_stats (num_proc=4):  52%|###########9           | 25427/48818 [00:02<00:01, 12266.95 examples/s]language_id_score_filter_compute_stats (num_proc=4):  55%|############5          | 26668/48818 [00:02<00:01, 12074.56 examples/s]language_id_score_filter_compute_stats (num_proc=4):  58%|#############3         | 28406/48818 [00:02<00:01, 12688.15 examples/s]language_id_score_filter_compute_stats (num_proc=4):  61%|##############         | 29855/48818 [00:02<00:01, 12530.32 examples/s]language_id_score_filter_compute_stats (num_proc=4):  64%|##############6        | 31196/48818 [00:02<00:01, 11971.79 examples/s]language_id_score_filter_compute_stats (num_proc=4):  67%|###############4       | 32737/48818 [00:02<00:01, 12875.69 examples/s]language_id_score_filter_compute_stats (num_proc=4):  70%|################1      | 34178/48818 [00:02<00:01, 12160.12 examples/s]language_id_score_filter_compute_stats (num_proc=4):  73%|#################4      | 35590/48818 [00:03<00:01, 9879.71 examples/s]language_id_score_filter_compute_stats (num_proc=4):  75%|##################      | 36779/48818 [00:03<00:01, 8495.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):  78%|##################6     | 37840/48818 [00:03<00:01, 8938.96 examples/s]language_id_score_filter_compute_stats (num_proc=4):  80%|###################2    | 39206/48818 [00:03<00:00, 9940.79 examples/s]language_id_score_filter_compute_stats (num_proc=4):  83%|###################1   | 40627/48818 [00:03<00:00, 10393.02 examples/s]language_id_score_filter_compute_stats (num_proc=4):  86%|###################8   | 42090/48818 [00:03<00:00, 11278.34 examples/s]language_id_score_filter_compute_stats (num_proc=4):  89%|####################4  | 43362/48818 [00:03<00:00, 11650.70 examples/s]language_id_score_filter_compute_stats (num_proc=4):  91%|#####################  | 44660/48818 [00:04<00:00, 11495.33 examples/s]language_id_score_filter_compute_stats (num_proc=4):  94%|#####################7 | 46126/48818 [00:04<00:00, 12339.10 examples/s]language_id_score_filter_compute_stats (num_proc=4):  97%|######################4| 47594/48818 [00:04<00:00, 12353.83 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|#######################| 48818/48818 [00:04<00:00, 10859.72 examples/s]
perplexity_filter_compute_stats (num_proc=4):   0%|                                             | 0/48818 [00:00<?, ? examples/s]perplexity_filter_compute_stats (num_proc=4):   0%|                                   | 25/48818 [00:00<03:46, 215.59 examples/s]perplexity_filter_compute_stats (num_proc=4):   1%|3                                | 557/48818 [00:00<00:16, 2986.39 examples/s]perplexity_filter_compute_stats (num_proc=4):   3%|8                               | 1302/48818 [00:00<00:09, 4925.70 examples/s]perplexity_filter_compute_stats (num_proc=4):   4%|#4                              | 2162/48818 [00:00<00:07, 6320.09 examples/s]perplexity_filter_compute_stats (num_proc=4):   6%|##                              | 3058/48818 [00:00<00:06, 7249.79 examples/s]perplexity_filter_compute_stats (num_proc=4):   8%|##5                             | 3962/48818 [00:00<00:05, 7819.04 examples/s]perplexity_filter_compute_stats (num_proc=4):  10%|###1                            | 4772/48818 [00:00<00:06, 7111.83 examples/s]perplexity_filter_compute_stats (num_proc=4):  12%|###7                            | 5790/48818 [00:00<00:05, 7989.53 examples/s]perplexity_filter_compute_stats (num_proc=4):  14%|####4                           | 6751/48818 [00:00<00:04, 8464.42 examples/s]perplexity_filter_compute_stats (num_proc=4):  16%|#####                           | 7751/48818 [00:01<00:04, 8903.45 examples/s]perplexity_filter_compute_stats (num_proc=4):  18%|#####7                          | 8796/48818 [00:01<00:04, 8442.73 examples/s]perplexity_filter_compute_stats (num_proc=4):  20%|######4                         | 9833/48818 [00:01<00:04, 8516.81 examples/s]perplexity_filter_compute_stats (num_proc=4):  22%|######9                        | 10928/48818 [00:01<00:04, 8665.25 examples/s]perplexity_filter_compute_stats (num_proc=4):  24%|#######5                       | 11890/48818 [00:01<00:04, 8908.43 examples/s]perplexity_filter_compute_stats (num_proc=4):  26%|########1                      | 12894/48818 [00:01<00:04, 8545.12 examples/s]perplexity_filter_compute_stats (num_proc=4):  28%|########7                      | 13800/48818 [00:01<00:04, 8568.23 examples/s]perplexity_filter_compute_stats (num_proc=4):  30%|#########3                     | 14769/48818 [00:01<00:03, 8859.93 examples/s]perplexity_filter_compute_stats (num_proc=4):  32%|##########                     | 15780/48818 [00:01<00:03, 9198.99 examples/s]perplexity_filter_compute_stats (num_proc=4):  34%|##########6                    | 16743/48818 [00:02<00:03, 9302.40 examples/s]perplexity_filter_compute_stats (num_proc=4):  36%|###########2                   | 17715/48818 [00:02<00:03, 9194.03 examples/s]perplexity_filter_compute_stats (num_proc=4):  39%|###########9                   | 18832/48818 [00:02<00:03, 9751.60 examples/s]perplexity_filter_compute_stats (num_proc=4):  41%|############6                  | 19917/48818 [00:02<00:02, 9829.01 examples/s]perplexity_filter_compute_stats (num_proc=4):  43%|############9                 | 21060/48818 [00:02<00:02, 10283.02 examples/s]perplexity_filter_compute_stats (num_proc=4):  45%|#############6                | 22181/48818 [00:02<00:02, 10371.23 examples/s]perplexity_filter_compute_stats (num_proc=4):  48%|##############4               | 23453/48818 [00:02<00:02, 11047.12 examples/s]perplexity_filter_compute_stats (num_proc=4):  51%|###############1              | 24698/48818 [00:02<00:02, 10279.59 examples/s]perplexity_filter_compute_stats (num_proc=4):  53%|###############8              | 25759/48818 [00:02<00:02, 10231.81 examples/s]perplexity_filter_compute_stats (num_proc=4):  55%|################5             | 26946/48818 [00:03<00:02, 10674.52 examples/s]perplexity_filter_compute_stats (num_proc=4):  58%|#################2            | 28132/48818 [00:03<00:01, 10941.90 examples/s]perplexity_filter_compute_stats (num_proc=4):  60%|##################            | 29325/48818 [00:03<00:01, 10893.76 examples/s]perplexity_filter_compute_stats (num_proc=4):  62%|##################6           | 30428/48818 [00:03<00:01, 10910.11 examples/s]perplexity_filter_compute_stats (num_proc=4):  65%|###################4          | 31605/48818 [00:03<00:01, 11151.33 examples/s]perplexity_filter_compute_stats (num_proc=4):  67%|####################1         | 32781/48818 [00:03<00:01, 10614.21 examples/s]perplexity_filter_compute_stats (num_proc=4):  69%|####################8         | 33914/48818 [00:03<00:01, 10182.75 examples/s]perplexity_filter_compute_stats (num_proc=4):  72%|#####################5        | 35080/48818 [00:03<00:01, 10577.18 examples/s]perplexity_filter_compute_stats (num_proc=4):  74%|######################2       | 36258/48818 [00:03<00:01, 10895.02 examples/s]perplexity_filter_compute_stats (num_proc=4):  77%|#######################7       | 37446/48818 [00:04<00:01, 9502.12 examples/s]perplexity_filter_compute_stats (num_proc=4):  79%|########################4      | 38447/48818 [00:04<00:01, 9528.37 examples/s]perplexity_filter_compute_stats (num_proc=4):  81%|#########################      | 39471/48818 [00:04<00:00, 9501.78 examples/s]perplexity_filter_compute_stats (num_proc=4):  83%|#########################7     | 40502/48818 [00:04<00:00, 9360.29 examples/s]perplexity_filter_compute_stats (num_proc=4):  85%|##########################3    | 41560/48818 [00:04<00:00, 7947.47 examples/s]perplexity_filter_compute_stats (num_proc=4):  87%|##########################9    | 42481/48818 [00:04<00:00, 7349.78 examples/s]perplexity_filter_compute_stats (num_proc=4):  89%|###########################5   | 43323/48818 [00:04<00:00, 7382.69 examples/s]perplexity_filter_compute_stats (num_proc=4):  91%|############################1  | 44281/48818 [00:04<00:00, 7916.94 examples/s]perplexity_filter_compute_stats (num_proc=4):  93%|############################6  | 45195/48818 [00:05<00:00, 7950.95 examples/s]perplexity_filter_compute_stats (num_proc=4):  94%|#############################2 | 46023/48818 [00:05<00:00, 8022.65 examples/s]perplexity_filter_compute_stats (num_proc=4):  96%|#############################8 | 46947/48818 [00:05<00:00, 8091.83 examples/s]perplexity_filter_compute_stats (num_proc=4):  98%|##############################3| 47790/48818 [00:05<00:00, 6797.81 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|##############################8| 48591/48818 [00:05<00:00, 5855.37 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|###############################| 48818/48818 [00:05<00:00, 8367.90 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/48818 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|3                               | 586/48818 [00:00<00:08, 5513.03 examples/s]text_length_filter_compute_stats (num_proc=4):   8%|##4                           | 3914/48818 [00:00<00:02, 19366.57 examples/s]text_length_filter_compute_stats (num_proc=4):  16%|####8                         | 7959/48818 [00:00<00:01, 27968.07 examples/s]text_length_filter_compute_stats (num_proc=4):  23%|######5                      | 10985/48818 [00:00<00:01, 28152.25 examples/s]text_length_filter_compute_stats (num_proc=4):  29%|########3                    | 14033/48818 [00:00<00:01, 27237.78 examples/s]text_length_filter_compute_stats (num_proc=4):  36%|##########4                  | 17618/48818 [00:00<00:01, 28507.10 examples/s]text_length_filter_compute_stats (num_proc=4):  42%|############3                | 20729/48818 [00:00<00:00, 28797.56 examples/s]text_length_filter_compute_stats (num_proc=4):  49%|##############               | 23681/48818 [00:00<00:00, 28993.61 examples/s]text_length_filter_compute_stats (num_proc=4):  56%|################1            | 27238/48818 [00:00<00:00, 30847.34 examples/s]text_length_filter_compute_stats (num_proc=4):  63%|##################2          | 30695/48818 [00:01<00:00, 21935.66 examples/s]text_length_filter_compute_stats (num_proc=4):  68%|###################8         | 33433/48818 [00:01<00:00, 20840.65 examples/s]text_length_filter_compute_stats (num_proc=4):  74%|#####################4       | 36090/48818 [00:01<00:00, 19099.07 examples/s]text_length_filter_compute_stats (num_proc=4):  80%|#######################1     | 39020/48818 [00:01<00:00, 21191.06 examples/s]text_length_filter_compute_stats (num_proc=4):  87%|#########################1   | 42384/48818 [00:01<00:00, 23595.02 examples/s]text_length_filter_compute_stats (num_proc=4):  93%|###########################  | 45472/48818 [00:01<00:00, 23120.36 examples/s]text_length_filter_compute_stats (num_proc=4):  98%|############################5| 48041/48818 [00:02<00:00, 22204.18 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 48818/48818 [00:02<00:00, 22689.49 examples/s]
alphanumeric_filter_compute_stats (num_proc=4):   0%|                                           | 0/48818 [00:00<?, ? examples/s]alphanumeric_filter_compute_stats (num_proc=4):   1%|1                              | 279/48818 [00:00<00:21, 2305.70 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   7%|#9                           | 3239/48818 [00:00<00:03, 14305.16 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  13%|###7                         | 6269/48818 [00:00<00:02, 19749.42 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  17%|####9                        | 8380/48818 [00:00<00:02, 19150.87 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  23%|######4                     | 11196/48818 [00:00<00:01, 21607.21 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  28%|#######9                    | 13868/48818 [00:00<00:01, 22108.12 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  33%|#########3                  | 16339/48818 [00:00<00:01, 22828.29 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  38%|##########7                 | 18782/48818 [00:00<00:01, 21955.87 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  45%|############4               | 21755/48818 [00:01<00:01, 22477.70 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  49%|#############7              | 24021/48818 [00:01<00:01, 21331.71 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  55%|###############2            | 26627/48818 [00:01<00:01, 21518.41 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  61%|################9           | 29542/48818 [00:01<00:00, 23386.63 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  65%|##################3         | 31973/48818 [00:01<00:00, 22062.15 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  70%|###################6        | 34322/48818 [00:01<00:00, 21519.90 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  76%|#####################2      | 37079/48818 [00:01<00:00, 22922.32 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  81%|######################7     | 39664/48818 [00:02<00:00, 14533.61 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  86%|########################1   | 42127/48818 [00:02<00:00, 16485.86 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  91%|#########################4  | 44366/48818 [00:02<00:00, 17754.20 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  95%|##########################6 | 46484/48818 [00:02<00:00, 17340.71 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  99%|############################7| 48481/48818 [00:02<00:00, 9616.33 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|############################| 48818/48818 [00:03<00:00, 15904.11 examples/s]
character_repetition_filter_compute_stats (num_proc=4):   0%|                                   | 0/48818 [00:00<?, ? examples/s]character_repetition_filter_compute_stats (num_proc=4):   0%|                       | 158/48818 [00:00<00:34, 1398.68 examples/s]character_repetition_filter_compute_stats (num_proc=4):   3%|5                     | 1278/48818 [00:00<00:06, 6862.82 examples/s]character_repetition_filter_compute_stats (num_proc=4):   5%|#1                    | 2443/48818 [00:00<00:05, 8973.56 examples/s]character_repetition_filter_compute_stats (num_proc=4):   7%|#6                    | 3643/48818 [00:00<00:04, 9809.15 examples/s]character_repetition_filter_compute_stats (num_proc=4):  10%|##                   | 4858/48818 [00:00<00:04, 10465.61 examples/s]character_repetition_filter_compute_stats (num_proc=4):  12%|##6                  | 6047/48818 [00:00<00:03, 10928.90 examples/s]character_repetition_filter_compute_stats (num_proc=4):  15%|###1                 | 7258/48818 [00:00<00:03, 10826.49 examples/s]character_repetition_filter_compute_stats (num_proc=4):  17%|###6                 | 8485/48818 [00:00<00:03, 11095.83 examples/s]character_repetition_filter_compute_stats (num_proc=4):  20%|####1                | 9671/48818 [00:00<00:03, 11303.11 examples/s]character_repetition_filter_compute_stats (num_proc=4):  22%|####4               | 10860/48818 [00:01<00:03, 11198.99 examples/s]character_repetition_filter_compute_stats (num_proc=4):  25%|####9               | 12047/48818 [00:01<00:03, 11085.20 examples/s]character_repetition_filter_compute_stats (num_proc=4):  27%|#####4              | 13411/48818 [00:01<00:02, 11816.20 examples/s]character_repetition_filter_compute_stats (num_proc=4):  30%|######              | 14722/48818 [00:01<00:02, 11429.30 examples/s]character_repetition_filter_compute_stats (num_proc=4):  33%|######5             | 15953/48818 [00:01<00:02, 11662.88 examples/s]character_repetition_filter_compute_stats (num_proc=4):  35%|#######             | 17233/48818 [00:01<00:02, 11008.76 examples/s]character_repetition_filter_compute_stats (num_proc=4):  38%|#######5            | 18353/48818 [00:01<00:02, 10551.26 examples/s]character_repetition_filter_compute_stats (num_proc=4):  40%|########            | 19641/48818 [00:01<00:02, 11064.83 examples/s]character_repetition_filter_compute_stats (num_proc=4):  43%|########5           | 20931/48818 [00:01<00:02, 11557.35 examples/s]character_repetition_filter_compute_stats (num_proc=4):  45%|#########           | 22159/48818 [00:02<00:02, 10238.19 examples/s]character_repetition_filter_compute_stats (num_proc=4):  48%|#########5          | 23306/48818 [00:02<00:02, 10551.89 examples/s]character_repetition_filter_compute_stats (num_proc=4):  50%|##########          | 24451/48818 [00:02<00:02, 10787.56 examples/s]character_repetition_filter_compute_stats (num_proc=4):  52%|##########4         | 25629/48818 [00:02<00:02, 10977.03 examples/s]character_repetition_filter_compute_stats (num_proc=4):  55%|##########9         | 26764/48818 [00:02<00:02, 10503.77 examples/s]character_repetition_filter_compute_stats (num_proc=4):  58%|###########5        | 28086/48818 [00:02<00:01, 11243.11 examples/s]character_repetition_filter_compute_stats (num_proc=4):  60%|############        | 29400/48818 [00:02<00:01, 11768.87 examples/s]character_repetition_filter_compute_stats (num_proc=4):  63%|############5       | 30621/48818 [00:02<00:01, 10500.70 examples/s]character_repetition_filter_compute_stats (num_proc=4):  65%|#############       | 31878/48818 [00:02<00:01, 11034.90 examples/s]character_repetition_filter_compute_stats (num_proc=4):  68%|#############5      | 33120/48818 [00:03<00:01, 11172.27 examples/s]character_repetition_filter_compute_stats (num_proc=4):  70%|##############7      | 34339/48818 [00:03<00:01, 8457.73 examples/s]character_repetition_filter_compute_stats (num_proc=4):  73%|###############2     | 35476/48818 [00:03<00:01, 8923.87 examples/s]character_repetition_filter_compute_stats (num_proc=4):  75%|###############7     | 36559/48818 [00:03<00:01, 9247.49 examples/s]character_repetition_filter_compute_stats (num_proc=4):  77%|################1    | 37653/48818 [00:03<00:01, 9018.43 examples/s]character_repetition_filter_compute_stats (num_proc=4):  80%|################7    | 38855/48818 [00:03<00:01, 9670.36 examples/s]character_repetition_filter_compute_stats (num_proc=4):  82%|#################1   | 39932/48818 [00:03<00:00, 9262.53 examples/s]character_repetition_filter_compute_stats (num_proc=4):  84%|#################5   | 40904/48818 [00:03<00:00, 8981.37 examples/s]character_repetition_filter_compute_stats (num_proc=4):  86%|##################1  | 42214/48818 [00:04<00:00, 9602.44 examples/s]character_repetition_filter_compute_stats (num_proc=4):  89%|#################8  | 43496/48818 [00:04<00:00, 10435.04 examples/s]character_repetition_filter_compute_stats (num_proc=4):  92%|##################3 | 44678/48818 [00:04<00:00, 10022.55 examples/s]character_repetition_filter_compute_stats (num_proc=4):  94%|##################8 | 45939/48818 [00:04<00:00, 10527.01 examples/s]character_repetition_filter_compute_stats (num_proc=4):  97%|####################2| 47137/48818 [00:04<00:00, 9606.42 examples/s]character_repetition_filter_compute_stats (num_proc=4):  99%|####################7| 48165/48818 [00:04<00:00, 7151.47 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|#####################| 48818/48818 [00:05<00:00, 9441.95 examples/s]
word_repetition_filter_compute_stats (num_proc=4):   0%|                                        | 0/48818 [00:00<?, ? examples/s]word_repetition_filter_compute_stats (num_proc=4):   1%|1                           | 267/48818 [00:00<00:19, 2439.68 examples/s]word_repetition_filter_compute_stats (num_proc=4):   6%|#4                        | 2746/48818 [00:00<00:03, 14374.69 examples/s]word_repetition_filter_compute_stats (num_proc=4):   9%|##2                       | 4194/48818 [00:00<00:03, 13861.76 examples/s]word_repetition_filter_compute_stats (num_proc=4):  13%|###4                      | 6452/48818 [00:00<00:02, 17109.45 examples/s]word_repetition_filter_compute_stats (num_proc=4):  17%|####4                     | 8349/48818 [00:00<00:02, 17246.07 examples/s]word_repetition_filter_compute_stats (num_proc=4):  22%|#####3                   | 10501/48818 [00:00<00:02, 18632.37 examples/s]word_repetition_filter_compute_stats (num_proc=4):  26%|######4                  | 12636/48818 [00:00<00:02, 17168.39 examples/s]word_repetition_filter_compute_stats (num_proc=4):  30%|#######4                 | 14452/48818 [00:00<00:01, 17448.49 examples/s]word_repetition_filter_compute_stats (num_proc=4):  34%|########4                | 16487/48818 [00:00<00:01, 17872.23 examples/s]word_repetition_filter_compute_stats (num_proc=4):  38%|#########3               | 18331/48818 [00:01<00:01, 17786.34 examples/s]word_repetition_filter_compute_stats (num_proc=4):  42%|##########5              | 20551/48818 [00:01<00:01, 18544.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  46%|###########5             | 22648/48818 [00:01<00:01, 19161.74 examples/s]word_repetition_filter_compute_stats (num_proc=4):  51%|############7            | 24860/48818 [00:01<00:01, 18577.48 examples/s]word_repetition_filter_compute_stats (num_proc=4):  55%|#############8           | 26967/48818 [00:01<00:01, 18357.76 examples/s]word_repetition_filter_compute_stats (num_proc=4):  60%|##############8          | 29054/48818 [00:01<00:01, 19044.58 examples/s]word_repetition_filter_compute_stats (num_proc=4):  64%|###############9         | 31167/48818 [00:01<00:01, 12623.26 examples/s]word_repetition_filter_compute_stats (num_proc=4):  68%|################9        | 33058/48818 [00:02<00:01, 13908.08 examples/s]word_repetition_filter_compute_stats (num_proc=4):  72%|#################8       | 34905/48818 [00:02<00:00, 14868.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  75%|##################8      | 36738/48818 [00:02<00:00, 14878.75 examples/s]word_repetition_filter_compute_stats (num_proc=4):  79%|###################7     | 38498/48818 [00:02<00:00, 14572.38 examples/s]word_repetition_filter_compute_stats (num_proc=4):  82%|####################5    | 40104/48818 [00:02<00:00, 14752.84 examples/s]word_repetition_filter_compute_stats (num_proc=4):  86%|#####################5   | 42077/48818 [00:02<00:00, 16038.38 examples/s]word_repetition_filter_compute_stats (num_proc=4):  90%|######################4  | 43781/48818 [00:02<00:00, 16300.45 examples/s]word_repetition_filter_compute_stats (num_proc=4):  93%|#######################3 | 45581/48818 [00:02<00:00, 15587.35 examples/s]word_repetition_filter_compute_stats (num_proc=4):  97%|########################2| 47273/48818 [00:03<00:00, 10196.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  99%|#########################8| 48567/48818 [00:03<00:00, 7494.91 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|#########################| 48818/48818 [00:03<00:00, 13342.82 examples/s]
2024-01-21 12:04:44.049 | INFO     | data_juicer.core.analyser:run:110 - Exporting dataset to disk...
2024-01-21 12:04:44.050 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                    | 0/49 [00:00<?, ?ba/s]Creating json from Arrow format:  29%|################5                                         | 14/49 [00:00<00:00, 137.55ba/s]Creating json from Arrow format:  61%|###################################5                      | 30/49 [00:00<00:00, 147.35ba/s]Creating json from Arrow format:  92%|#####################################################2    | 45/49 [00:00<00:00, 145.79ba/s]Creating json from Arrow format: 100%|##########################################################| 49/49 [00:00<00:00, 145.92ba/s]
2024-01-21 12:04:44.395 | INFO     | data_juicer.core.analyser:run:122 - Applying overall analysis on stats...
  0%|                                                                                                      | 0/7 [00:00<?, ?it/s]100%|###########################################################################################| 7/7 [00:00<00:00, 11008.67it/s]
2024-01-21 12:04:45.847 | INFO     | data_juicer.core.analyser:run:127 - The overall analysis results are:        alnum_ratio char_rep_ratio     lang lang_score   perplexity    text_len word_rep_ratio
count      48818.0        48818.0  48818.0    48818.0      48818.0     48818.0        48818.0
mean      0.829028       0.019131      NaN   0.965286  1781.708503  251.216641       0.000599
std       0.082805       0.042317      NaN   0.099518  1958.337505  183.067662       0.016971
min       0.092338            0.0      NaN   0.100666         11.6         8.0            0.0
25%            0.8            0.0      NaN   0.985093        987.0        95.0            0.0
50%       0.853448            0.0      NaN   0.994306       1370.4       222.0            0.0
75%       0.884615       0.015564      NaN   0.997451       1942.5       383.0            0.0
max       0.949367       0.755285      NaN    1.00006      88156.3      2753.0       0.962963
unique         NaN            NaN     21.0        NaN          NaN         NaN            NaN
top            NaN            NaN       zh        NaN          NaN         NaN            NaN
freq           NaN            NaN  47155.0        NaN          NaN         NaN            NaN
2024-01-21 12:04:45.848 | INFO     | data_juicer.core.analyser:run:129 - Applying column-wise analysis on stats...
Column:   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Column:  14%|############2                                                                         | 1/7 [00:00<00:04,  1.30it/s]Column:  29%|########################5                                                             | 2/7 [00:01<00:03,  1.32it/s]Column:  43%|####################################8                                                 | 3/7 [00:02<00:02,  1.52it/s]Column:  57%|#################################################1                                    | 4/7 [00:02<00:02,  1.44it/s]Column:  71%|#############################################################4                        | 5/7 [00:03<00:01,  1.42it/s]Column:  86%|#########################################################################7            | 6/7 [00:04<00:00,  1.40it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.26it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.34it/s]
