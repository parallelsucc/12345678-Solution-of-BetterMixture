2024-01-21 11:57:43.839 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/./config/GPTeacher.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/output/analysis/GPTeacher]
2024-01-21 11:57:43.851 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                            │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./config/GPTeacher.yaml, cwd=/root/autodl-tmp/dj_mixture_challenge)]     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'GPTeacher'                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/GPTeacher.jsonl'                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/GPTeacher/GPTeacher.jsonl' │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/.cache/huggingface/datasets'                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'text_length_filter': {'image_key': 'images',                                   │
│                        │                          'max_len': 4096,                                         │
│                        │                          'min_len': 1,                                            │
│                        │                          'text_key': 'text'}},                                    │
│                        │  {'language_id_score_filter': {'image_key': 'images',                             │
│                        │                                'lang': 'en',                                      │
│                        │                                'min_score': 0.8,                                  │
│                        │                                'text_key': 'text'}},                              │
│                        │  {'perplexity_filter': {'image_key': 'images',                                    │
│                        │                         'lang': 'en',                                             │
│                        │                         'max_ppl': 1500,                                          │
│                        │                         'text_key': 'text'}},                                     │
│                        │  {'text_length_filter': {'image_key': 'images',                                   │
│                        │                          'max_len': 10000,                                        │
│                        │                          'min_len': 1.0,                                          │
│                        │                          'text_key': 'text'}},                                    │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                  │
│                        │                           'max_ratio': 1.0,                                       │
│                        │                           'min_ratio': 0.8,                                       │
│                        │                           'text_key': 'text',                                     │
│                        │                           'tokenization': False}},                                │
│                        │  {'character_repetition_filter': {'image_key': 'images',                          │
│                        │                                   'max_ratio': 0.3,                               │
│                        │                                   'min_ratio': 0.0,                               │
│                        │                                   'rep_len': 10,                                  │
│                        │                                   'text_key': 'text'}},                           │
│                        │  {'word_repetition_filter': {'image_key': 'images',                               │
│                        │                              'lang': 'en',                                        │
│                        │                              'max_ratio': 0.5,                                    │
│                        │                              'min_ratio': 0.0,                                    │
│                        │                              'rep_len': 10,                                       │
│                        │                              'text_key': 'text',                                  │
│                        │                              'tokenization': False}}]                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/GPTeacher'                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240121115743'                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                             │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════╛
2024-01-21 11:57:43.852 | INFO     | data_juicer.core.analyser:__init__:39 - Using cache compression method: [None]
2024-01-21 11:57:43.853 | INFO     | data_juicer.core.analyser:__init__:44 - Setting up data formatter...
2024-01-21 11:57:43.853 | INFO     | data_juicer.core.analyser:__init__:53 - Preparing exporter...
2024-01-21 11:57:43.854 | INFO     | data_juicer.core.analyser:run:75 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 20955 examples [00:00, 150983.62 examples/s]Generating jsonl split: 33548 examples [00:00, 164569.27 examples/s]
2024-01-21 11:57:45.032 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-01-21 11:57:45.033 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 33548 sample(s) in the original dataset.
Filter (num_proc=4):   0%|                                                                      | 0/33548 [00:00<?, ? examples/s]Filter (num_proc=4):   3%|#6                                                       | 1000/33548 [00:00<00:03, 8741.67 examples/s]Filter (num_proc=4):  30%|################3                                      | 10000/33548 [00:00<00:00, 44956.46 examples/s]Filter (num_proc=4):  57%|###############################1                       | 19000/33548 [00:00<00:00, 59511.16 examples/s]Filter (num_proc=4):  85%|##############################################5        | 28387/33548 [00:00<00:00, 68652.40 examples/s]Filter (num_proc=4): 100%|#######################################################| 33548/33548 [00:00<00:00, 53093.60 examples/s]
2024-01-21 11:57:45.787 | INFO     | data_juicer.format.formatter:unify_format:214 - 33548 samples left after filtering empty text.
2024-01-21 11:57:45.788 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 33548 from 33548
2024-01-21 11:57:45.791 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 33548 in final dataset
2024-01-21 11:57:45.792 | INFO     | data_juicer.core.analyser:run:81 - Preparing process operators...
2024-01-21 11:57:45.792 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-01-21 11:57:45.979 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-01-21 11:57:46.044 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-01-21 11:57:46.309 | INFO     | data_juicer.core.analyser:run:86 - Computing the stats of dataset...
Adding new column for stats (num_proc=4):   0%|                                                 | 0/33548 [00:00<?, ? examples/s]Adding new column for stats (num_proc=4):   1%|3                                    | 294/33548 [00:00<00:12, 2728.01 examples/s]Adding new column for stats (num_proc=4):  11%|###9                               | 3776/33548 [00:00<00:01, 19939.23 examples/s]Adding new column for stats (num_proc=4):  21%|#######3                           | 7090/33548 [00:00<00:01, 24542.54 examples/s]Adding new column for stats (num_proc=4):  29%|##########                         | 9625/33548 [00:00<00:00, 24563.03 examples/s]Adding new column for stats (num_proc=4):  38%|############7                     | 12599/33548 [00:00<00:00, 25801.11 examples/s]Adding new column for stats (num_proc=4):  48%|################3                 | 16178/33548 [00:00<00:00, 27873.80 examples/s]Adding new column for stats (num_proc=4):  57%|###################5              | 19265/33548 [00:00<00:00, 24043.23 examples/s]Adding new column for stats (num_proc=4):  65%|######################            | 21804/33548 [00:01<00:00, 15537.97 examples/s]Adding new column for stats (num_proc=4):  76%|#########################8        | 25510/33548 [00:01<00:00, 19013.93 examples/s]Adding new column for stats (num_proc=4):  86%|#############################3    | 28990/33548 [00:01<00:00, 21574.65 examples/s]Adding new column for stats (num_proc=4):  95%|################################1 | 31730/33548 [00:01<00:00, 21212.23 examples/s]Adding new column for stats (num_proc=4): 100%|##################################| 33548/33548 [00:01<00:00, 19510.52 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/33548 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|2                               | 277/33548 [00:00<00:12, 2622.35 examples/s]text_length_filter_compute_stats (num_proc=4):  10%|##9                           | 3326/33548 [00:00<00:01, 17771.63 examples/s]text_length_filter_compute_stats (num_proc=4):  20%|######1                       | 6829/33548 [00:00<00:01, 23938.89 examples/s]text_length_filter_compute_stats (num_proc=4):  28%|########5                     | 9527/33548 [00:00<00:01, 23875.77 examples/s]text_length_filter_compute_stats (num_proc=4):  38%|##########8                  | 12594/33548 [00:00<00:00, 26144.61 examples/s]text_length_filter_compute_stats (num_proc=4):  48%|#############8               | 16047/33548 [00:00<00:00, 28845.80 examples/s]text_length_filter_compute_stats (num_proc=4):  59%|#################            | 19680/33548 [00:00<00:00, 27659.93 examples/s]text_length_filter_compute_stats (num_proc=4):  69%|####################         | 23147/33548 [00:00<00:00, 29202.09 examples/s]text_length_filter_compute_stats (num_proc=4):  78%|######################6      | 26257/33548 [00:00<00:00, 29172.21 examples/s]text_length_filter_compute_stats (num_proc=4):  89%|#########################8   | 29924/33548 [00:01<00:00, 28299.33 examples/s]text_length_filter_compute_stats (num_proc=4):  98%|############################3| 32814/33548 [00:01<00:00, 23033.01 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 33548/33548 [00:01<00:00, 22916.02 examples/s]
language_id_score_filter_compute_stats (num_proc=4):   0%|                                      | 0/33548 [00:00<?, ? examples/s]language_id_score_filter_compute_stats (num_proc=4):   1%|1                         | 189/33548 [00:00<00:18, 1799.96 examples/s]language_id_score_filter_compute_stats (num_proc=4):   6%|#4                      | 1968/33548 [00:00<00:02, 10579.05 examples/s]language_id_score_filter_compute_stats (num_proc=4):  10%|##4                     | 3464/33548 [00:00<00:02, 12360.36 examples/s]language_id_score_filter_compute_stats (num_proc=4):  15%|###5                    | 4931/33548 [00:00<00:02, 10262.05 examples/s]language_id_score_filter_compute_stats (num_proc=4):  20%|####7                   | 6581/33548 [00:00<00:02, 10895.63 examples/s]language_id_score_filter_compute_stats (num_proc=4):  24%|#####6                  | 7941/33548 [00:00<00:02, 11639.36 examples/s]language_id_score_filter_compute_stats (num_proc=4):  28%|######6                 | 9333/33548 [00:00<00:02, 12072.99 examples/s]language_id_score_filter_compute_stats (num_proc=4):  32%|#######3               | 10704/33548 [00:00<00:01, 12513.59 examples/s]language_id_score_filter_compute_stats (num_proc=4):  36%|########2              | 12045/33548 [00:01<00:01, 12653.46 examples/s]language_id_score_filter_compute_stats (num_proc=4):  40%|#########1             | 13347/33548 [00:01<00:01, 11665.06 examples/s]language_id_score_filter_compute_stats (num_proc=4):  45%|##########2            | 14967/33548 [00:01<00:01, 12907.55 examples/s]language_id_score_filter_compute_stats (num_proc=4):  49%|###########1           | 16301/33548 [00:01<00:01, 12851.65 examples/s]language_id_score_filter_compute_stats (num_proc=4):  53%|############1          | 17751/33548 [00:01<00:01, 12433.13 examples/s]language_id_score_filter_compute_stats (num_proc=4):  58%|#############2         | 19353/33548 [00:01<00:01, 13387.34 examples/s]language_id_score_filter_compute_stats (num_proc=4):  62%|##############2        | 20719/33548 [00:01<00:01, 12603.92 examples/s]language_id_score_filter_compute_stats (num_proc=4):  66%|###############1       | 22042/33548 [00:01<00:00, 12765.37 examples/s]language_id_score_filter_compute_stats (num_proc=4):  70%|################       | 23391/33548 [00:01<00:00, 12846.25 examples/s]language_id_score_filter_compute_stats (num_proc=4):  74%|#################      | 24799/33548 [00:02<00:00, 13185.49 examples/s]language_id_score_filter_compute_stats (num_proc=4):  78%|#################9     | 26222/33548 [00:02<00:00, 13101.49 examples/s]language_id_score_filter_compute_stats (num_proc=4):  82%|##################9    | 27646/33548 [00:02<00:00, 13066.82 examples/s]language_id_score_filter_compute_stats (num_proc=4):  88%|####################3  | 29617/33548 [00:02<00:00, 14941.21 examples/s]language_id_score_filter_compute_stats (num_proc=4):  93%|#####################4 | 31339/33548 [00:02<00:00, 12229.19 examples/s]language_id_score_filter_compute_stats (num_proc=4):  97%|######################4| 32695/33548 [00:02<00:00, 11757.48 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|#######################| 33548/33548 [00:02<00:00, 11309.83 examples/s]
perplexity_filter_compute_stats (num_proc=4):   0%|                                             | 0/33548 [00:00<?, ? examples/s]perplexity_filter_compute_stats (num_proc=4):   0%|                                   | 38/33548 [00:00<01:38, 341.43 examples/s]perplexity_filter_compute_stats (num_proc=4):   2%|5                                | 567/33548 [00:00<00:10, 3120.38 examples/s]perplexity_filter_compute_stats (num_proc=4):   4%|#2                              | 1311/33548 [00:00<00:06, 5017.40 examples/s]perplexity_filter_compute_stats (num_proc=4):   6%|##                              | 2160/33548 [00:00<00:04, 6324.11 examples/s]perplexity_filter_compute_stats (num_proc=4):   9%|##7                             | 2893/33548 [00:00<00:04, 6674.42 examples/s]perplexity_filter_compute_stats (num_proc=4):  11%|###5                            | 3689/33548 [00:00<00:04, 7090.31 examples/s]perplexity_filter_compute_stats (num_proc=4):  14%|####4                           | 4645/33548 [00:00<00:03, 7852.10 examples/s]perplexity_filter_compute_stats (num_proc=4):  16%|#####2                          | 5499/33548 [00:00<00:03, 7629.85 examples/s]perplexity_filter_compute_stats (num_proc=4):  19%|######1                         | 6494/33548 [00:00<00:03, 8295.42 examples/s]perplexity_filter_compute_stats (num_proc=4):  22%|#######1                        | 7449/33548 [00:01<00:03, 8666.28 examples/s]perplexity_filter_compute_stats (num_proc=4):  25%|#######9                        | 8355/33548 [00:01<00:02, 8778.90 examples/s]perplexity_filter_compute_stats (num_proc=4):  28%|########8                       | 9298/33548 [00:01<00:02, 8323.61 examples/s]perplexity_filter_compute_stats (num_proc=4):  31%|#########4                     | 10249/33548 [00:01<00:02, 8653.41 examples/s]perplexity_filter_compute_stats (num_proc=4):  33%|##########3                    | 11223/33548 [00:01<00:02, 8825.14 examples/s]perplexity_filter_compute_stats (num_proc=4):  36%|###########2                   | 12141/33548 [00:01<00:02, 8511.44 examples/s]perplexity_filter_compute_stats (num_proc=4):  39%|############1                  | 13127/33548 [00:01<00:02, 8405.73 examples/s]perplexity_filter_compute_stats (num_proc=4):  42%|#############                  | 14128/33548 [00:01<00:02, 8839.52 examples/s]perplexity_filter_compute_stats (num_proc=4):  45%|#############9                 | 15148/33548 [00:01<00:01, 9214.66 examples/s]perplexity_filter_compute_stats (num_proc=4):  48%|##############8                | 16123/33548 [00:02<00:01, 8949.91 examples/s]perplexity_filter_compute_stats (num_proc=4):  51%|###############8               | 17099/33548 [00:02<00:01, 9165.69 examples/s]perplexity_filter_compute_stats (num_proc=4):  54%|################8              | 18191/33548 [00:02<00:01, 9652.62 examples/s]perplexity_filter_compute_stats (num_proc=4):  57%|#################2            | 19290/33548 [00:02<00:01, 10021.75 examples/s]perplexity_filter_compute_stats (num_proc=4):  61%|##################8            | 20367/33548 [00:02<00:01, 9780.53 examples/s]perplexity_filter_compute_stats (num_proc=4):  64%|###################7           | 21425/33548 [00:02<00:01, 9996.68 examples/s]perplexity_filter_compute_stats (num_proc=4):  67%|####################          | 22441/33548 [00:02<00:01, 10036.76 examples/s]perplexity_filter_compute_stats (num_proc=4):  70%|#####################6         | 23466/33548 [00:02<00:01, 8846.15 examples/s]perplexity_filter_compute_stats (num_proc=4):  73%|######################5        | 24384/33548 [00:02<00:01, 8897.67 examples/s]perplexity_filter_compute_stats (num_proc=4):  76%|#######################5       | 25432/33548 [00:03<00:00, 8905.99 examples/s]perplexity_filter_compute_stats (num_proc=4):  79%|########################4      | 26458/33548 [00:03<00:00, 9272.12 examples/s]perplexity_filter_compute_stats (num_proc=4):  82%|#########################3     | 27473/33548 [00:03<00:00, 9099.91 examples/s]perplexity_filter_compute_stats (num_proc=4):  85%|##########################4    | 28584/33548 [00:03<00:00, 9559.70 examples/s]perplexity_filter_compute_stats (num_proc=4):  88%|###########################3   | 29623/33548 [00:03<00:00, 9301.29 examples/s]perplexity_filter_compute_stats (num_proc=4):  91%|############################2  | 30612/33548 [00:03<00:00, 9052.32 examples/s]perplexity_filter_compute_stats (num_proc=4):  94%|#############################2 | 31627/33548 [00:03<00:00, 8426.92 examples/s]perplexity_filter_compute_stats (num_proc=4):  97%|##############################1| 32629/33548 [00:03<00:00, 6857.99 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|##############################9| 33487/33548 [00:04<00:00, 4898.13 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|###############################| 33548/33548 [00:04<00:00, 7713.67 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/33548 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|3                               | 353/33548 [00:00<00:10, 3154.40 examples/s]text_length_filter_compute_stats (num_proc=4):  10%|###1                          | 3517/33548 [00:00<00:01, 18166.19 examples/s]text_length_filter_compute_stats (num_proc=4):  19%|#####7                        | 6440/33548 [00:00<00:01, 21239.44 examples/s]text_length_filter_compute_stats (num_proc=4):  31%|########9                    | 10322/33548 [00:00<00:00, 26060.56 examples/s]text_length_filter_compute_stats (num_proc=4):  41%|###########9                 | 13822/33548 [00:00<00:00, 28737.44 examples/s]text_length_filter_compute_stats (num_proc=4):  54%|###############7             | 18189/33548 [00:00<00:00, 29739.43 examples/s]text_length_filter_compute_stats (num_proc=4):  65%|##################7          | 21678/33548 [00:00<00:00, 30186.93 examples/s]text_length_filter_compute_stats (num_proc=4):  76%|#####################9       | 25339/33548 [00:00<00:00, 31028.52 examples/s]text_length_filter_compute_stats (num_proc=4):  86%|########################8    | 28711/33548 [00:01<00:00, 20869.10 examples/s]text_length_filter_compute_stats (num_proc=4):  94%|###########################1 | 31387/33548 [00:01<00:00, 20510.57 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 33548/33548 [00:01<00:00, 19920.32 examples/s]
alphanumeric_filter_compute_stats (num_proc=4):   0%|                                           | 0/33548 [00:00<?, ? examples/s]alphanumeric_filter_compute_stats (num_proc=4):   1%|2                              | 243/33548 [00:00<00:14, 2330.29 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   7%|##                           | 2362/33548 [00:00<00:02, 13069.52 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  11%|###2                         | 3795/33548 [00:00<00:02, 13267.75 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  17%|####8                        | 5613/33548 [00:00<00:01, 14015.81 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  22%|######4                      | 7448/33548 [00:00<00:01, 15467.16 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  28%|########                     | 9267/33548 [00:00<00:01, 16031.83 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  33%|#########2                  | 11056/33548 [00:00<00:01, 15656.89 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  38%|##########6                 | 12745/33548 [00:00<00:01, 15999.22 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  44%|############2               | 14621/33548 [00:00<00:01, 15672.97 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  49%|#############6              | 16409/33548 [00:01<00:01, 16295.42 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  55%|###############2            | 18299/33548 [00:01<00:00, 16365.72 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  61%|################9           | 20303/33548 [00:01<00:00, 17404.29 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  66%|##################4         | 22067/33548 [00:01<00:00, 15508.32 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  71%|###################8        | 23841/33548 [00:01<00:00, 15389.31 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  76%|#####################2      | 25492/33548 [00:01<00:00, 15649.06 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  82%|######################8     | 27395/33548 [00:01<00:00, 16112.15 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  87%|########################3   | 29177/33548 [00:01<00:00, 16007.07 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  92%|#########################7  | 30836/33548 [00:02<00:00, 13541.07 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  97%|########################### | 32416/33548 [00:02<00:00, 12105.64 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|############################| 33548/33548 [00:02<00:00, 13223.34 examples/s]
character_repetition_filter_compute_stats (num_proc=4):   0%|                                   | 0/33548 [00:00<?, ? examples/s]character_repetition_filter_compute_stats (num_proc=4):   0%|                         | 46/33548 [00:00<01:17, 430.17 examples/s]character_repetition_filter_compute_stats (num_proc=4):   2%|3                      | 580/33548 [00:00<00:10, 3226.19 examples/s]character_repetition_filter_compute_stats (num_proc=4):   3%|7                     | 1122/33548 [00:00<00:07, 4194.61 examples/s]character_repetition_filter_compute_stats (num_proc=4):   5%|#1                    | 1682/33548 [00:00<00:06, 4712.27 examples/s]character_repetition_filter_compute_stats (num_proc=4):   7%|#4                    | 2266/33548 [00:00<00:06, 5088.11 examples/s]character_repetition_filter_compute_stats (num_proc=4):   9%|#8                    | 2888/33548 [00:00<00:05, 5455.87 examples/s]character_repetition_filter_compute_stats (num_proc=4):  10%|##2                   | 3472/33548 [00:00<00:05, 5578.39 examples/s]character_repetition_filter_compute_stats (num_proc=4):  12%|##6                   | 4072/33548 [00:00<00:05, 5373.84 examples/s]character_repetition_filter_compute_stats (num_proc=4):  14%|###                   | 4639/33548 [00:00<00:05, 5062.99 examples/s]character_repetition_filter_compute_stats (num_proc=4):  16%|###4                  | 5230/33548 [00:01<00:05, 5290.10 examples/s]character_repetition_filter_compute_stats (num_proc=4):  17%|###8                  | 5796/33548 [00:01<00:05, 5372.04 examples/s]character_repetition_filter_compute_stats (num_proc=4):  19%|####1                 | 6381/33548 [00:01<00:04, 5501.81 examples/s]character_repetition_filter_compute_stats (num_proc=4):  21%|####5                 | 6969/33548 [00:01<00:04, 5585.30 examples/s]character_repetition_filter_compute_stats (num_proc=4):  23%|####9                 | 7623/33548 [00:01<00:04, 5269.67 examples/s]character_repetition_filter_compute_stats (num_proc=4):  24%|#####3                | 8216/33548 [00:01<00:04, 5434.71 examples/s]character_repetition_filter_compute_stats (num_proc=4):  26%|#####7                | 8838/33548 [00:01<00:04, 5564.87 examples/s]character_repetition_filter_compute_stats (num_proc=4):  28%|######1               | 9424/33548 [00:01<00:04, 5638.43 examples/s]character_repetition_filter_compute_stats (num_proc=4):  30%|######2              | 10029/33548 [00:01<00:04, 5745.11 examples/s]character_repetition_filter_compute_stats (num_proc=4):  32%|######6              | 10609/33548 [00:02<00:04, 5404.08 examples/s]character_repetition_filter_compute_stats (num_proc=4):  33%|#######              | 11186/33548 [00:02<00:04, 5481.62 examples/s]character_repetition_filter_compute_stats (num_proc=4):  35%|#######3             | 11804/33548 [00:02<00:03, 5667.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  37%|#######7             | 12422/33548 [00:02<00:03, 5800.14 examples/s]character_repetition_filter_compute_stats (num_proc=4):  39%|########1            | 13040/33548 [00:02<00:03, 5715.89 examples/s]character_repetition_filter_compute_stats (num_proc=4):  41%|########5            | 13671/33548 [00:02<00:03, 5636.29 examples/s]character_repetition_filter_compute_stats (num_proc=4):  43%|########9            | 14302/33548 [00:02<00:03, 5570.17 examples/s]character_repetition_filter_compute_stats (num_proc=4):  44%|#########3           | 14873/33548 [00:02<00:03, 5601.97 examples/s]character_repetition_filter_compute_stats (num_proc=4):  46%|#########6           | 15447/33548 [00:02<00:03, 5627.10 examples/s]character_repetition_filter_compute_stats (num_proc=4):  48%|##########           | 16011/33548 [00:02<00:03, 5622.18 examples/s]character_repetition_filter_compute_stats (num_proc=4):  49%|##########3          | 16584/33548 [00:03<00:03, 5645.02 examples/s]character_repetition_filter_compute_stats (num_proc=4):  51%|##########7          | 17189/33548 [00:03<00:02, 5695.37 examples/s]character_repetition_filter_compute_stats (num_proc=4):  53%|###########1         | 17864/33548 [00:03<00:02, 5982.07 examples/s]character_repetition_filter_compute_stats (num_proc=4):  55%|###########5         | 18520/33548 [00:03<00:02, 6137.82 examples/s]character_repetition_filter_compute_stats (num_proc=4):  57%|############         | 19200/33548 [00:03<00:02, 6306.43 examples/s]character_repetition_filter_compute_stats (num_proc=4):  59%|############4        | 19875/33548 [00:03<00:02, 6123.68 examples/s]character_repetition_filter_compute_stats (num_proc=4):  61%|############8        | 20591/33548 [00:03<00:02, 5762.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  63%|#############3       | 21252/33548 [00:03<00:02, 5983.50 examples/s]character_repetition_filter_compute_stats (num_proc=4):  65%|#############7       | 21904/33548 [00:03<00:01, 5913.62 examples/s]character_repetition_filter_compute_stats (num_proc=4):  67%|##############       | 22504/33548 [00:04<00:01, 5912.47 examples/s]character_repetition_filter_compute_stats (num_proc=4):  69%|##############5      | 23185/33548 [00:04<00:01, 6153.30 examples/s]character_repetition_filter_compute_stats (num_proc=4):  71%|##############9      | 23941/33548 [00:04<00:01, 6545.11 examples/s]character_repetition_filter_compute_stats (num_proc=4):  73%|###############4     | 24640/33548 [00:04<00:01, 6669.83 examples/s]character_repetition_filter_compute_stats (num_proc=4):  75%|###############8     | 25312/33548 [00:04<00:01, 6530.19 examples/s]character_repetition_filter_compute_stats (num_proc=4):  77%|################2    | 25999/33548 [00:04<00:01, 6280.24 examples/s]character_repetition_filter_compute_stats (num_proc=4):  80%|################7    | 26697/33548 [00:04<00:01, 5667.26 examples/s]character_repetition_filter_compute_stats (num_proc=4):  81%|#################1   | 27325/33548 [00:04<00:01, 5332.30 examples/s]character_repetition_filter_compute_stats (num_proc=4):  83%|#################4   | 27945/33548 [00:05<00:01, 4822.21 examples/s]character_repetition_filter_compute_stats (num_proc=4):  85%|#################8   | 28451/33548 [00:05<00:01, 4484.82 examples/s]character_repetition_filter_compute_stats (num_proc=4):  86%|##################1  | 28957/33548 [00:05<00:01, 4537.78 examples/s]character_repetition_filter_compute_stats (num_proc=4):  88%|##################4  | 29442/33548 [00:05<00:00, 4530.85 examples/s]character_repetition_filter_compute_stats (num_proc=4):  89%|##################7  | 29938/33548 [00:05<00:00, 4288.63 examples/s]character_repetition_filter_compute_stats (num_proc=4):  91%|###################  | 30377/33548 [00:05<00:00, 4242.85 examples/s]character_repetition_filter_compute_stats (num_proc=4):  92%|###################3 | 30861/33548 [00:05<00:00, 4391.91 examples/s]character_repetition_filter_compute_stats (num_proc=4):  94%|###################6 | 31372/33548 [00:05<00:00, 4574.57 examples/s]character_repetition_filter_compute_stats (num_proc=4):  95%|###################9 | 31889/33548 [00:05<00:00, 4383.57 examples/s]character_repetition_filter_compute_stats (num_proc=4):  97%|####################2| 32381/33548 [00:06<00:00, 4520.53 examples/s]character_repetition_filter_compute_stats (num_proc=4):  98%|####################5| 32871/33548 [00:06<00:00, 4220.62 examples/s]character_repetition_filter_compute_stats (num_proc=4):  99%|####################8| 33371/33548 [00:06<00:00, 4057.89 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|#####################| 33548/33548 [00:06<00:00, 5126.99 examples/s]
word_repetition_filter_compute_stats (num_proc=4):   0%|                                        | 0/33548 [00:00<?, ? examples/s]word_repetition_filter_compute_stats (num_proc=4):   0%|                              | 92/33548 [00:00<00:38, 878.13 examples/s]word_repetition_filter_compute_stats (num_proc=4):   4%|9                          | 1224/33548 [00:00<00:04, 6585.36 examples/s]word_repetition_filter_compute_stats (num_proc=4):   7%|#7                         | 2194/33548 [00:00<00:03, 7934.47 examples/s]word_repetition_filter_compute_stats (num_proc=4):   9%|##5                        | 3116/33548 [00:00<00:03, 8415.13 examples/s]word_repetition_filter_compute_stats (num_proc=4):  12%|###2                       | 4037/33548 [00:00<00:03, 8107.72 examples/s]word_repetition_filter_compute_stats (num_proc=4):  15%|###9                       | 4896/33548 [00:00<00:03, 7711.36 examples/s]word_repetition_filter_compute_stats (num_proc=4):  17%|####6                      | 5836/33548 [00:00<00:03, 8208.68 examples/s]word_repetition_filter_compute_stats (num_proc=4):  20%|#####4                     | 6729/33548 [00:00<00:03, 8278.37 examples/s]word_repetition_filter_compute_stats (num_proc=4):  23%|######1                    | 7644/33548 [00:00<00:03, 8029.34 examples/s]word_repetition_filter_compute_stats (num_proc=4):  25%|######8                    | 8458/33548 [00:01<00:03, 8057.09 examples/s]word_repetition_filter_compute_stats (num_proc=4):  28%|#######5                   | 9364/33548 [00:01<00:02, 8196.27 examples/s]word_repetition_filter_compute_stats (num_proc=4):  31%|#######9                  | 10280/33548 [00:01<00:02, 8114.69 examples/s]word_repetition_filter_compute_stats (num_proc=4):  33%|########6                 | 11151/33548 [00:01<00:02, 8274.93 examples/s]word_repetition_filter_compute_stats (num_proc=4):  36%|#########3                | 12111/33548 [00:01<00:02, 8532.41 examples/s]word_repetition_filter_compute_stats (num_proc=4):  39%|##########1               | 13054/33548 [00:01<00:02, 8096.44 examples/s]word_repetition_filter_compute_stats (num_proc=4):  41%|##########7               | 13880/33548 [00:01<00:02, 8133.19 examples/s]word_repetition_filter_compute_stats (num_proc=4):  44%|###########4              | 14737/33548 [00:01<00:02, 8250.06 examples/s]word_repetition_filter_compute_stats (num_proc=4):  47%|############1             | 15658/33548 [00:01<00:02, 8512.21 examples/s]word_repetition_filter_compute_stats (num_proc=4):  49%|############8             | 16570/33548 [00:02<00:02, 8191.81 examples/s]word_repetition_filter_compute_stats (num_proc=4):  52%|#############5            | 17460/33548 [00:02<00:01, 8089.42 examples/s]word_repetition_filter_compute_stats (num_proc=4):  55%|##############2           | 18340/33548 [00:02<00:01, 8272.77 examples/s]word_repetition_filter_compute_stats (num_proc=4):  57%|##############9           | 19234/33548 [00:02<00:01, 8305.76 examples/s]word_repetition_filter_compute_stats (num_proc=4):  60%|###############5          | 20120/33548 [00:02<00:01, 8246.45 examples/s]word_repetition_filter_compute_stats (num_proc=4):  63%|################2         | 20989/33548 [00:02<00:01, 7094.21 examples/s]word_repetition_filter_compute_stats (num_proc=4):  65%|################9         | 21843/33548 [00:02<00:01, 7453.57 examples/s]word_repetition_filter_compute_stats (num_proc=4):  68%|#################5        | 22682/33548 [00:02<00:01, 7697.78 examples/s]word_repetition_filter_compute_stats (num_proc=4):  70%|##################3       | 23631/33548 [00:02<00:01, 8185.63 examples/s]word_repetition_filter_compute_stats (num_proc=4):  73%|###################       | 24535/33548 [00:03<00:01, 8337.06 examples/s]word_repetition_filter_compute_stats (num_proc=4):  77%|###################9      | 25766/33548 [00:03<00:00, 9288.26 examples/s]word_repetition_filter_compute_stats (num_proc=4):  80%|####################7     | 26712/33548 [00:03<00:00, 9323.65 examples/s]word_repetition_filter_compute_stats (num_proc=4):  83%|#####################4    | 27683/33548 [00:03<00:00, 9401.92 examples/s]word_repetition_filter_compute_stats (num_proc=4):  86%|######################3   | 28784/33548 [00:03<00:00, 9124.85 examples/s]word_repetition_filter_compute_stats (num_proc=4):  89%|#######################1  | 29820/33548 [00:03<00:00, 8309.43 examples/s]word_repetition_filter_compute_stats (num_proc=4):  92%|#######################8  | 30799/33548 [00:03<00:00, 7939.05 examples/s]word_repetition_filter_compute_stats (num_proc=4):  94%|########################5 | 31682/33548 [00:03<00:00, 8156.39 examples/s]word_repetition_filter_compute_stats (num_proc=4):  97%|#########################2| 32570/33548 [00:03<00:00, 8110.48 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|#########################9| 33447/33548 [00:04<00:00, 6756.27 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|##########################| 33548/33548 [00:04<00:00, 7773.74 examples/s]
2024-01-21 11:58:13.136 | INFO     | data_juicer.core.analyser:run:110 - Exporting dataset to disk...
2024-01-21 11:58:13.138 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                    | 0/34 [00:00<?, ?ba/s]Creating json from Arrow format:  44%|#########################5                                | 15/34 [00:00<00:00, 142.81ba/s]Creating json from Arrow format:  88%|###################################################1      | 30/34 [00:00<00:00, 144.51ba/s]Creating json from Arrow format: 100%|##########################################################| 34/34 [00:00<00:00, 144.94ba/s]
2024-01-21 11:58:13.381 | INFO     | data_juicer.core.analyser:run:122 - Applying overall analysis on stats...
  0%|                                                                                                      | 0/7 [00:00<?, ?it/s]100%|###########################################################################################| 7/7 [00:00<00:00, 21183.35it/s]
2024-01-21 11:58:14.521 | INFO     | data_juicer.core.analyser:run:127 - The overall analysis results are:        alnum_ratio char_rep_ratio     lang lang_score  perplexity    text_len word_rep_ratio
count      33548.0        33548.0  33548.0    33548.0     33548.0     33548.0        33548.0
mean      0.786882        0.07945      NaN   0.840601  782.572189  547.914123       0.007491
std       0.060554       0.039177      NaN   0.170038  894.072809  271.675659       0.046924
min       0.411832            0.0      NaN   0.047709        21.2        41.0            0.0
25%       0.785366       0.058968      NaN   0.785361       254.9       354.0            0.0
50%       0.806536       0.081633      NaN   0.913745       429.8       482.0            0.0
75%       0.819672        0.10491      NaN   0.954893       967.2       710.0            0.0
max       0.875912       0.261905      NaN    0.99934     17456.2      2263.0       0.857143
unique         NaN            NaN      5.0        NaN         NaN         NaN            NaN
top            NaN            NaN       en        NaN         NaN         NaN            NaN
freq           NaN            NaN  33403.0        NaN         NaN         NaN            NaN
2024-01-21 11:58:14.521 | INFO     | data_juicer.core.analyser:run:129 - Applying column-wise analysis on stats...
Column:   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Column:  14%|############2                                                                         | 1/7 [00:00<00:05,  1.03it/s]Column:  29%|########################5                                                             | 2/7 [00:01<00:04,  1.07it/s]Column:  43%|####################################8                                                 | 3/7 [00:02<00:03,  1.20it/s]Column:  57%|#################################################1                                    | 4/7 [00:03<00:02,  1.28it/s]Column:  71%|#############################################################4                        | 5/7 [00:04<00:01,  1.31it/s]Column:  86%|#########################################################################7            | 6/7 [00:04<00:00,  1.34it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.36it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.28it/s]
