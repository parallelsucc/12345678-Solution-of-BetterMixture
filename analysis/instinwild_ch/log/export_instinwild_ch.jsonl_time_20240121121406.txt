2024-01-21 12:14:06.678 | INFO     | data_juicer.config.config:config_backup:505 - Back up the input config file [/root/autodl-tmp/dj_mixture_challenge/./config/instinwild_ch.yaml] into the work_dir [/root/autodl-tmp/dj_mixture_challenge/output/analysis/instinwild_ch]
2024-01-21 12:14:06.694 | INFO     | data_juicer.config.config:display_config:526 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                    │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(./config/instinwild_ch.yaml, cwd=/root/autodl-tmp/dj_mixture_challenge)]         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ path_3sigma_recipe     │ None                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'instinwild_ch'                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '/root/autodl-tmp/dj_mixture_challenge/input/instinwild_ch.jsonl'                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/instinwild_ch/instinwild_ch.jsonl' │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds   │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds  │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ '/root/.cache/huggingface/datasets'                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'text_length_filter': {'image_key': 'images',                                           │
│                        │                          'max_len': 4096,                                                 │
│                        │                          'min_len': 1,                                                    │
│                        │                          'text_key': 'text'}},                                            │
│                        │  {'language_id_score_filter': {'image_key': 'images',                                     │
│                        │                                'lang': 'zh',                                              │
│                        │                                'min_score': 0.8,                                          │
│                        │                                'text_key': 'text'}},                                      │
│                        │  {'perplexity_filter': {'image_key': 'images',                                            │
│                        │                         'lang': 'zh',                                                     │
│                        │                         'max_ppl': 1500,                                                  │
│                        │                         'text_key': 'text'}},                                             │
│                        │  {'text_length_filter': {'image_key': 'images',                                           │
│                        │                          'max_len': 10000,                                                │
│                        │                          'min_len': 1.0,                                                  │
│                        │                          'text_key': 'text'}},                                            │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                          │
│                        │                           'max_ratio': 1.0,                                               │
│                        │                           'min_ratio': 0.8,                                               │
│                        │                           'text_key': 'text',                                             │
│                        │                           'tokenization': False}},                                        │
│                        │  {'character_repetition_filter': {'image_key': 'images',                                  │
│                        │                                   'max_ratio': 0.3,                                       │
│                        │                                   'min_ratio': 0.0,                                       │
│                        │                                   'rep_len': 10,                                          │
│                        │                                   'text_key': 'text'}},                                   │
│                        │  {'word_repetition_filter': {'image_key': 'images',                                       │
│                        │                              'lang': 'zh',                                                │
│                        │                              'max_ratio': 0.5,                                            │
│                        │                              'min_ratio': 0.0,                                            │
│                        │                              'rep_len': 10,                                               │
│                        │                              'text_key': 'text',                                          │
│                        │                              'tokenization': False}}]                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '/root/autodl-tmp/dj_mixture_challenge/output/analysis/instinwild_ch'                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20240121121406'                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/root/autodl-tmp/dj_mixture_challenge/input'                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                     │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════╛
2024-01-21 12:14:06.696 | INFO     | data_juicer.core.analyser:__init__:39 - Using cache compression method: [None]
2024-01-21 12:14:06.696 | INFO     | data_juicer.core.analyser:__init__:44 - Setting up data formatter...
2024-01-21 12:14:06.697 | INFO     | data_juicer.core.analyser:__init__:53 - Preparing exporter...
2024-01-21 12:14:06.697 | INFO     | data_juicer.core.analyser:run:75 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 15656 examples [00:00, 103255.45 examples/s]Generating jsonl split: 30513 examples [00:00, 116255.05 examples/s]Generating jsonl split: 45492 examples [00:00, 124453.27 examples/s]Generating jsonl split: 51504 examples [00:00, 120974.90 examples/s]
2024-01-21 12:14:08.155 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-01-21 12:14:08.156 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 51504 sample(s) in the original dataset.
Filter (num_proc=4):   0%|                                                                      | 0/51504 [00:00<?, ? examples/s]Filter (num_proc=4):   2%|#1                                                       | 1000/51504 [00:00<00:07, 7137.26 examples/s]Filter (num_proc=4):  17%|#########7                                              | 9000/51504 [00:00<00:01, 40841.95 examples/s]Filter (num_proc=4):  33%|##################1                                    | 17000/51504 [00:00<00:00, 55990.78 examples/s]Filter (num_proc=4):  50%|###########################7                           | 26000/51504 [00:00<00:00, 62820.44 examples/s]Filter (num_proc=4):  66%|####################################3                  | 34000/51504 [00:00<00:00, 65375.40 examples/s]Filter (num_proc=4):  82%|############################################8          | 42000/51504 [00:00<00:00, 67186.42 examples/s]Filter (num_proc=4):  97%|#####################################################1 | 49752/51504 [00:00<00:00, 68830.73 examples/s]Filter (num_proc=4): 100%|#######################################################| 51504/51504 [00:00<00:00, 57068.62 examples/s]
2024-01-21 12:14:09.191 | INFO     | data_juicer.format.formatter:unify_format:214 - 51504 samples left after filtering empty text.
2024-01-21 12:14:09.192 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 51504 from 51504
2024-01-21 12:14:09.196 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 51504 in final dataset
2024-01-21 12:14:09.196 | INFO     | data_juicer.core.analyser:run:81 - Preparing process operators...
2024-01-21 12:14:09.197 | INFO     | data_juicer.utils.model_utils:prepare_fasttext_model:87 - Loading fasttext language identification model...
Warning : `load_model` does not return WordVectorModel or SupervisedModel any more, but a `FastText` object which is very similar.
2024-01-21 12:14:09.405 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2024-01-21 12:14:09.498 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2024-01-21 12:14:09.723 | INFO     | data_juicer.core.analyser:run:86 - Computing the stats of dataset...
Adding new column for stats (num_proc=4):   0%|                                                 | 0/51504 [00:00<?, ? examples/s]Adding new column for stats (num_proc=4):   1%|3                                    | 440/51504 [00:00<00:12, 4037.58 examples/s]Adding new column for stats (num_proc=4):   7%|##4                                | 3659/51504 [00:00<00:02, 18680.40 examples/s]Adding new column for stats (num_proc=4):  13%|####5                              | 6747/51504 [00:00<00:01, 22980.31 examples/s]Adding new column for stats (num_proc=4):  18%|######3                            | 9413/51504 [00:00<00:01, 23527.43 examples/s]Adding new column for stats (num_proc=4):  23%|#######9                          | 11988/51504 [00:00<00:01, 24208.45 examples/s]Adding new column for stats (num_proc=4):  30%|##########1                       | 15335/51504 [00:00<00:01, 27047.56 examples/s]Adding new column for stats (num_proc=4):  35%|############                      | 18256/51504 [00:00<00:01, 25959.98 examples/s]Adding new column for stats (num_proc=4):  41%|#############8                    | 20936/51504 [00:01<00:02, 14379.88 examples/s]Adding new column for stats (num_proc=4):  46%|###############6                  | 23774/51504 [00:01<00:01, 16929.22 examples/s]Adding new column for stats (num_proc=4):  53%|#################9                | 27262/51504 [00:01<00:01, 20664.04 examples/s]Adding new column for stats (num_proc=4):  58%|###################7              | 29899/51504 [00:01<00:00, 21730.22 examples/s]Adding new column for stats (num_proc=4):  63%|#####################4            | 32507/51504 [00:01<00:00, 21445.57 examples/s]Adding new column for stats (num_proc=4):  69%|#######################6          | 35774/51504 [00:01<00:00, 24080.55 examples/s]Adding new column for stats (num_proc=4):  75%|#########################6        | 38818/51504 [00:01<00:00, 24150.12 examples/s]Adding new column for stats (num_proc=4):  80%|###########################3      | 41412/51504 [00:01<00:00, 24339.61 examples/s]Adding new column for stats (num_proc=4):  85%|#############################     | 43998/51504 [00:02<00:00, 24677.58 examples/s]Adding new column for stats (num_proc=4):  91%|###############################   | 47053/51504 [00:02<00:00, 25514.80 examples/s]Adding new column for stats (num_proc=4):  97%|################################9 | 49949/51504 [00:02<00:00, 26175.88 examples/s]Adding new column for stats (num_proc=4): 100%|##################################| 51504/51504 [00:02<00:00, 21520.40 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/51504 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|3                               | 537/51504 [00:00<00:10, 5052.26 examples/s]text_length_filter_compute_stats (num_proc=4):   7%|##                            | 3544/51504 [00:00<00:02, 17010.53 examples/s]text_length_filter_compute_stats (num_proc=4):  14%|####3                         | 7441/51504 [00:00<00:01, 25483.86 examples/s]text_length_filter_compute_stats (num_proc=4):  20%|#####9                       | 10518/51504 [00:00<00:01, 27286.62 examples/s]text_length_filter_compute_stats (num_proc=4):  26%|#######6                     | 13591/51504 [00:00<00:01, 28391.55 examples/s]text_length_filter_compute_stats (num_proc=4):  33%|#########5                   | 16895/51504 [00:00<00:01, 28608.32 examples/s]text_length_filter_compute_stats (num_proc=4):  39%|###########2                 | 19968/51504 [00:00<00:01, 27894.31 examples/s]text_length_filter_compute_stats (num_proc=4):  45%|#############                | 23136/51504 [00:00<00:01, 28097.87 examples/s]text_length_filter_compute_stats (num_proc=4):  52%|##############9              | 26636/51504 [00:00<00:00, 30098.64 examples/s]text_length_filter_compute_stats (num_proc=4):  59%|#################1           | 30463/51504 [00:01<00:00, 31633.33 examples/s]text_length_filter_compute_stats (num_proc=4):  66%|###################1         | 34003/51504 [00:01<00:00, 23104.18 examples/s]text_length_filter_compute_stats (num_proc=4):  72%|####################9        | 37223/51504 [00:01<00:00, 21885.92 examples/s]text_length_filter_compute_stats (num_proc=4):  78%|######################4      | 39949/51504 [00:01<00:00, 21819.33 examples/s]text_length_filter_compute_stats (num_proc=4):  83%|#######################9     | 42493/51504 [00:01<00:00, 22336.21 examples/s]text_length_filter_compute_stats (num_proc=4):  88%|#########################5   | 45461/51504 [00:01<00:00, 23840.88 examples/s]text_length_filter_compute_stats (num_proc=4):  94%|###########################2 | 48343/51504 [00:02<00:00, 21201.60 examples/s]text_length_filter_compute_stats (num_proc=4):  98%|############################5| 50724/51504 [00:02<00:00, 18684.28 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 51504/51504 [00:02<00:00, 22109.61 examples/s]
language_id_score_filter_compute_stats (num_proc=4):   0%|                                      | 0/51504 [00:00<?, ? examples/s]language_id_score_filter_compute_stats (num_proc=4):   0%|                          | 164/51504 [00:00<00:33, 1546.12 examples/s]language_id_score_filter_compute_stats (num_proc=4):   3%|8                        | 1732/51504 [00:00<00:05, 9292.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):   6%|#4                      | 3097/51504 [00:00<00:04, 11192.04 examples/s]language_id_score_filter_compute_stats (num_proc=4):   8%|##1                      | 4330/51504 [00:00<00:05, 8754.52 examples/s]language_id_score_filter_compute_stats (num_proc=4):  11%|##7                     | 5917/51504 [00:00<00:04, 10705.17 examples/s]language_id_score_filter_compute_stats (num_proc=4):  14%|###4                    | 7325/51504 [00:00<00:03, 11679.37 examples/s]language_id_score_filter_compute_stats (num_proc=4):  17%|####                    | 8634/51504 [00:00<00:03, 11646.72 examples/s]language_id_score_filter_compute_stats (num_proc=4):  19%|####6                   | 9977/51504 [00:00<00:03, 11554.58 examples/s]language_id_score_filter_compute_stats (num_proc=4):  22%|#####1                 | 11476/51504 [00:01<00:03, 12512.62 examples/s]language_id_score_filter_compute_stats (num_proc=4):  25%|#####7                 | 12776/51504 [00:01<00:03, 11170.46 examples/s]language_id_score_filter_compute_stats (num_proc=4):  28%|######5                | 14613/51504 [00:01<00:02, 12400.33 examples/s]language_id_score_filter_compute_stats (num_proc=4):  31%|#######2               | 16170/51504 [00:01<00:02, 13230.13 examples/s]language_id_score_filter_compute_stats (num_proc=4):  34%|#######8               | 17585/51504 [00:01<00:03, 11106.08 examples/s]language_id_score_filter_compute_stats (num_proc=4):  37%|########5              | 19108/51504 [00:01<00:02, 12102.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):  40%|#########2             | 20628/51504 [00:01<00:02, 12892.23 examples/s]language_id_score_filter_compute_stats (num_proc=4):  43%|#########8             | 22073/51504 [00:01<00:02, 11576.94 examples/s]language_id_score_filter_compute_stats (num_proc=4):  46%|##########6            | 23742/51504 [00:02<00:02, 12854.35 examples/s]language_id_score_filter_compute_stats (num_proc=4):  49%|###########3           | 25343/51504 [00:02<00:02, 11540.43 examples/s]language_id_score_filter_compute_stats (num_proc=4):  52%|###########9           | 26730/51504 [00:02<00:02, 11903.17 examples/s]language_id_score_filter_compute_stats (num_proc=4):  55%|############5          | 28101/51504 [00:02<00:01, 12136.31 examples/s]language_id_score_filter_compute_stats (num_proc=4):  57%|#############2         | 29599/51504 [00:02<00:01, 12743.77 examples/s]language_id_score_filter_compute_stats (num_proc=4):  60%|#############8         | 30915/51504 [00:02<00:01, 11327.34 examples/s]language_id_score_filter_compute_stats (num_proc=4):  63%|##############5        | 32680/51504 [00:02<00:01, 12909.65 examples/s]language_id_score_filter_compute_stats (num_proc=4):  66%|###############2       | 34147/51504 [00:02<00:01, 11450.82 examples/s]language_id_score_filter_compute_stats (num_proc=4):  69%|###############8       | 35451/51504 [00:03<00:01, 10536.39 examples/s]language_id_score_filter_compute_stats (num_proc=4):  71%|################3      | 36608/51504 [00:03<00:01, 10579.22 examples/s]language_id_score_filter_compute_stats (num_proc=4):  73%|################8      | 37826/51504 [00:03<00:01, 10117.08 examples/s]language_id_score_filter_compute_stats (num_proc=4):  76%|##################2     | 39086/51504 [00:03<00:01, 9599.04 examples/s]language_id_score_filter_compute_stats (num_proc=4):  79%|##################1    | 40698/51504 [00:03<00:00, 11083.16 examples/s]language_id_score_filter_compute_stats (num_proc=4):  81%|##################6    | 41861/51504 [00:03<00:00, 10629.70 examples/s]language_id_score_filter_compute_stats (num_proc=4):  85%|###################5   | 43736/51504 [00:03<00:00, 12701.19 examples/s]language_id_score_filter_compute_stats (num_proc=4):  88%|####################1  | 45200/51504 [00:03<00:00, 11039.29 examples/s]language_id_score_filter_compute_stats (num_proc=4):  92%|#####################  | 47128/51504 [00:04<00:00, 13033.01 examples/s]language_id_score_filter_compute_stats (num_proc=4):  94%|#####################7 | 48617/51504 [00:04<00:00, 13505.64 examples/s]language_id_score_filter_compute_stats (num_proc=4):  98%|######################4| 50275/51504 [00:04<00:00, 11399.14 examples/s]language_id_score_filter_compute_stats (num_proc=4): 100%|#######################| 51504/51504 [00:04<00:00, 10677.15 examples/s]
perplexity_filter_compute_stats (num_proc=4):   0%|                                             | 0/51504 [00:00<?, ? examples/s]perplexity_filter_compute_stats (num_proc=4):   0%|                                   | 47/51504 [00:00<01:57, 437.85 examples/s]perplexity_filter_compute_stats (num_proc=4):   1%|4                                | 751/51504 [00:00<00:12, 4020.63 examples/s]perplexity_filter_compute_stats (num_proc=4):   3%|#                               | 1721/51504 [00:00<00:07, 6500.64 examples/s]perplexity_filter_compute_stats (num_proc=4):   5%|#7                              | 2830/51504 [00:00<00:05, 8250.10 examples/s]perplexity_filter_compute_stats (num_proc=4):   8%|##4                             | 3988/51504 [00:00<00:05, 8243.26 examples/s]perplexity_filter_compute_stats (num_proc=4):  10%|###2                            | 5160/51504 [00:00<00:04, 9305.52 examples/s]perplexity_filter_compute_stats (num_proc=4):  13%|###9                           | 6492/51504 [00:00<00:04, 10516.84 examples/s]perplexity_filter_compute_stats (num_proc=4):  15%|####6                          | 7685/51504 [00:00<00:04, 10436.72 examples/s]perplexity_filter_compute_stats (num_proc=4):  17%|#####3                         | 8899/51504 [00:00<00:03, 10922.09 examples/s]perplexity_filter_compute_stats (num_proc=4):  20%|######                        | 10322/51504 [00:01<00:03, 11887.29 examples/s]perplexity_filter_compute_stats (num_proc=4):  23%|######7                       | 11634/51504 [00:01<00:03, 11638.23 examples/s]perplexity_filter_compute_stats (num_proc=4):  25%|#######4                      | 12860/51504 [00:01<00:03, 11806.93 examples/s]perplexity_filter_compute_stats (num_proc=4):  27%|########2                     | 14092/51504 [00:01<00:03, 11947.67 examples/s]perplexity_filter_compute_stats (num_proc=4):  30%|########9                     | 15365/51504 [00:01<00:03, 11324.72 examples/s]perplexity_filter_compute_stats (num_proc=4):  32%|#########7                    | 16667/51504 [00:01<00:02, 11787.10 examples/s]perplexity_filter_compute_stats (num_proc=4):  35%|##########4                   | 18013/51504 [00:01<00:02, 12245.96 examples/s]perplexity_filter_compute_stats (num_proc=4):  38%|###########2                  | 19365/51504 [00:01<00:02, 11403.05 examples/s]perplexity_filter_compute_stats (num_proc=4):  40%|############                  | 20632/51504 [00:01<00:02, 11740.87 examples/s]perplexity_filter_compute_stats (num_proc=4):  43%|############8                 | 21988/51504 [00:02<00:02, 12242.10 examples/s]perplexity_filter_compute_stats (num_proc=4):  45%|#############5                | 23329/51504 [00:02<00:02, 11724.03 examples/s]perplexity_filter_compute_stats (num_proc=4):  48%|##############3               | 24690/51504 [00:02<00:02, 12233.18 examples/s]perplexity_filter_compute_stats (num_proc=4):  51%|###############1              | 26068/51504 [00:02<00:02, 12664.58 examples/s]perplexity_filter_compute_stats (num_proc=4):  53%|################              | 27515/51504 [00:02<00:02, 11347.75 examples/s]perplexity_filter_compute_stats (num_proc=4):  56%|################7             | 28804/51504 [00:02<00:01, 11739.22 examples/s]perplexity_filter_compute_stats (num_proc=4):  58%|#################5            | 30046/51504 [00:02<00:01, 11673.15 examples/s]perplexity_filter_compute_stats (num_proc=4):  61%|##################2           | 31367/51504 [00:02<00:01, 11852.65 examples/s]perplexity_filter_compute_stats (num_proc=4):  63%|###################           | 32696/51504 [00:02<00:01, 11027.63 examples/s]perplexity_filter_compute_stats (num_proc=4):  66%|###################7          | 33889/51504 [00:03<00:01, 11218.22 examples/s]perplexity_filter_compute_stats (num_proc=4):  68%|####################4         | 35060/51504 [00:03<00:01, 11240.65 examples/s]perplexity_filter_compute_stats (num_proc=4):  70%|#####################         | 36221/51504 [00:03<00:01, 11045.32 examples/s]perplexity_filter_compute_stats (num_proc=4):  73%|#####################7        | 37419/51504 [00:03<00:01, 11034.94 examples/s]perplexity_filter_compute_stats (num_proc=4):  75%|#######################2       | 38632/51504 [00:03<00:01, 8842.88 examples/s]perplexity_filter_compute_stats (num_proc=4):  77%|#######################8       | 39619/51504 [00:03<00:01, 9064.51 examples/s]perplexity_filter_compute_stats (num_proc=4):  79%|########################6      | 40910/51504 [00:03<00:01, 9365.44 examples/s]perplexity_filter_compute_stats (num_proc=4):  81%|#########################2     | 41948/51504 [00:03<00:01, 9124.11 examples/s]perplexity_filter_compute_stats (num_proc=4):  83%|#########################8     | 42955/51504 [00:04<00:00, 9362.05 examples/s]perplexity_filter_compute_stats (num_proc=4):  86%|##########################5    | 44042/51504 [00:04<00:00, 9760.59 examples/s]perplexity_filter_compute_stats (num_proc=4):  88%|###########################2   | 45216/51504 [00:04<00:00, 9608.64 examples/s]perplexity_filter_compute_stats (num_proc=4):  90%|###########################8   | 46234/51504 [00:04<00:00, 9758.88 examples/s]perplexity_filter_compute_stats (num_proc=4):  92%|###########################6  | 47417/51504 [00:04<00:00, 10155.21 examples/s]perplexity_filter_compute_stats (num_proc=4):  94%|#############################2 | 48583/51504 [00:04<00:00, 9796.78 examples/s]perplexity_filter_compute_stats (num_proc=4):  96%|#############################8 | 49615/51504 [00:04<00:00, 7858.71 examples/s]perplexity_filter_compute_stats (num_proc=4):  98%|##############################4| 50558/51504 [00:05<00:00, 6900.70 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|##############################9| 51391/51504 [00:05<00:00, 4831.81 examples/s]perplexity_filter_compute_stats (num_proc=4): 100%|###############################| 51504/51504 [00:05<00:00, 9354.41 examples/s]
text_length_filter_compute_stats (num_proc=4):   0%|                                            | 0/51504 [00:00<?, ? examples/s]text_length_filter_compute_stats (num_proc=4):   1%|2                               | 419/51504 [00:00<00:13, 3924.63 examples/s]text_length_filter_compute_stats (num_proc=4):   8%|##2                           | 3883/51504 [00:00<00:02, 20820.06 examples/s]text_length_filter_compute_stats (num_proc=4):  14%|####1                         | 7182/51504 [00:00<00:01, 25529.32 examples/s]text_length_filter_compute_stats (num_proc=4):  19%|#####7                        | 9820/51504 [00:00<00:01, 25801.63 examples/s]text_length_filter_compute_stats (num_proc=4):  26%|#######4                     | 13284/51504 [00:00<00:01, 27152.15 examples/s]text_length_filter_compute_stats (num_proc=4):  33%|#########6                   | 17137/51504 [00:00<00:01, 28241.83 examples/s]text_length_filter_compute_stats (num_proc=4):  40%|###########6                 | 20635/51504 [00:00<00:01, 28935.03 examples/s]text_length_filter_compute_stats (num_proc=4):  47%|#############6               | 24255/51504 [00:00<00:00, 30863.15 examples/s]text_length_filter_compute_stats (num_proc=4):  54%|###############6             | 27804/51504 [00:01<00:00, 29693.08 examples/s]text_length_filter_compute_stats (num_proc=4):  60%|#################4           | 31056/51504 [00:01<00:00, 22860.82 examples/s]text_length_filter_compute_stats (num_proc=4):  66%|###################          | 33914/51504 [00:01<00:00, 22043.70 examples/s]text_length_filter_compute_stats (num_proc=4):  71%|####################5        | 36584/51504 [00:01<00:00, 20908.53 examples/s]text_length_filter_compute_stats (num_proc=4):  78%|######################4      | 39916/51504 [00:01<00:00, 23102.93 examples/s]text_length_filter_compute_stats (num_proc=4):  82%|#######################9     | 42488/51504 [00:01<00:00, 23617.18 examples/s]text_length_filter_compute_stats (num_proc=4):  88%|#########################5   | 45378/51504 [00:01<00:00, 24500.00 examples/s]text_length_filter_compute_stats (num_proc=4):  94%|###########################2 | 48408/51504 [00:02<00:00, 21378.53 examples/s]text_length_filter_compute_stats (num_proc=4):  99%|############################6| 50819/51504 [00:02<00:00, 19225.29 examples/s]text_length_filter_compute_stats (num_proc=4): 100%|#############################| 51504/51504 [00:02<00:00, 22036.35 examples/s]
alphanumeric_filter_compute_stats (num_proc=4):   0%|                                           | 0/51504 [00:00<?, ? examples/s]alphanumeric_filter_compute_stats (num_proc=4):   1%|3                              | 631/51504 [00:00<00:08, 5890.19 examples/s]alphanumeric_filter_compute_stats (num_proc=4):   6%|#8                           | 3294/51504 [00:00<00:03, 15880.15 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  11%|###3                         | 5882/51504 [00:00<00:02, 19449.70 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  16%|####5                        | 8020/51504 [00:00<00:02, 20143.47 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  21%|#####8                      | 10698/51504 [00:00<00:01, 21893.51 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  26%|#######1                    | 13135/51504 [00:00<00:01, 22690.14 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  30%|########5                   | 15671/51504 [00:00<00:01, 20454.65 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  36%|##########                  | 18478/51504 [00:00<00:01, 21719.22 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  42%|###########7                | 21576/51504 [00:01<00:01, 24205.21 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  47%|#############1              | 24171/51504 [00:01<00:01, 22724.94 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  52%|##############5             | 26710/51504 [00:01<00:01, 22588.27 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  58%|################1           | 29680/51504 [00:01<00:00, 23105.03 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  62%|#################4          | 32111/51504 [00:01<00:00, 21891.37 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  67%|##################8         | 34750/51504 [00:01<00:00, 22167.83 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  74%|####################7       | 38122/51504 [00:01<00:00, 24865.53 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  79%|######################2     | 40942/51504 [00:02<00:00, 15587.65 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  84%|#######################4    | 43162/51504 [00:02<00:00, 16308.58 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  89%|#########################   | 46075/51504 [00:02<00:00, 18970.44 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  94%|##########################3 | 48560/51504 [00:02<00:00, 19575.39 examples/s]alphanumeric_filter_compute_stats (num_proc=4):  99%|###########################7| 51024/51504 [00:02<00:00, 17798.08 examples/s]alphanumeric_filter_compute_stats (num_proc=4): 100%|############################| 51504/51504 [00:02<00:00, 18775.32 examples/s]
character_repetition_filter_compute_stats (num_proc=4):   0%|                                   | 0/51504 [00:00<?, ? examples/s]character_repetition_filter_compute_stats (num_proc=4):   0%|                       | 174/51504 [00:00<00:32, 1577.68 examples/s]character_repetition_filter_compute_stats (num_proc=4):   3%|6                     | 1594/51504 [00:00<00:05, 8500.75 examples/s]character_repetition_filter_compute_stats (num_proc=4):   6%|#1                   | 2924/51504 [00:00<00:04, 10585.25 examples/s]character_repetition_filter_compute_stats (num_proc=4):   8%|#7                   | 4183/51504 [00:00<00:04, 10153.33 examples/s]character_repetition_filter_compute_stats (num_proc=4):  11%|##2                  | 5537/51504 [00:00<00:04, 11260.39 examples/s]character_repetition_filter_compute_stats (num_proc=4):  14%|##8                  | 6965/51504 [00:00<00:03, 12142.67 examples/s]character_repetition_filter_compute_stats (num_proc=4):  16%|###3                 | 8305/51504 [00:00<00:03, 12081.85 examples/s]character_repetition_filter_compute_stats (num_proc=4):  18%|###8                 | 9528/51504 [00:00<00:03, 12076.86 examples/s]character_repetition_filter_compute_stats (num_proc=4):  21%|####2               | 10910/51504 [00:00<00:03, 12587.74 examples/s]character_repetition_filter_compute_stats (num_proc=4):  24%|####7               | 12226/51504 [00:01<00:03, 12505.88 examples/s]character_repetition_filter_compute_stats (num_proc=4):  27%|#####3              | 13695/51504 [00:01<00:02, 13144.32 examples/s]character_repetition_filter_compute_stats (num_proc=4):  29%|#####8              | 15051/51504 [00:01<00:02, 12439.49 examples/s]character_repetition_filter_compute_stats (num_proc=4):  32%|######3             | 16369/51504 [00:01<00:02, 12300.91 examples/s]character_repetition_filter_compute_stats (num_proc=4):  34%|######8             | 17610/51504 [00:01<00:02, 12316.08 examples/s]character_repetition_filter_compute_stats (num_proc=4):  37%|#######3            | 18878/51504 [00:01<00:02, 11985.94 examples/s]character_repetition_filter_compute_stats (num_proc=4):  39%|#######8            | 20163/51504 [00:01<00:02, 12214.75 examples/s]character_repetition_filter_compute_stats (num_proc=4):  42%|########3           | 21486/51504 [00:01<00:02, 12492.68 examples/s]character_repetition_filter_compute_stats (num_proc=4):  44%|########8           | 22806/51504 [00:01<00:02, 12579.41 examples/s]character_repetition_filter_compute_stats (num_proc=4):  47%|#########3          | 24178/51504 [00:02<00:02, 12909.60 examples/s]character_repetition_filter_compute_stats (num_proc=4):  50%|#########9          | 25546/51504 [00:02<00:02, 12752.54 examples/s]character_repetition_filter_compute_stats (num_proc=4):  52%|##########4         | 26870/51504 [00:02<00:01, 12882.27 examples/s]character_repetition_filter_compute_stats (num_proc=4):  55%|##########9         | 28170/51504 [00:02<00:01, 12804.87 examples/s]character_repetition_filter_compute_stats (num_proc=4):  58%|###########5        | 29702/51504 [00:02<00:01, 13532.12 examples/s]character_repetition_filter_compute_stats (num_proc=4):  61%|############1       | 31170/51504 [00:02<00:01, 13761.25 examples/s]character_repetition_filter_compute_stats (num_proc=4):  63%|############6       | 32629/51504 [00:02<00:01, 12865.17 examples/s]character_repetition_filter_compute_stats (num_proc=4):  66%|#############1      | 33942/51504 [00:02<00:01, 12599.29 examples/s]character_repetition_filter_compute_stats (num_proc=4):  69%|##############4      | 35374/51504 [00:02<00:01, 9987.65 examples/s]character_repetition_filter_compute_stats (num_proc=4):  71%|##############8      | 36515/51504 [00:03<00:01, 9253.74 examples/s]character_repetition_filter_compute_stats (num_proc=4):  73%|###############3     | 37714/51504 [00:03<00:01, 9277.72 examples/s]character_repetition_filter_compute_stats (num_proc=4):  75%|###############7     | 38712/51504 [00:03<00:01, 9373.77 examples/s]character_repetition_filter_compute_stats (num_proc=4):  78%|################3    | 40042/51504 [00:03<00:01, 9799.55 examples/s]character_repetition_filter_compute_stats (num_proc=4):  81%|################1   | 41490/51504 [00:03<00:00, 10977.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  83%|################5   | 42719/51504 [00:03<00:00, 11317.46 examples/s]character_repetition_filter_compute_stats (num_proc=4):  86%|#################1  | 44185/51504 [00:03<00:00, 12221.64 examples/s]character_repetition_filter_compute_stats (num_proc=4):  89%|#################7  | 45585/51504 [00:03<00:00, 12405.47 examples/s]character_repetition_filter_compute_stats (num_proc=4):  91%|##################2 | 46965/51504 [00:03<00:00, 12792.81 examples/s]character_repetition_filter_compute_stats (num_proc=4):  94%|##################7 | 48312/51504 [00:04<00:00, 12959.23 examples/s]character_repetition_filter_compute_stats (num_proc=4):  96%|###################2| 49676/51504 [00:04<00:00, 11748.52 examples/s]character_repetition_filter_compute_stats (num_proc=4):  99%|####################8| 51015/51504 [00:04<00:00, 9344.51 examples/s]character_repetition_filter_compute_stats (num_proc=4): 100%|####################| 51504/51504 [00:04<00:00, 10949.23 examples/s]
word_repetition_filter_compute_stats (num_proc=4):   0%|                                        | 0/51504 [00:00<?, ? examples/s]word_repetition_filter_compute_stats (num_proc=4):   1%|1                           | 314/51504 [00:00<00:18, 2810.82 examples/s]word_repetition_filter_compute_stats (num_proc=4):   6%|#6                        | 3228/51504 [00:00<00:02, 16772.53 examples/s]word_repetition_filter_compute_stats (num_proc=4):  10%|##6                       | 5171/51504 [00:00<00:03, 15156.36 examples/s]word_repetition_filter_compute_stats (num_proc=4):  15%|###8                      | 7664/51504 [00:00<00:02, 18473.34 examples/s]word_repetition_filter_compute_stats (num_proc=4):  20%|#####                    | 10458/51504 [00:00<00:02, 19363.25 examples/s]word_repetition_filter_compute_stats (num_proc=4):  25%|######3                  | 13049/51504 [00:00<00:01, 19822.39 examples/s]word_repetition_filter_compute_stats (num_proc=4):  30%|#######4                 | 15378/51504 [00:00<00:01, 20557.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  36%|########9                | 18441/51504 [00:00<00:01, 20844.16 examples/s]word_repetition_filter_compute_stats (num_proc=4):  41%|##########1              | 20999/51504 [00:01<00:01, 22097.15 examples/s]word_repetition_filter_compute_stats (num_proc=4):  46%|###########3             | 23443/51504 [00:01<00:01, 21093.05 examples/s]word_repetition_filter_compute_stats (num_proc=4):  50%|############5            | 25805/51504 [00:01<00:01, 21757.03 examples/s]word_repetition_filter_compute_stats (num_proc=4):  55%|#############6           | 28115/51504 [00:01<00:01, 22118.96 examples/s]word_repetition_filter_compute_stats (num_proc=4):  59%|##############8          | 30496/51504 [00:01<00:01, 20992.74 examples/s]word_repetition_filter_compute_stats (num_proc=4):  63%|###############8         | 32635/51504 [00:01<00:01, 13345.10 examples/s]word_repetition_filter_compute_stats (num_proc=4):  67%|################8        | 34707/51504 [00:01<00:01, 14787.24 examples/s]word_repetition_filter_compute_stats (num_proc=4):  72%|##################       | 37175/51504 [00:02<00:00, 15999.18 examples/s]word_repetition_filter_compute_stats (num_proc=4):  77%|###################3     | 39778/51504 [00:02<00:00, 18063.61 examples/s]word_repetition_filter_compute_stats (num_proc=4):  82%|####################4    | 42101/51504 [00:02<00:00, 18705.87 examples/s]word_repetition_filter_compute_stats (num_proc=4):  87%|#####################6   | 44699/51504 [00:02<00:00, 19901.79 examples/s]word_repetition_filter_compute_stats (num_proc=4):  91%|######################8  | 47007/51504 [00:02<00:00, 19642.19 examples/s]word_repetition_filter_compute_stats (num_proc=4):  97%|########################2| 49879/51504 [00:02<00:00, 20545.42 examples/s]word_repetition_filter_compute_stats (num_proc=4): 100%|#########################| 51504/51504 [00:02<00:00, 17813.22 examples/s]
2024-01-21 12:14:38.687 | INFO     | data_juicer.core.analyser:run:110 - Exporting dataset to disk...
2024-01-21 12:14:38.688 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|                                                                    | 0/52 [00:00<?, ?ba/s]Creating json from Arrow format:  27%|###############6                                          | 14/52 [00:00<00:00, 136.36ba/s]Creating json from Arrow format:  58%|#################################4                        | 30/52 [00:00<00:00, 144.79ba/s]Creating json from Arrow format:  90%|####################################################4     | 47/52 [00:00<00:00, 154.06ba/s]Creating json from Arrow format: 100%|##########################################################| 52/52 [00:00<00:00, 152.80ba/s]
2024-01-21 12:14:39.041 | INFO     | data_juicer.core.analyser:run:122 - Applying overall analysis on stats...
  0%|                                                                                                      | 0/7 [00:00<?, ?it/s]100%|###########################################################################################| 7/7 [00:00<00:00, 13309.21it/s]
2024-01-21 12:14:40.540 | INFO     | data_juicer.core.analyser:run:127 - The overall analysis results are:        alnum_ratio char_rep_ratio     lang lang_score   perplexity    text_len word_rep_ratio
count      51504.0        51504.0  51504.0    51504.0      51504.0     51504.0        51504.0
mean      0.885285       0.038167      NaN   0.973686  1393.143278  211.790249       0.000456
std       0.061639       0.051605      NaN   0.103543   995.404708  125.335002       0.014182
min       0.108614            0.0      NaN   0.063956         13.9        18.0            0.0
25%       0.880383            0.0      NaN   0.991108        919.1       157.0            0.0
50%       0.902778       0.008811      NaN   0.995726       1227.2       192.0            0.0
75%       0.916168       0.069332      NaN    0.99786     1643.425       236.0            0.0
max       0.963731       0.681576      NaN   1.000054      45319.6      4733.0       0.836364
unique         NaN            NaN     16.0        NaN          NaN         NaN            NaN
top            NaN            NaN       zh        NaN          NaN         NaN            NaN
freq           NaN            NaN  50827.0        NaN          NaN         NaN            NaN
2024-01-21 12:14:40.540 | INFO     | data_juicer.core.analyser:run:129 - Applying column-wise analysis on stats...
Column:   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Column:  14%|############2                                                                         | 1/7 [00:00<00:05,  1.02it/s]Column:  29%|########################5                                                             | 2/7 [00:01<00:04,  1.10it/s]Column:  43%|####################################8                                                 | 3/7 [00:02<00:02,  1.36it/s]Column:  57%|#################################################1                                    | 4/7 [00:03<00:02,  1.34it/s]Column:  71%|#############################################################4                        | 5/7 [00:03<00:01,  1.35it/s]Column:  86%|#########################################################################7            | 6/7 [00:04<00:00,  1.23it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.27it/s]Column: 100%|######################################################################################| 7/7 [00:05<00:00,  1.26it/s]
